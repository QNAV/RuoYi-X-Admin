"use strict";(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[224],{12692:function(V,S,e){e.r(S),e.d(S,{default:function(){return at}});var l=e(30279),h=e.n(l),g=e(35290),f=e.n(g),T=e(411),E=e.n(T),G=e(46686),O=e.n(G),C=e(93275),j=e.n(C),K=e(15769),r=e(94434),n=e.n(r),t=e(91500),v=e(87230),a=e(78054),i=e(37117),s=e(11527),P=function(y){var c=y.dataSource,F=y.handleEdit,M={onSave:function(){var L=E()(f()().mark(function Z(I,u){var R;return f()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return R=I,m.next=3,F(j()({},R,u[R]));case 3:case"end":return m.stop()}},Z)}));function W(Z,I){return L.apply(this,arguments)}return W}()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.vYc,{dataSource:c,columns:[t.jR,t.q2,t.Jx,t.WW,t.VP],editable:M}),(0,s.jsx)(i.Z,{}),(0,s.jsx)(a.vYc,{columns:[t.BP,t.$9,t.Qo,t.ew,t.sy,t._M].concat(n()((c==null?void 0:c.genType)===v.hh.ZIP?[]:[t.E$])),dataSource:c,editable:M})]})},x=P,B=e(60382),J=e(32760),w=e(26099),k=e(43090),Y=e(4733),X=e(50959),q=function(y){var c=y.dataSource,F=y.handleEdit,M=y.loading,L=M===void 0?!1:M,W=k.Z.useForm(),Z=O()(W,1),I=Z[0],u=(0,X.useState)([]),R=O()(u,2),N=R[0],m=R[1],z=(N==null?void 0:N.length)>0;return(0,s.jsx)(a.nxD,{toolbar:{actions:z?[(0,s.jsx)(Y.Z,{onClick:function(){return m([])},icon:(0,s.jsx)(B.Z,{}),children:"\u53D6\u6D88\u7F16\u8F91"},"cancelEdit"),(0,s.jsx)(Y.Z,{type:"primary",loading:L,icon:(0,s.jsx)(J.Z,{}),onClick:E()(f()().mark(function b(){var d;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,I.validateFields();case 2:return d=o.sent,o.next=5,F({columns:Object.keys(d).map(function(A){return h()(h()({},d[A]),{},{columnId:Number(A)})})});case 5:m([]);case 6:case"end":return o.stop()}},b)})),children:"\u4FDD\u5B58"},"edit")]:[(0,s.jsx)(Y.Z,{icon:(0,s.jsx)(w.Z,{}),type:"primary",onClick:function(){c&&m(c==null?void 0:c.map(function(d){var D,o;return(D=d==null||(o=d.columnId)===null||o===void 0?void 0:o.toString())!==null&&D!==void 0?D:""}))},children:"\u7F16\u8F91"},"edit")]},rowKey:"columnId",ghost:!0,size:"small",scroll:{x:"max-content"},columns:[t.iO,t.Zi,t.iT,t.Bw,t.$V,t.p_,t.oh,t.wX,t.Uc,t.x,t.Mw,t.Jy],value:c,recordCreatorProps:!1,editable:{form:I,editableKeys:N}})},_=q,$=e(45214),tt=e(18662),et=e(28622),nt=e(41202),st=e(55024),U,p;(function(Q){Q.BASE_INFO="BASE_INFO",Q.FIELD_INFO="FIELD_INFO"})(p||(p={}));var H=(U={},j()(U,p.BASE_INFO,"\u57FA\u672C\u4FE1\u606F"),j()(U,p.FIELD_INFO,"\u5B57\u6BB5\u4FE1\u606F"),U),rt=function(){var y,c=(0,tt.useParams)(),F=Number((y=c==null?void 0:c.tableId)!==null&&y!==void 0?y:"0"),M=(0,X.useState)(p.BASE_INFO),L=O()(M,2),W=L[0],Z=L[1],I=(0,nt.Z)(E()(f()().mark(function b(){var d;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,$.cj)({tableId:F});case 2:return d=o.sent,o.abrupt("return",d);case 4:case"end":return o.stop()}},b)})),{ready:F>0,refreshDeps:[F]}),u=I.data,R=I.refresh,N=(0,et.D)(function(){var b=E()(f()().mark(function d(D){return f()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,$.DI)(h()({tableId:F,businessName:u.info.businessName,functionName:u.info.functionName,className:u.info.className,functionAuthor:u.info.functionAuthor,moduleName:u.info.moduleName,packageName:u.info.packageName,tableComment:u.info.tableComment,tableName:u.info.tableName,columns:u.rows},D));case 2:case"end":return A.stop()}},d)}));return function(d){return b.apply(this,arguments)}}(),{onSuccess:function(){R(),st.ZP.success("\u4FDD\u5B58\u6210\u529F")}}),m=N.mutateAsync,z=N.isLoading;return(0,s.jsx)(K.A,{children:(0,s.jsxs)(a.QWM,{tabs:{activeKey:W,onChange:function(d){Z(d)}},children:[(0,s.jsx)(a.QWM.TabPane,{tab:H[p.BASE_INFO],children:(0,s.jsx)(x,{dataSource:u==null?void 0:u.info,handleEdit:m})},p.BASE_INFO),(0,s.jsx)(a.QWM.TabPane,{tab:H[p.FIELD_INFO],children:(0,s.jsx)(_,{dataSource:u==null?void 0:u.rows,handleEdit:m,loading:z})},p.FIELD_INFO)]})})},at=rt},12415:function(V,S,e){var l=e(50959);function h(r,n){return r===n&&(r!==0||1/r===1/n)||r!==r&&n!==n}var g=typeof Object.is=="function"?Object.is:h,f=l.useState,T=l.useEffect,E=l.useLayoutEffect,G=l.useDebugValue;function O(r,n){var t=n(),v=f({inst:{value:t,getSnapshot:n}}),a=v[0].inst,i=v[1];return E(function(){a.value=t,a.getSnapshot=n,C(a)&&i({inst:a})},[r,t,n]),T(function(){return C(a)&&i({inst:a}),r(function(){C(a)&&i({inst:a})})},[r]),G(t),t}function C(r){var n=r.getSnapshot;r=r.value;try{var t=n();return!g(r,t)}catch{return!0}}function j(r,n){return n()}var K=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?j:O;S.useSyncExternalStore=l.useSyncExternalStore!==void 0?l.useSyncExternalStore:K},4322:function(V,S,e){V.exports=e(12415)},28622:function(V,S,e){e.d(S,{D:function(){return j}});var l=e(50959),h=e(61142),g=e(66146),f=e(42128),T=e(39210);class E extends f.l{constructor(n,t){super(),this.client=n,this.setOptions(t),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){const t=this.options;this.options=this.client.defaultMutationOptions(n),(0,T.VS)(t,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this})}onUnsubscribe(){if(!this.listeners.length){var n;(n=this.currentMutation)==null||n.removeObserver(this)}}onMutationUpdate(n){this.updateResult();const t={listeners:!0};n.type==="success"?t.onSuccess=!0:n.type==="error"&&(t.onError=!0),this.notify(t)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(n,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof n<"u"?n:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const n=this.currentMutation?this.currentMutation.state:(0,h.R)(),t={...n,isLoading:n.status==="loading",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=t}notify(n){g.V.batch(()=>{if(this.mutateOptions){if(n.onSuccess){var t,v,a,i;(t=(v=this.mutateOptions).onSuccess)==null||t.call(v,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(a=(i=this.mutateOptions).onSettled)==null||a.call(i,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(n.onError){var s,P,x,B;(s=(P=this.mutateOptions).onError)==null||s.call(P,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(x=(B=this.mutateOptions).onSettled)==null||x.call(B,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}n.listeners&&this.listeners.forEach(J=>{J(this.currentResult)})})}}var G=e(6647),O=e(34118),C=e(4322);function j(r,n,t){const v=(0,T.lV)(r,n,t),a=(0,G.NL)({context:v.context}),[i]=l.useState(()=>new E(a,v));l.useEffect(()=>{i.setOptions(v)},[i,v]);const s=(0,C.useSyncExternalStore)(l.useCallback(x=>i.subscribe(g.V.batchCalls(x)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),P=l.useCallback((x,B)=>{i.mutate(x,B).catch(K)},[i]);if(s.error&&(0,O.L)(i.options.useErrorBoundary,[s.error]))throw s.error;return{...s,mutate:P,mutateAsync:s.mutate}}function K(){}},34118:function(V,S,e){e.d(S,{L:function(){return l}});function l(h,g){return typeof h=="function"?h(...g):!!h}}}]);
