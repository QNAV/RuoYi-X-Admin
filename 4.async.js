"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[436],{74492:function(cu,ae,u){u.r(ae),u.d(ae,{default:function(){return su}});var pe=u(46338),Y=u.n(pe),fe=u(55980),K=u.n(fe),he=u(18172),P=u.n(he),Fe=u(3849),O=u.n(Fe),ye=u(29960),F=u.n(ye),m=u(210),B=u(34638),$=u(96143),se=u(78534),b=u(96069),le=u(2891),I=u(87130),z="systemMenu",xe=[z,"list"],A=(0,I.cn)({key:"".concat(z,"SelectedMenuId"),default:0}),oe=(0,I.cn)({key:"".concat(z,"VisibleCreateModal"),default:!1}),G=function(t){return(0,le.aM)(xe,P()(F().mark(function n(){var l,d;return F().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,B.Ii)(t);case 2:return l=s.sent,d=(0,$.tw)(l,{id:"menuId",pId:"parentId",rootPId:null}),s.abrupt("return",{treeData:(0,$.dH)(d),map:l.reduce(function(p,c){return K()(K()({},p),{},Y()({},c.menuId,c))},{}),parentIds:(0,$.Vy)(l)});case 5:case"end":return s.stop()}},n)})),{refetchOnWindowFocus:!1})},ie=function(){var t=G(),n=t.refetch,l=(0,I.rb)(A);return(0,le.Db)(function(){var d=P()(F().mark(function o(s){return F().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:se.Z.confirm({title:"\u5220\u9664\u83DC\u5355",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u83DC\u5355\u5417\uFF1F",onOk:function(){var E=P()(F().mark(function i(){return F().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,B.Wl)(s);case 2:return a.next=4,n();case 4:l(),b.ZP.success("\u5220\u9664\u6210\u529F");case 6:case"end":return a.stop()}},i)}));function C(){return E.apply(this,arguments)}return C}()});case 1:case"end":return c.stop()}},o)}));return function(o){return d.apply(this,arguments)}}())},Ee=u(20436),Ce=u(85388),J=u(45443),U=u(3653),y=u(50959),H=u(17545),ge=["fieldProps","request","params","proFieldProps"],je=function(t,n){var l=t.fieldProps,d=t.request,o=t.params,s=t.proFieldProps,p=(0,U.Z)(t,ge);return y.createElement(H.Z,(0,J.Z)({mode:"edit",valueType:"cascader",fieldProps:l,ref:n,request:d,params:o,filedConfig:{customLightMode:!0},proFieldProps:s},p))},Ze=y.forwardRef(je),W=u(47780),Ie=u(31385),k=u(69870),N=u(50405),Pe=u(50193),Se=u(78802),X=u(85384),w=u(34602),e=u(11527),de=function(t,n){var l=[0];if(n===0)return l;var d=function o(s){!(t!=null&&t[s])||(t[s].parentId&&o(t[s].parentId.toString()),t[s].menuType!==m.og.F&&l.push(Number(s)))};return d(n.toString()),l},De=function(t){var n=function l(d){return d.filter(function(o){return o.menuType!==m.og.F}).map(function(o){var s=o.menuId,p=o.menuName,c=o.children;return{menuId:s,menuName:p,children:c?l(c):[]}})};return[{menuId:0,menuName:"\u6839\u76EE\u5F55",children:t?n(t):[]}]},Me=function(){var t,n=(0,y.useRef)(),l=(0,I.FV)(oe),d=O()(l,2),o=d[0],s=d[1],p=G(),c=p.refetch,E=(0,I.sJ)(A),C=(0,X.Z)(function(){var a=P()(F().mark(function v(h){var g,D;return F().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,B.Ii)(h);case 2:return g=Z.sent,D=(0,$.tw)(g,{id:"menuId",pId:"parentId",rootPId:null}),Z.abrupt("return",{options:De((0,$.dH)(D)),map:g.reduce(function(M,x){return K()(K()({},M),{},Y()({},x.menuId,x))},{})});case 5:case"end":return Z.stop()}},v)}));return function(v){return a.apply(this,arguments)}}()),i=C.data,f=C.refresh;return(0,y.useEffect)(function(){var a;if(n!=null&&(a=n.current)!==null&&a!==void 0&&a.setFieldsValue&&i!==null&&i!==void 0&&i.map){var v;n==null||(v=n.current)===null||v===void 0||v.setFieldsValue({parentId:de(i==null?void 0:i.map,E)})}},[E,i==null?void 0:i.map,n==null?void 0:n.current]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(w.Z,{className:"mr-2",type:"primary",onClick:function(){return s(!0)},icon:(0,e.jsx)(Ee.Z,{}),children:"\u65B0\u5EFA"}),(0,e.jsx)(se.Z,{visible:o,onCancel:function(){return s(!1)},title:"\u65B0\u5EFA\u83DC\u5355",footer:!1,width:515,children:(0,e.jsxs)(Ce.A,{onFinish:function(){var a=P()(F().mark(function v(h){var g;return F().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,B.cI)(h);case 2:return j.next=4,c();case 4:s(!1),f(),n==null||(g=n.current)===null||g===void 0||g.resetFields(),b.ZP.success("\u65B0\u5EFA\u6210\u529F");case 8:case"end":return j.stop()}},v)}));return function(v){return a.apply(this,arguments)}}(),formRef:n,children:[(0,e.jsx)(Ze,{name:"parentId",label:"\u7236\u7EA7\u83DC\u5355",initialValue:de((t=i==null?void 0:i.map)!==null&&t!==void 0?t:{},E),fieldProps:{options:i==null?void 0:i.options,fieldNames:{label:"menuName",value:"menuId",children:"children"},changeOnSelect:!0},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355"}],transform:function(v){return{parentId:v[v.length-1]}}}),(0,e.jsx)(W.Z.Group,{name:"menuType",label:"\u83DC\u5355\u7C7B\u578B",valueEnum:m.vs,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u83DC\u5355\u7C7B\u578B"}]}),(0,e.jsx)(Ie.Z,{name:["menuType"],children:function(v){var h=v.menuType;return h?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.UW,{children:[(0,e.jsx)(N.Z,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0",width:"sm",rules:[{required:!0}]}),(0,e.jsx)(Pe.Z,{name:"orderNum",label:"\u663E\u793A\u6392\u5E8F",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F",rules:[{required:!0}],width:"sm",initialValue:0})]}),h!==m.og.F&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.UW,{children:[(0,e.jsx)(W.Z.Group,{tooltip:"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",name:"status",label:"\u83DC\u5355\u72B6\u6001",valueEnum:m.IZ,required:!0,initialValue:m.vu.ENABLE}),(0,e.jsx)(W.Z.Group,{name:"visible",label:"\u83DC\u5355\u662F\u5426\u663E\u793A",valueEnum:m.sv,required:!0,initialValue:m.Ve.YES,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"}),(0,e.jsx)(W.Z.Group,{name:"isFrame",label:"\u662F\u5426\u5916\u94FE",valueEnum:m.sv,required:!0,initialValue:m.Ve.NO,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"})]}),(0,e.jsxs)(k.UW,{children:[(0,e.jsx)(N.Z,{name:"icon",label:"\u83DC\u5355\u56FE\u6807",width:"sm",tooltip:"https://ant.design/components/icon-cn/"}),(0,e.jsx)(N.Z,{width:"sm",name:"path",label:"\u8DEF\u7531\u5730\u5740",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934",rules:[{required:!0}]})]})]}),h===m.og.C&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(N.Z,{name:"queryParam",label:"\u8DEF\u7531\u53C2\u6570",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'})}),h!==m.og.M&&(0,e.jsx)(N.Z,{name:"perms",label:"\u6743\u9650\u6807\u8BC6"})]}):null}}),(0,e.jsx)(Se.Z,{name:"remark",label:"\u5907\u6CE8"})]})})]})},Te=Me,Be=u(71224),Ae=function(){var t=(0,I.sJ)(A),n=ie(),l=n.mutate,d=n.isLoading;return(0,e.jsx)(w.Z,{icon:(0,e.jsx)(Be.Z,{}),loading:d,disabled:t===0,danger:!0,onClick:function(){return l(t)},children:"\u5220\u9664"})},Ne=Ae,q=u(82179),Q=u(80424),ce=u(25384),_={xs:1,sm:1,md:1,lg:1,xl:2},Re=function(t){return(0,y.useMemo)(function(){var n=[];return t?(t!==m.og.F&&n.push({title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"radio",valueEnum:m.IZ},{title:"\u662F\u5426\u663E\u793A",dataIndex:"visible",key:"visible",valueType:"radio",valueEnum:m.sv,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"},{title:"\u662F\u5426\u5916\u94FE",dataIndex:"isFrame",key:"isFrame",valueType:"radio",valueEnum:m.sv,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u56FE\u6807",dataIndex:"icon",key:"icon",valueType:"text",tooltip:"https://ant.design/components/icon-cn/"},{title:"\u8DEF\u7531\u5730\u5740",dataIndex:"path",key:"path",valueType:"text",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u8DEF\u7531\u53C2\u6570",dataIndex:"queryParam",key:"queryParam",valueType:"code",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'}),t!==m.og.M&&n.push({title:"\u6743\u9650\u6807\u8BC6",dataIndex:"perms",key:"perms",valueType:"text",copyable:!0}),n):[]},[t])},Le=function(){var t=(0,I.sJ)(A),n=G(),l=n.refetch,d=(0,X.Z)(P()(F().mark(function i(){return F().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,B.lP)(t);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},i)})),{ready:t>0,refreshDeps:[t]}),o=d.data,s=d.refresh,p=(0,X.Z)(B.vv,{manual:!0,onSuccess:function(){s(),l(),b.ZP.success("\u4FDD\u5B58\u6210\u529F")}}),c=p.runAsync,E=Re(o==null?void 0:o.menuType),C={onSave:function(){var i=P()(F().mark(function a(v,h){var g,D,j,Z,M;return F().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return g=h.menuType,D=h.orderNum,j=h.menuName,Z=h.menuId,M=v,L.next=4,c(Y()({menuId:Z,menuType:g,orderNum:D,menuName:j},M,h[M]));case 4:case"end":return L.stop()}},a)}));function f(a,v){return i.apply(this,arguments)}return f}()};return t===0?(0,e.jsx)(Q.Z,{image:Q.Z.PRESENTED_IMAGE_SIMPLE,description:"\u70B9\u51FB\u9009\u62E9\u5DE6\u4FA7\u83DC\u5355\u9879\u67E5\u770B\u8BE6\u60C5"}):(0,e.jsxs)("div",{children:[(0,e.jsx)(q.vY,{columns:[{title:"\u7C7B\u578B",dataIndex:"menuType",key:"menuType",valueType:"select",valueEnum:m.vs,editable:!1},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1}],dataSource:o,column:_}),(0,e.jsx)(ce.Z,{}),(0,e.jsx)(q.vY,{columns:[{title:"\u540D\u79F0",dataIndex:"menuName",key:"menuName",valueType:"text"},{title:"\u663E\u793A\u987A\u5E8F",dataIndex:"orderNum",key:"orderNum",valueType:"digit",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F"},{title:"\u5907\u6CE8",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0}],dataSource:o,editable:C,column:_}),(0,e.jsx)(ce.Z,{}),(0,e.jsx)(q.vY,{columns:E,dataSource:o,editable:C,column:_})]})},Ve=Le,Oe=u(45365),$e=u(42020),Ke=u(8790),be=u(98408),Ge=u(42822),ee=u(44367),me=u(44963),ve=u(94757),We=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],Qe=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],Ye=y.forwardRef(function(r,t){var n=r.fieldProps,l=r.children,d=r.params,o=r.proFieldProps,s=r.mode,p=r.valueEnum,c=r.request,E=r.showSearch,C=r.options,i=(0,U.Z)(r,We),f=(0,y.useContext)(ve.Z);return y.createElement(H.Z,(0,J.Z)({mode:"edit",valueEnum:(0,me.h)(p),request:c,params:d,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,ee.Z)({options:C,mode:s,showSearch:E,getPopupContainer:f.getPopupContainer},n),ref:t,proFieldProps:o},i),l)}),ze=y.forwardRef(function(r,t){var n=r.fieldProps,l=r.children,d=r.params,o=r.proFieldProps,s=r.mode,p=r.valueEnum,c=r.request,E=r.options,C=(0,U.Z)(r,Qe),i=(0,ee.Z)({options:E,mode:s||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},n),f=(0,y.useContext)(ve.Z);return y.createElement(H.Z,(0,J.Z)({mode:"edit",valueEnum:(0,me.h)(p),request:c,params:d,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,ee.Z)({getPopupContainer:f.getPopupContainer},i),ref:t,proFieldProps:o},C),l)}),Je=Ye,Ue=ze,ue=Je;ue.SearchSelect=Ue,ue.displayName="ProFormComponent";var He=ue,S=u(5713),ke=u(4091),Xe=u(30719),we=u(30784),qe=u(46415),_e=u(15912),eu=u.n(_e),R;(function(r){r.M="blue",r.C="green",r.F="red"})(R||(R={}));var uu=function(t){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{color:"rgb(148 163 184)",children:t.orderNum}),(0,e.jsx)(Oe.z_,{name:t.icon,className:"mr-1"}),(0,e.jsx)(S.Z,{color:R[t.menuType],style:{margin:"0 0 2px 0"},children:t.menuName}),t.perms&&(0,e.jsx)(S.Z,{style:{margin:"0 0 2px 2px"},children:(0,e.jsxs)(ke.Z,{size:"small",children:[t.perms,(0,e.jsx)($e.Z,{style:{color:"#1890ff"},onClick:function(l){eu()(t.perms),b.ZP.success("\u590D\u5236\u6210\u529F"),l.stopPropagation()}})]})})]})},tu=function(){return(0,e.jsxs)("div",{className:"mb-2",children:["\u6807\u7B7E\u542B\u4E49\uFF1A",(0,e.jsx)(S.Z,{color:"rgb(148 163 184)",children:"\u663E\u793A\u987A\u5E8F"}),(0,e.jsx)(S.Z,{color:R[m.og.M],children:"\u76EE\u5F55"}),(0,e.jsx)(S.Z,{color:R[m.og.C],children:"\u83DC\u5355"}),(0,e.jsx)(S.Z,{color:R[m.og.F],children:"\u6309\u94AE"}),(0,e.jsx)(S.Z,{children:"\u6743\u9650\u6807\u8BC6"})]})},nu=function(){var t,n=(0,y.useState)({}),l=O()(n,2),d=l[0],o=l[1],s=(0,y.useState)([]),p=O()(s,2),c=p[0],E=p[1],C=(0,y.useState)([]),i=O()(C,2),f=i[0],a=i[1],v=(0,I.FV)(A),h=O()(v,2),g=h[0],D=h[1],j=(0,I.rb)(A),Z=(0,I.Zl)(oe),M=G(d),x=M.data,L=M.refetch,lu=ie(),ou=lu.mutate,iu=function(V){E(V)},ne=(f==null?void 0:f.length)!==0&&(f==null?void 0:f.length)===(x==null||(t=x.parentIds)===null||t===void 0?void 0:t.length);return(0,y.useEffect)(function(){L()},[d]),(0,y.useEffect)(function(){c!=null&&c[0]?D(c[0]):j()},[c]),(0,e.jsxs)("div",{children:[(0,e.jsx)(tu,{}),(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsx)(w.Z,{size:"small",className:"my-2",icon:ne?(0,e.jsx)(Ke.Z,{}):(0,e.jsx)(be.Z,{}),onClick:function(){return a(ne?[]:x==null?void 0:x.parentIds)},children:ne?"\u5168\u90E8\u6298\u53E0":"\u5168\u90E8\u5C55\u5F00"}),(0,e.jsxs)(Ge.M,{onFinish:function(){var T=P()(F().mark(function V(du){return F().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:E([]),a([]),o(du);case 3:case"end":return re.stop()}},V)}));return function(V){return T.apply(this,arguments)}}(),children:[(0,e.jsx)(N.Z,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0"}),(0,e.jsx)(He,{name:"status",label:"\u72B6\u6001",valueEnum:m.IZ})]})]}),(0,e.jsx)(Xe.Z,{overlay:(0,e.jsx)(we.Z,{items:[{label:"\u65B0\u5EFA",key:"create",onClick:function(){return Z(!0)}},{label:"\u5728\u6839\u76EE\u5F55\u65B0\u5EFA",key:"create",onClick:function(){j(),Z(!0)}},{label:"\u5220\u9664",key:"delete",danger:!0,disabled:c.length===0,onClick:function(){return ou(g)}}]}),trigger:["contextMenu"],children:x!=null&&x.treeData.length?(0,e.jsx)(qe.Z,{blockNode:!0,selectedKeys:c,onSelect:iu,expandedKeys:f,titleRender:uu,onExpand:a,showLine:{showLeafIcon:!1},fieldNames:{title:"menuName",key:"menuId",children:"children"},treeData:x==null?void 0:x.treeData,onRightClick:function(V){return E([V.node.key])}}):(0,e.jsx)(Q.Z,{image:Q.Z.PRESENTED_IMAGE_SIMPLE})})]})},ru=nu,te=u(36639),au=u(69489);function su(){return(0,e.jsx)(au._z,{children:(0,e.jsxs)(te.Z,{ghost:!0,gutter:24,children:[(0,e.jsx)(te.Z,{title:"\u83DC\u5355\u5217\u8868",colSpan:"550px",extra:[(0,e.jsx)(Te,{},"ButtonCreate"),(0,e.jsx)(Ne,{},"ButtonDelete")],bodyStyle:{height:"700px",overflowY:"auto",overflowX:"hidden"},children:(0,e.jsx)(ru,{})}),(0,e.jsx)(te.Z,{title:"\u83DC\u5355\u8BE6\u60C5",bodyStyle:{height:"707px"},children:(0,e.jsx)(Ve,{})})]})})}}}]);
