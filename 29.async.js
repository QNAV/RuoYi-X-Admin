"use strict";(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[426],{12937:function(se,M,e){e.d(M,{UW:function(){return A}});var W=e(16638),A=W.A.Group},361:function(se,M,e){e.r(M),e.d(M,{default:function(){return $e}});var W=e(55980),A=e.n(W),ne=e(42217),ie=e.n(ne),ue=e(18172),$=e.n(ue),le=e(3849),Q=e.n(le),oe=e(29960),B=e.n(oe),ce=e(72867),de=e(25437),O=e(43668),r=e(11527),me=function(){return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,r.jsx)(de.Z,{plain:!0,children:(0,r.jsx)("span",{className:"text-sm font-normal text-neutral-400",children:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"})}),(0,r.jsx)("div",{onClick:function(){O.ZP.info("\u656C\u8BF7\u671F\u5F85")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:(0,r.jsx)(ce.Z,{style:{fontSize:"20px",color:"#00ac84"}})})]})},ve=me,G=e(8513);function he(a){return z.apply(this,arguments)}function z(){return z=$()(B().mark(function a(s){return B().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,G.WY)("/captchaImage",A()({method:"GET"},s||{})));case 1:case"end":return n.stop()}},a)})),z.apply(this,arguments)}function Ye(a,s){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime.mark(function a(s,c){return _regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/captchaSms",_objectSpread({method:"GET",params:_objectSpread({},s)},c||{})));case 1:case"end":return d.stop()}},a)})),K.apply(this,arguments)}var X=e(4693),fe=e(16916),k=e(88387),ge=e(642),pe=e(57174),Je=e(38209),xe=e(35123),i=e(82175),Y=e(62957),Pe=e(62690),h=e(50959),je=e(16638),Ce=["logo","message","style","activityConfig","backgroundImageUrl","title","subTitle","actions","children"];function Ze(a){var s=a.logo,c=a.message,n=a.style,d=a.activityConfig,o=d===void 0?{}:d,P=a.backgroundImageUrl,x=a.title,S=a.subTitle,j=a.actions,N=a.children,C=(0,Y.Z)(a,Ce),I=(0,Pe.YB)(),b=function(){var l,Z;return C.submitter===!1||((l=C.submitter)===null||l===void 0?void 0:l.submitButtonProps)===!1?!1:(0,i.Z)({size:"large",style:{width:"100%"}},(Z=C.submitter)===null||Z===void 0?void 0:Z.submitButtonProps)},L=(0,i.Z)((0,i.Z)({searchConfig:{submitText:I.getMessage("loginForm.submitText","\u767B\u5F55")},render:function(l,Z){return Z.pop()}},C.submitter),{},{submitButtonProps:b()}),T=(0,h.useContext)(xe.ZP.ConfigContext),E=T.getPrefixCls("pro-form-login-page"),u=function(l){return"".concat(E,"-").concat(l)},f=(0,h.useMemo)(function(){return s?typeof s=="string"?(0,r.jsx)("img",{src:s}):s:null},[s]);return(0,r.jsxs)("div",{className:E,style:(0,i.Z)((0,i.Z)({},n),{},{backgroundImage:'url("'.concat(P,'")')}),children:[(0,r.jsx)("div",{className:u("notice"),children:o&&(0,r.jsxs)("div",{className:u("notice-activity"),style:o.style,children:[o.title&&(0,r.jsxs)("div",{className:u("notice-activity-title"),children:[" ",o.title," "]}),o.subTitle&&(0,r.jsxs)("div",{className:u("notice-activity-subTitle"),children:[" ",o.subTitle," "]}),o.action&&(0,r.jsxs)("div",{className:u("notice-activity-action"),children:[" ",o.action," "]})]})}),(0,r.jsxs)("div",{className:u("container"),children:[(0,r.jsxs)("div",{className:u("top"),children:[x||f?(0,r.jsxs)("div",{className:u("header"),children:[f?(0,r.jsx)("span",{className:u("logo"),children:f}):null,x?(0,r.jsx)("span",{className:u("title"),children:x}):null]}):null,S?(0,r.jsx)("div",{className:u("desc"),children:S}):null]}),(0,r.jsxs)("div",{className:u("main"),children:[(0,r.jsxs)(je.A,(0,i.Z)((0,i.Z)({isKeyPressSubmit:!0},C),{},{submitter:L,children:[c,N]})),j?(0,r.jsx)("div",{className:u("other"),children:j}):null]})]})]})}var Ve=e(67443),ye=e(16278),He=e(71447),Fe=e(79725),Qe=e(38607),Se=e(41494),U=e(88081),w=e(21519),J=e(61431),q=e(46890),Ee=["rules","name","phoneName","fieldProps","captchaTextRender","captchaProps"],Te=h.forwardRef(function(a,s){var c=(0,h.useState)(a.countDown||60),n=(0,J.Z)(c,2),d=n[0],o=n[1],P=(0,h.useState)(!1),x=(0,J.Z)(P,2),S=x[0],j=x[1],N=(0,h.useState)(),C=(0,J.Z)(N,2),I=C[0],b=C[1],L=a.rules,T=a.name,E=a.phoneName,u=a.fieldProps,f=a.captchaTextRender,g=f===void 0?function(m,y){return m?"".concat(y," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:f,l=a.captchaProps,Z=(0,Y.Z)(a,Ee),R=function(){var m=(0,w.Z)((0,U.Z)().mark(function y(t){return(0,U.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,b(!0),p.next=4,Z.onGetCaptcha(t);case 4:b(!1),j(!0),p.next=13;break;case 8:p.prev=8,p.t0=p.catch(0),j(!1),b(!1),console.log(p.t0);case 13:case"end":return p.stop()}},y,null,[[0,8]])}));return function(t){return m.apply(this,arguments)}}();return(0,h.useImperativeHandle)(s,function(){return{startTiming:function(){return j(!0)},endTiming:function(){return j(!1)}}}),(0,h.useEffect)(function(){var m=0,y=a.countDown;return S&&(m=window.setInterval(function(){o(function(t){return t<=1?(j(!1),clearInterval(m),y||60):t-1})},1e3)),function(){return clearInterval(m)}},[S]),(0,r.jsx)(Se.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(y){var t=y.getFieldValue,ae=y.validateFields;return(0,r.jsxs)("div",{style:(0,i.Z)((0,i.Z)({},u==null?void 0:u.style),{},{display:"flex",alignItems:"center"}),ref:s,children:[(0,r.jsx)(Fe.Z,(0,i.Z)((0,i.Z)({},u),{},{style:{flex:1,transition:"width .3s",marginRight:8}})),(0,r.jsx)(ye.Z,(0,i.Z)((0,i.Z)({style:{display:"block"},disabled:S,loading:I},l),{},{onClick:function(){var p=(0,w.Z)((0,U.Z)().mark(function Ke(){var te;return(0,U.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(v.prev=0,!E){v.next=9;break}return v.next=4,ae([E].flat(1));case 4:return te=t([E].flat(1)),v.next=7,R(te);case 7:v.next=11;break;case 9:return v.next=11,R("");case 11:v.next=16;break;case 13:v.prev=13,v.t0=v.catch(0),console.log(v.t0);case 16:case"end":return v.stop()}},Ke,null,[[0,13]])}));function ze(){return p.apply(this,arguments)}return ze}(),children:g(S,d)}))]})}})}),be=(0,q.G)(Te),Be=be,Xe=e(25905),Ne=e(68590),_=e(41946),ee=e(20048),Re=["options","fieldProps","proFieldProps","valueEnum"],Ae=h.forwardRef(function(a,s){var c=a.options,n=a.fieldProps,d=a.proFieldProps,o=a.valueEnum,P=(0,Y.Z)(a,Re);return(0,r.jsx)(ee.Z,(0,i.Z)({ref:s,valueType:"checkbox",mode:"edit",valueEnum:(0,_.h)(o,void 0),fieldProps:(0,i.Z)({options:c},n),lightProps:(0,i.Z)({labelFormatter:function(){return(0,r.jsx)(ee.Z,(0,i.Z)({ref:s,valueType:"checkbox",mode:"read",valueEnum:(0,_.h)(o,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,i.Z)({options:c},n),proFieldProps:d},P))}},P.lightProps),proFieldProps:d},P))}),Ge=h.forwardRef(function(a,s){var c=a.fieldProps,n=a.children;return(0,r.jsx)(Ne.Z,(0,i.Z)((0,i.Z)({ref:s},c),{},{children:n}))}),Ie=(0,q.G)(Ge,{valuePropName:"checked"}),re=Ie;re.Group=Ae;var Le=re,D=e(96639),Me=e(12937),V=e(77996),Oe=e(3989),H=e(6250),Ue=e(29293),De=["autoLogin"],F;(function(a){a.MOBILE="MOBILE",a.USERNAME="USERNAME"})(F||(F={}));var We=function(){var s=(0,h.useState)(F.USERNAME),c=Q()(s,2),n=c[0],d=c[1],o=(0,V.useSearchParams)(),P=Q()(o,2),x=P[0],S=P[1],j=x.get("msg"),N=x.get("redirect")||"/",C=(0,V.useModel)("@@initialState"),I=C.refresh,b=(0,V.useNavigate)(),L=(0,Oe.Z)(he),T=L.data,E=L.run,u=function(){var f=$()(B().mark(function g(l){var Z,R,m;return B().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Z=l.autoLogin,R=ie()(l,De),n!==F.MOBILE){t.next=8;break}return t.next=5,(0,X.OK)(R);case 5:m=t.sent,t.next=16;break;case 8:if(T){t.next=13;break}return O.ZP.error("\u8BF7\u5148\u83B7\u53D6\u56FE\u7247\u9A8C\u8BC1\u7801"),t.abrupt("return");case 13:return t.next=15,(0,X.Rg)(A()(A()({},R),{},{uuid:T.uuid}));case 15:m=t.sent;case 16:return(0,G.o4)(Z?G.Z1.LOCAL_STORAGE:G.Z1.SESSION_STORAGE,"Bearer ".concat(m.token)),t.next=19,I();case 19:b(N),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(0),n===F.USERNAME&&E();case 25:case"end":return t.stop()}},g,null,[[0,22]])}));return function(l){return f.apply(this,arguments)}}();return(0,h.useEffect)(function(){j&&(O.ZP.error(x.get("msg")),S({redirect:N},{replace:!0}))},[]),(0,r.jsx)("div",{className:"h-[100vh]",children:(0,r.jsxs)(Ze,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Umi",subTitle:"\u82E5\u4F9D\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",actions:(0,r.jsx)(ve,{}),onFinish:u,children:[(0,r.jsxs)(H.Z,{activeKey:n,onChange:function(g){return d(g)},children:[(0,r.jsx)(H.Z.TabPane,{tab:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55"},F.USERNAME),(0,r.jsx)(H.Z.TabPane,{tab:"\u624B\u673A\u53F7\u767B\u5F55"},F.MOBILE)]}),n===F.USERNAME&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.Z,{name:"username",fieldProps:{size:"large",prefix:(0,r.jsx)(fe.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),(0,r.jsx)(D.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,r.jsx)(k.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]}),(0,r.jsxs)(Me.UW,{children:[(0,r.jsx)(D.Z,{width:160,name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",fieldProps:{size:"large",prefix:(0,r.jsx)(ge.Z,{})},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}),(0,r.jsx)("div",{className:"h-[40px] w-[135px] cursor-pointer border border-solid border-gray-300",children:(0,r.jsx)(Ue.Z,{src:"data:image/png;base64,".concat(T==null?void 0:T.img),preview:!1,style:{height:"40px",width:"135px"},alt:"\u56FE\u7247\u9A8C\u8BC1\u7801",onClick:E})})]})]}),n===F.MOBILE&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.Z,{fieldProps:{maxLength:11,size:"large",prefix:(0,r.jsx)(pe.Z,{})},name:"phonenumber",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{pattern:G.RE,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),(0,r.jsx)(Be,{fieldProps:{size:"large",prefix:(0,r.jsx)(k.Z,{})},captchaProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(g,l){return g?"".concat(l," ","\u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"smsCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],onGetCaptcha:$()(B().mark(function f(){return B().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return O.ZP.info("\u656C\u8BF7\u671F\u5F85"),l.abrupt("return",Promise.reject(new Error("\u656C\u8BF7\u671F\u5F85")));case 2:case"end":return l.stop()}},f)}))})]}),(0,r.jsx)(Le,{name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"})]})})},$e=We}}]);
