(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[557],{16329:function(B){function L(n){if(n==null)throw new TypeError("Cannot destructure undefined")}B.exports=L,B.exports.__esModule=!0,B.exports.default=B.exports},69410:function(B,L,n){"use strict";n.r(L),n.d(L,{default:function(){return Ye}});var se=n(55980),y=n.n(se),de=n(16329),Z=n.n(de),ce=n(18172),g=n.n(ce),x=n(3849),Ge=n.n(x),Y=n(46338),re=n.n(Y),X=n(29960),M=n.n(X),A=n(18184),u=n(11527),W=function(){return(0,u.jsx)(A.vY,{})},ve=W,H=function(){return(0,u.jsx)(A.vY,{})},Te=H,ae=n(38607),me=n(41494),oe=n(67443),fe=n(16278),z=n(43293),he=n(61431),U=n(62957),ue=n(88081),J=n(21519),c=n(82175),Q=n(20436),_e=n(40296),k=n(18121),r=n(41946),a=n(93494),s=n(87409),p=n(58343),t=n(28850),D=n(85621),Ee=n(13617),G=n(50959),we=n(54923),Fe=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],Oe=["record","position","creatorButtonText","newRecordType","parentKey","style"],je=G.createContext(void 0);function Ce(e){var E=e.children,j=e.record,I=e.position,S=e.newRecordType,ee=e.parentKey,w=(0,G.useContext)(je);return G.cloneElement(E,(0,c.Z)((0,c.Z)({},E.props),{},{onClick:function(){var F=(0,J.Z)((0,ue.Z)().mark(function K(ie){var $,C,T,b;return(0,ue.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,($=(C=E.props).onClick)===null||$===void 0?void 0:$.call(C,ie);case 2:if(b=R.sent,b!==!1){R.next=5;break}return R.abrupt("return");case 5:w==null||(T=w.current)===null||T===void 0||T.addEditRecord(j,{position:I,newRecordType:S,parentKey:ee});case 6:case"end":return R.stop()}},K)}));function ne(K){return F.apply(this,arguments)}return ne}()}))}function Pe(e){var E,j,I=e.onTableChange,S=e.maxLength,ee=e.formItemProps,w=e.recordCreatorProps,F=e.rowKey,ne=e.controlled,K=e.defaultValue,ie=e.onChange,$=e.editableFormRef,C=(0,U.Z)(e,Fe),T=(0,k.Z)(e.value),b=(0,G.useRef)(),P=(0,G.useRef)();(0,G.useImperativeHandle)(C.actionRef,function(){return b.current});var R=(0,t.Z)(function(){return e.value||K||[]},{value:e.value,onChange:e.onChange}),xe=(0,he.Z)(R,2),v=xe[0],Xe=xe[1],N=G.useMemo(function(){return typeof F=="function"?F:function(f,o){return f[F]||o}},[F]),Ie=function(o){if(typeof o=="number"&&!e.name){if(o>=v.length)return o;var l=v==null?void 0:v.at(o);return N==null?void 0:N(l,o)}if((typeof o=="string"||o>=v.length)&&e.name){var i=v.findIndex(function(d,m){var h;return(N==null||(h=N(d,m))===null||h===void 0?void 0:h.toString())===(o==null?void 0:o.toString())});return i}return o};(0,G.useImperativeHandle)($,function(){var f=function(i){var d,m;if(i==null)throw new Error("rowIndex is required");var h=Ie(i),O=[e.name,(d=h==null?void 0:h.toString())!==null&&d!==void 0?d:""].flat(1).filter(Boolean);return(m=P.current)===null||m===void 0?void 0:m.getFieldValue(O)},o=function(){var i,d=[e.name].flat(1).filter(Boolean);if(Array.isArray(d)&&d.length===0){var m,h=(m=P.current)===null||m===void 0?void 0:m.getFieldsValue();return Array.isArray(h)?h:Object.keys(h).map(function(O){return h[O]})}return(i=P.current)===null||i===void 0?void 0:i.getFieldValue(d)};return(0,c.Z)((0,c.Z)({},P.current),{},{getRowData:f,getRowsData:o,setRowData:function(i,d){var m,h,O,be;if(i==null)throw new Error("rowIndex is required");var Re=Ie(i),nn=[e.name,(m=Re==null?void 0:Re.toString())!==null&&m!==void 0?m:""].flat(1).filter(Boolean),tn=((h=P.current)===null||h===void 0||(O=h.getFieldsValue)===null||O===void 0?void 0:O.call(h))||{},rn=(0,Ee.Z)(tn,nn,(0,c.Z)((0,c.Z)({},f(i)),d||{}));return(be=P.current)===null||be===void 0?void 0:be.setFieldsValue(rn)}})}),(0,G.useEffect)(function(){!e.controlled||v.forEach(function(f,o){var l;(l=P.current)===null||l===void 0||l.setFieldsValue((0,z.Z)({},N(f,o),f))},{})},[v,e.controlled]),(0,G.useEffect)(function(){if(e.name){var f;P.current=e==null||(f=e.editable)===null||f===void 0?void 0:f.form}},[(E=e.editable)===null||E===void 0?void 0:E.form,e.name]);var V=w||{},We=V.record,ye=V.position,He=V.creatorButtonText,ze=V.newRecordType,Je=V.parentKey,Qe=V.style,ke=(0,U.Z)(V,Oe),Se=ye==="top",te=(0,G.useMemo)(function(){return S&&S<=(v==null?void 0:v.length)?!1:w!==!1&&(0,u.jsx)(Ce,{record:(0,r.h)(We,v==null?void 0:v.length,v)||{},position:ye,parentKey:(0,r.h)(Je,v==null?void 0:v.length,v),newRecordType:ze,children:(0,u.jsx)(fe.Z,(0,c.Z)((0,c.Z)({type:"dashed",style:(0,c.Z)({display:"block",margin:"10px 0",width:"100%"},Qe),icon:(0,u.jsx)(Q.Z,{})},ke),{},{children:He||"\u6DFB\u52A0\u4E00\u884C\u6570\u636E"}))})},[w,S,v==null?void 0:v.length]),qe=(0,G.useMemo)(function(){return te?Se?{components:{header:{wrapper:function(o){var l,i=o.className,d=o.children;return(0,u.jsxs)("thead",{className:i,children:[d,(0,u.jsxs)("tr",{style:{position:"relative"},children:[(0,u.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:te}),(0,u.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(l=C.columns)===null||l===void 0?void 0:l.length,children:te})]})]})}}}}:{tableViewRender:function(o,l){var i,d;return(0,u.jsxs)(u.Fragment,{children:[(i=(d=e.tableViewRender)===null||d===void 0?void 0:d.call(e,o,l))!==null&&i!==void 0?i:l,te]})}}:{}},[Se,te]),pe=(0,c.Z)({},e.editable),en=(0,a.J)(function(f,o){var l,i,d;if((l=e.editable)===null||l===void 0||(i=l.onValuesChange)===null||i===void 0||i.call(l,f,o),(d=e.onValuesChange)===null||d===void 0||d.call(e,o,f),e.controlled){var m;e==null||(m=e.onChange)===null||m===void 0||m.call(e,o)}});return((e==null?void 0:e.onValuesChange)||((j=e.editable)===null||j===void 0?void 0:j.onValuesChange)||e.controlled&&(e==null?void 0:e.onChange))&&(pe.onValuesChange=en),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(je.Provider,{value:b,children:(0,u.jsx)(we.Z,(0,c.Z)((0,c.Z)((0,c.Z)({search:!1,options:!1,pagination:!1,rowKey:F,revalidateOnFocus:!1},C),qe),{},{tableLayout:"fixed",actionRef:b,onChange:I,editable:(0,c.Z)((0,c.Z)({},pe),{},{formProps:(0,c.Z)({formRef:P},pe.formProps)}),dataSource:v,onDataSourceChange:function(o){if(Xe(o),e.name&&ye==="top"){var l,i=(0,Ee.Z)({},[e.name].flat(1).filter(Boolean),o);(l=P.current)===null||l===void 0||l.setFieldsValue(i)}}}))}),e.name?(0,u.jsx)(_e.Z,{name:[e.name],children:function(o){var l,i,d=(0,D.Z)(o,[e.name].flat(1)),m=d==null?void 0:d.find(function(h,O){return!(0,s.Z)(h,T==null?void 0:T[O])});return m&&(e==null||(l=e.editable)===null||l===void 0||(i=l.onValuesChange)===null||i===void 0||i.call(l,m,d)),null}}):null]})}function De(e){return e.name?(0,u.jsx)(me.Z.Item,(0,c.Z)((0,c.Z)({style:{maxWidth:"100%"}},e==null?void 0:e.formItemProps),{},{name:e.name,children:(0,u.jsx)(p.gN,{shouldUpdate:!0,name:e.name,isList:!0,children:function(j,I,S){return(0,u.jsx)(Pe,(0,c.Z)((0,c.Z)({},e),{},{editable:(0,c.Z)((0,c.Z)({},e.editable),{},{form:S}),value:j.value||[],onChange:j.onChange}))}})})):(0,u.jsx)(Pe,(0,c.Z)({},e))}De.RecordCreator=Ce;var $e=De,Ne=function(){return(0,u.jsx)($e,{ghost:!0})},Ve=Ne,Ze=n(90586),Be=n(80630),le=n(75687),Le=n(59527),Me=n(3989),Ae=n(43668),Ue=n(2891),q,_;(function(e){e.BASE_INFO="BASE_INFO",e.FIELD_INFO="FIELD_INFO",e.GEN_INFO="GEN_INFO"})(_||(_={}));var ge=(q={},re()(q,_.BASE_INFO,"\u57FA\u672C\u4FE1\u606F"),re()(q,_.FIELD_INFO,"\u5B57\u6BB5\u4FE1\u606F"),re()(q,_.GEN_INFO,"\u751F\u6210\u4FE1\u606F"),q),Ke=function(){var E,j=(0,Be.useParams)(),I=(E=j==null?void 0:j.tableId)!==null&&E!==void 0?E:0,S=(0,G.useState)(_.BASE_INFO),ee=Ge()(S,2),w=ee[0],F=ee[1],ne=(0,Me.Z)(g()(M().mark(function C(){return M().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,Ze.cj)({tableId:I});case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},C)})),{ready:I>0,refreshDeps:[I]}),K=ne.data,ie=ne.refresh,$=(0,Ue.Db)(function(){var C=g()(M().mark(function T(b){return M().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,Ze.DI)(y()({tableId:I},b));case 2:case"end":return R.stop()}},T)}));return function(T){return C.apply(this,arguments)}}(),{onSuccess:function(){ie(),Ae.ZP.success("\u4FDD\u5B58\u6210\u529F")}});return Z()($),console.log(K),(0,u.jsx)(Le._z,{children:(0,u.jsxs)(le.Z,{tabs:{activeKey:w,onChange:function(T){F(T)}},children:[(0,u.jsx)(le.Z.TabPane,{tab:ge[_.BASE_INFO],children:(0,u.jsx)(ve,{})},_.BASE_INFO),(0,u.jsx)(le.Z.TabPane,{tab:ge[_.FIELD_INFO],children:(0,u.jsx)(Ve,{})},_.FIELD_INFO),(0,u.jsx)(le.Z.TabPane,{tab:ge[_.GEN_INFO],children:(0,u.jsx)(Te,{})},_.GEN_INFO)]})})},Ye=Ke},90586:function(B,L,n){"use strict";n.d(L,{DI:function(){return ve},DT:function(){return he},LV:function(){return c},Zd:function(){return ue},cj:function(){return fe},qm:function(){return me},we:function(){return M}});var se=n(55980),y=n.n(se),de=n(18172),Z=n.n(de),ce=n(29960),g=n.n(ce),x=n(8513);function Ge(r,a){return Y.apply(this,arguments)}function Y(){return Y=_asyncToGenerator(_regeneratorRuntime.mark(function r(a,s){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/tool/gen/batchGenCode",_objectSpread({method:"GET",params:_objectSpread({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),Y.apply(this,arguments)}function re(r,a){return X.apply(this,arguments)}function X(){return X=_asyncToGenerator(_regeneratorRuntime.mark(function r(a,s){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/tool/gen/column/list",_objectSpread({method:"GET",params:_objectSpread({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),X.apply(this,arguments)}function M(r,a,s){return A.apply(this,arguments)}function A(){return A=Z()(g().mark(function r(a,s,p){return g().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,x.h3)("/tool/gen/db/list",y()({method:"POST",headers:{"Content-Type":"application/json"},params:y()({},a),data:s},p||{})));case 1:case"end":return D.stop()}},r)})),A.apply(this,arguments)}function u(r,a){return W.apply(this,arguments)}function W(){return W=_asyncToGenerator(_regeneratorRuntime.mark(function r(a,s){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/tool/gen/download",_objectSpread({method:"GET",params:_objectSpread({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),W.apply(this,arguments)}function ve(r,a){return H.apply(this,arguments)}function H(){return H=Z()(g().mark(function r(a,s){return g().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,x.h3)("/tool/gen/edit",y()({method:"POST",headers:{"Content-Type":"application/json"},data:a},s||{})));case 1:case"end":return t.stop()}},r)})),H.apply(this,arguments)}function Te(r,a){return ae.apply(this,arguments)}function ae(){return ae=_asyncToGenerator(_regeneratorRuntime.mark(function r(a,s){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/tool/gen/genCode",_objectSpread({method:"GET",params:_objectSpread({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),ae.apply(this,arguments)}function me(r,a){return oe.apply(this,arguments)}function oe(){return oe=Z()(g().mark(function r(a,s){return g().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,x.h3)("/tool/gen/importTable",y()({method:"POST",params:y()({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),oe.apply(this,arguments)}function fe(r,a){return z.apply(this,arguments)}function z(){return z=Z()(g().mark(function r(a,s){return g().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,x.h3)("/tool/gen/info",y()({method:"GET",params:y()({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),z.apply(this,arguments)}function he(r,a,s){return U.apply(this,arguments)}function U(){return U=Z()(g().mark(function r(a,s,p){return g().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,x.h3)("/tool/gen/list",y()({method:"POST",headers:{"Content-Type":"application/json"},params:y()({},a),data:s},p||{})));case 1:case"end":return D.stop()}},r)})),U.apply(this,arguments)}function ue(r,a){return J.apply(this,arguments)}function J(){return J=Z()(g().mark(function r(a,s){return g().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,x.h3)("/tool/gen/preview",y()({method:"GET",params:y()({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),J.apply(this,arguments)}function c(r,a){return Q.apply(this,arguments)}function Q(){return Q=Z()(g().mark(function r(a,s){return g().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,x.h3)("/tool/gen/remove",y()({method:"POST",params:y()({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),Q.apply(this,arguments)}function _e(r,a){return k.apply(this,arguments)}function k(){return k=_asyncToGenerator(_regeneratorRuntime.mark(function r(a,s){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/tool/gen/synchDb",_objectSpread({method:"GET",params:_objectSpread({},a)},s||{})));case 1:case"end":return t.stop()}},r)})),k.apply(this,arguments)}}}]);
