"use strict";(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[298],{12415:function(L,O,c){var l=c(50959);function m(u,r){return u===r&&(u!==0||1/u===1/r)||u!==u&&r!==r}var I=typeof Object.is=="function"?Object.is:m,D=l.useState,T=l.useEffect,V=l.useLayoutEffect,k=l.useDebugValue;function P(u,r){var o=r(),b=D({inst:{value:o,getSnapshot:r}}),v=b[0].inst,h=b[1];return V(function(){v.value=o,v.getSnapshot=r,C(v)&&h({inst:v})},[u,o,r]),T(function(){return C(v)&&h({inst:v}),u(function(){C(v)&&h({inst:v})})},[u]),k(o),o}function C(u){var r=u.getSnapshot;u=u.value;try{var o=r();return!I(u,o)}catch{return!0}}function w(u,r){return r()}var U=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?w:P;O.useSyncExternalStore=l.useSyncExternalStore!==void 0?l.useSyncExternalStore:U},4322:function(L,O,c){L.exports=c(12415)},28622:function(L,O,c){c.d(O,{D:function(){return w}});var l=c(50959),m=c(61142),I=c(66146),D=c(42128),T=c(39210);class V extends D.l{constructor(r,o){super(),this.client=r,this.setOptions(o),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){const o=this.options;this.options=this.client.defaultMutationOptions(r),(0,T.VS)(o,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this})}onUnsubscribe(){if(!this.listeners.length){var r;(r=this.currentMutation)==null||r.removeObserver(this)}}onMutationUpdate(r){this.updateResult();const o={listeners:!0};r.type==="success"?o.onSuccess=!0:r.type==="error"&&(o.onError=!0),this.notify(o)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(r,o){return this.mutateOptions=o,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof r<"u"?r:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const r=this.currentMutation?this.currentMutation.state:(0,m.R)(),o={...r,isLoading:r.status==="loading",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=o}notify(r){I.V.batch(()=>{if(this.mutateOptions){if(r.onSuccess){var o,b,v,h;(o=(b=this.mutateOptions).onSuccess)==null||o.call(b,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(v=(h=this.mutateOptions).onSettled)==null||v.call(h,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(r.onError){var Q,F,x,A;(Q=(F=this.mutateOptions).onError)==null||Q.call(F,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(x=(A=this.mutateOptions).onSettled)==null||x.call(A,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}r.listeners&&this.listeners.forEach(j=>{j(this.currentResult)})})}}var k=c(6647),P=c(34118),C=c(4322);function w(u,r,o){const b=(0,T.lV)(u,r,o),v=(0,k.NL)({context:b.context}),[h]=l.useState(()=>new V(v,b));l.useEffect(()=>{h.setOptions(b)},[h,b]);const Q=(0,C.useSyncExternalStore)(l.useCallback(x=>h.subscribe(I.V.batchCalls(x)),[h]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),F=l.useCallback((x,A)=>{h.mutate(x,A).catch(U)},[h]);if(Q.error&&(0,P.L)(h.options.useErrorBoundary,[Q.error]))throw Q.error;return{...Q,mutate:F,mutateAsync:Q.mutate}}function U(){}},78175:function(L,O,c){c.d(O,{a:function(){return X}});var l=c(39210),m=c(66146),I=c(60785),D=c(42128),T=c(91502);class V extends D.l{constructor(t,e){super(),this.client=t,this.options=e,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(e)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.length===1&&(this.currentQuery.addObserver(this),P(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.listeners.length||this.destroy()}shouldFetchOnReconnect(){return C(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return C(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=[],this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(t,e){const n=this.options,d=this.currentQuery;if(this.options=this.client.defaultQueryOptions(t),(0,l.VS)(n,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=n.queryKey),this.updateQuery();const s=this.hasListeners();s&&w(this.currentQuery,d,this.options,n)&&this.executeFetch(),this.updateResult(e),s&&(this.currentQuery!==d||this.options.enabled!==n.enabled||this.options.staleTime!==n.staleTime)&&this.updateStaleTimeout();const a=this.computeRefetchInterval();s&&(this.currentQuery!==d||this.options.enabled!==n.enabled||a!==this.currentRefetchInterval)&&this.updateRefetchInterval(a)}getOptimisticResult(t){const e=this.client.getQueryCache().build(this.client,t);return this.createResult(e,t)}getCurrentResult(){return this.currentResult}trackResult(t){const e={};return Object.keys(t).forEach(n=>{Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(n),t[n])})}),e}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:t,...e}={}){return this.fetch({...e,meta:{refetchPage:t}})}fetchOptimistic(t){const e=this.client.defaultQueryOptions(t),n=this.client.getQueryCache().build(this.client,e);return n.isFetchingOptimistic=!0,n.fetch().then(()=>this.createResult(n,e))}fetch(t){var e;return this.executeFetch({...t,cancelRefetch:(e=t.cancelRefetch)!=null?e:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(t){this.updateQuery();let e=this.currentQuery.fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(l.ZT)),e}updateStaleTimeout(){if(this.clearStaleTimeout(),l.sk||this.currentResult.isStale||!(0,l.PN)(this.options.staleTime))return;const e=(0,l.Kp)(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},e)}computeRefetchInterval(){var t;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(t=this.options.refetchInterval)!=null?t:!1}updateRefetchInterval(t){this.clearRefetchInterval(),this.currentRefetchInterval=t,!(l.sk||this.options.enabled===!1||!(0,l.PN)(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||I.j.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(t,e){const n=this.currentQuery,d=this.options,s=this.currentResult,a=this.currentResultState,f=this.currentResultOptions,p=t!==n,E=p?t.state:this.currentQueryInitialState,M=p?this.currentResult:this.previousQueryResult,{state:y}=t;let{dataUpdatedAt:K,error:W,errorUpdatedAt:z,fetchStatus:B,status:S}=y,Z=!1,G=!1,g;if(e._optimisticResults){const R=this.hasListeners(),N=!R&&P(t,e),Y=R&&w(t,n,e,d);(N||Y)&&(B=(0,T.Kw)(t.options.networkMode)?"fetching":"paused",K||(S="loading")),e._optimisticResults==="isRestoring"&&(B="idle")}if(e.keepPreviousData&&!y.dataUpdateCount&&M!=null&&M.isSuccess&&S!=="error")g=M.data,K=M.dataUpdatedAt,S=M.status,Z=!0;else if(e.select&&typeof y.data<"u")if(s&&y.data===(a==null?void 0:a.data)&&e.select===this.selectFn)g=this.selectResult;else try{this.selectFn=e.select,g=e.select(y.data),g=(0,l.oE)(s==null?void 0:s.data,g,e),this.selectResult=g,this.selectError=null}catch(R){this.selectError=R}else g=y.data;if(typeof e.placeholderData<"u"&&typeof g>"u"&&S==="loading"){let R;if(s!=null&&s.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))R=s.data;else if(R=typeof e.placeholderData=="function"?e.placeholderData():e.placeholderData,e.select&&typeof R<"u")try{R=e.select(R),R=(0,l.oE)(s==null?void 0:s.data,R,e),this.selectError=null}catch(N){this.selectError=N}typeof R<"u"&&(S="success",g=R,G=!0)}this.selectError&&(W=this.selectError,g=this.selectResult,z=Date.now(),S="error");const H=B==="fetching";return{status:S,fetchStatus:B,isLoading:S==="loading",isSuccess:S==="success",isError:S==="error",data:g,dataUpdatedAt:K,error:W,errorUpdatedAt:z,failureCount:y.fetchFailureCount,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>E.dataUpdateCount||y.errorUpdateCount>E.errorUpdateCount,isFetching:H,isRefetching:H&&S!=="loading",isLoadingError:S==="error"&&y.dataUpdatedAt===0,isPaused:B==="paused",isPlaceholderData:G,isPreviousData:Z,isRefetchError:S==="error"&&y.dataUpdatedAt!==0,isStale:U(t,e),refetch:this.refetch,remove:this.remove}}updateResult(t){const e=this.currentResult,n=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,(0,l.VS)(n,e))return;this.currentResult=n;const d={cache:!0},s=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options;if(a==="all"||!a&&!this.trackedProps.size)return!0;const f=new Set(a??this.trackedProps);return this.options.useErrorBoundary&&f.add("error"),Object.keys(this.currentResult).some(p=>{const E=p;return this.currentResult[E]!==e[E]&&f.has(E)})};(t==null?void 0:t.listeners)!==!1&&s()&&(d.listeners=!0),this.notify({...d,...t})}updateQuery(){const t=this.client.getQueryCache().build(this.client,this.options);if(t===this.currentQuery)return;const e=this.currentQuery;this.currentQuery=t,this.currentQueryInitialState=t.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))}onQueryUpdate(t){const e={};t.type==="success"?e.onSuccess=!t.manual:t.type==="error"&&!(0,T.DV)(t.error)&&(e.onError=!0),this.updateResult(e),this.hasListeners()&&this.updateTimers()}notify(t){m.V.batch(()=>{if(t.onSuccess){var e,n,d,s;(e=(n=this.options).onSuccess)==null||e.call(n,this.currentResult.data),(d=(s=this.options).onSettled)==null||d.call(s,this.currentResult.data,null)}else if(t.onError){var a,f,p,E;(a=(f=this.options).onError)==null||a.call(f,this.currentResult.error),(p=(E=this.options).onSettled)==null||p.call(E,void 0,this.currentResult.error)}t.listeners&&this.listeners.forEach(M=>{M(this.currentResult)}),t.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function k(i,t){return t.enabled!==!1&&!i.state.dataUpdatedAt&&!(i.state.status==="error"&&t.retryOnMount===!1)}function P(i,t){return k(i,t)||i.state.dataUpdatedAt>0&&C(i,t,t.refetchOnMount)}function C(i,t,e){if(t.enabled!==!1){const n=typeof e=="function"?e(i):e;return n==="always"||n!==!1&&U(i,t)}return!1}function w(i,t,e,n){return e.enabled!==!1&&(i!==t||n.enabled===!1)&&(!e.suspense||i.state.status!=="error")&&U(i,e)}function U(i,t){return i.isStaleByTime(t.staleTime)}var u=c(50959);function r(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}}const o=u.createContext(r()),b=()=>u.useContext(o),v=({children:i})=>{const[t]=React.useState(()=>r());return React.createElement(o.Provider,{value:t},typeof i=="function"?i(t):i)};var h=c(6647),Q=c(34118);const F=u.createContext(!1),x=()=>u.useContext(F),A=F.Provider;var j=c(4322);function J(i,t){const e=(0,h.NL)({context:i.context}),n=x(),d=b(),s=e.defaultQueryOptions(i);s._optimisticResults=n?"isRestoring":"optimistic",s.onError&&(s.onError=m.V.batchCalls(s.onError)),s.onSuccess&&(s.onSuccess=m.V.batchCalls(s.onSuccess)),s.onSettled&&(s.onSettled=m.V.batchCalls(s.onSettled)),s.suspense&&typeof s.staleTime!="number"&&(s.staleTime=1e3),(s.suspense||s.useErrorBoundary)&&(d.isReset()||(s.retryOnMount=!1));const[a]=u.useState(()=>new t(e,s)),f=a.getOptimisticResult(s);if((0,j.useSyncExternalStore)(u.useCallback(p=>n?()=>{}:a.subscribe(m.V.batchCalls(p)),[a,n]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),u.useEffect(()=>{d.clearReset()},[d]),u.useEffect(()=>{a.setOptions(s,{listeners:!1})},[s,a]),s.suspense&&f.isLoading&&f.isFetching&&!n)throw a.fetchOptimistic(s).then(({data:p})=>{s.onSuccess==null||s.onSuccess(p),s.onSettled==null||s.onSettled(p,null)}).catch(p=>{d.clearReset(),s.onError==null||s.onError(p),s.onSettled==null||s.onSettled(void 0,p)});if(f.isError&&!d.isReset()&&!f.isFetching&&(0,Q.L)(s.useErrorBoundary,[f.error,a.getCurrentQuery()]))throw f.error;return s.notifyOnChangeProps?f:a.trackResult(f)}function X(i,t,e){const n=(0,l._v)(i,t,e);return J(n,V)}},34118:function(L,O,c){c.d(O,{L:function(){return l}});function l(m,I){return typeof m=="function"?m(...I):!!m}}}]);
