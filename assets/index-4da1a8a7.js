import{j as o,B as R}from"./antdProComponents-d97761a4.js";import{e as w,h as y,f as v,F as j,A as p,G as P,H as k,l as S,g as l,I as F,J as O,K,L,j as V,M as N,k as Y,N as q,d as D,m as X,i as $,O as H,B as _}from"./index-7df8d6db.js";import{D as b}from"./index-1ed897e9.js";import{a as W,u as G}from"./utils-6d3e551f.js";import{b6 as f,r as m,B as J,a_ as Q}from"./antd-79b0e736.js";import{u as C}from"./useMutation-6894a2eb.js";import"./iconPark-31f72c99.js";import"./wangEditor-f0c73729.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const A=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/config/model/index.ts/atomMainTableActions",w(void 0));A.debugLabel="atomMainTableActions";const I=()=>y(A),U=()=>v(A);var g=(e=>(e[e.Add=0]="Add",e[e.Edit=1]="Edit",e))(g||{});const z={[b.Add]:"新增",[b.Edit]:"编辑"},u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/config/model/index.ts/atomAddOrEditModal",W({open:!1,actionType:0}));u.debugLabel="atomAddOrEditModal";const Z=()=>y(u),ee=()=>{const e=j(u);return()=>{e({open:!0,actionType:0})}},te=()=>{const e=j(u);return t=>{e({open:!0,actionType:1,record:t})}},oe=()=>G(u);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ae=({record:e})=>{const t=te();return o.jsx(p,{accessKey:"system:config:edit",children:o.jsx(P,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const M=({configIds:e,disabled:t,batch:s})=>{const{modal:c,message:i}=f.useApp(),a=I(),{mutate:n,isLoading:T}=C(k,{onSuccess:()=>{var d;a==null||a.reload(),(d=a==null?void 0:a.clearSelected)==null||d.call(a),i.success("删除成功")}}),h=()=>{c.confirm({title:"操作确认",content:`确定删除参数编号为 ${e.join(",")} 的参数吗？`,onOk:()=>n({configIds:e}),okButtonProps:{loading:T}})};return o.jsx(p,{accessKey:"system:config:remove",children:o.jsx(S,{batch:s,disabled:t,onClick:h})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const[se]=l({title:"参数主键",dataIndex:"configId",table:{valueType:"text",hideInSearch:!0}}),[ce,,ne]=l({title:"参数名称",dataIndex:"configName",table:{valueType:"text"},form:{valueType:"text",formItemProps:{rules:[{required:!0}]}}}),[ie,,re]=l({title:"参数键名",dataIndex:"configKey",table:{valueType:"text"},form:{valueType:"text",formItemProps:{rules:[{required:!0}]}}}),[le,,ue]=l({title:"参数键值",dataIndex:"configValue",table:{valueType:"text"},form:{valueType:"text",formItemProps:{rules:[{required:!0}]}}}),E=()=>{const{valueEnumSysYesNo:e}=F();return l({title:"系统内置",dataIndex:"configType",valueEnum:e,table:{valueType:"select"},form:{valueType:"radio",formItemProps:{rules:[{required:!0}]}}})},[he,,de]=l({title:"备注",dataIndex:"remark",table:{valueType:"textarea",hideInSearch:!0},form:{valueType:"textarea"}}),[me]=l({title:"创建时间",dataIndex:"createTime",table:{valueType:"dateTime",hideInSearch:!0,sorter:!0}}),[ge]=l({title:"创建时间",dataIndex:"createTimeRange",table:{valueType:"dateTimeRange",hideInTable:!0}}),pe=()=>{const[e]=E();return[se,ce,ie,le,e,he,me,ge,{title:"操作",valueType:"option",fixed:"right",render:(t,s)=>o.jsxs(o.Fragment,{children:[o.jsx(ae,{record:s}),o.jsx(M,{configIds:[s.configId]})]})}]},fe=()=>{const[,,e]=E();return[ne,re,ue,e,de]};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Te=()=>{const{message:e}=f.useApp(),t=m.useRef(),s=I(),{open:c,actionType:i,record:a}=Z(),n=oe(),T=()=>{var r;i===g.Edit&&((r=t.current)==null||r.resetFields()),n()},h=z[i],d=async r=>{var x;i===g.Add?await O(r):await K({...r,configId:a.configId}),n(),(x=t.current)==null||x.resetFields(),s==null||s.reload(),e.success(`${h}成功`)},B=fe();return m.useEffect(()=>{c&&i===g.Edit&&m.startTransition(()=>{var r;(r=t.current)==null||r.setFieldsValue(a)})},[c]),o.jsx(R,{title:`${h}参数设置`,layoutType:"ModalForm",formRef:t,width:500,open:c,modalProps:{onCancel:T,okText:"提交"},onFinish:d,columns:B})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ce=()=>{const e=ee();return o.jsx(p,{accessKey:"system:config:add",children:o.jsx(L,{onClick:e})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ae=async e=>{const{data:t}=await N(e,{format:"blob"});await Y(t,`config_${new Date().getTime()}.xlsx`)},xe=({searchParams:e})=>{const{message:t}=f.useApp(),{isLoading:s,mutate:c}=C(Ae,{onSuccess:()=>{t.success("导出成功")}});return o.jsx(p,{accessKey:"system:config:export",children:o.jsx(V,{loading:s,onClick:()=>c(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const be=()=>{const{message:e,modal:t}=f.useApp(),{isLoading:s,mutate:c}=C(q,{onSuccess:()=>{e.success("刷新成功")}});return o.jsx(J,{danger:!0,icon:o.jsx(Q,{}),onClick:()=>{t.confirm({title:"操作确认",content:"确定刷新缓存吗？",onOk:()=>c({}),okButtonProps:{loading:s}})},children:"刷新缓存"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ye=({selectedRowKeys:e})=>o.jsx(M,{disabled:e.length===0,batch:!0,configIds:e}),je=()=>{const e=U(),t=pe(),[s,c]=m.useState({});return o.jsx(D,{rowKey:"configId",actionRef:e,columns:t,tableAlertOptionRender:ye,request:async(...i)=>{const{createTimeRange:a,...n}=X(...i);return $(a)&&(n.beginTime=a[0],n.endTime=a[1]),c(n),await H(n)},toolbar:{actions:[o.jsx(be,{},"ButtonRefresh"),o.jsx(xe,{searchParams:s},"ButtonExport"),o.jsx(Ce,{},"ButtonAdd")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ke=()=>o.jsxs(_,{children:[o.jsx(je,{}),o.jsx(Te,{})]});export{ke as default};
