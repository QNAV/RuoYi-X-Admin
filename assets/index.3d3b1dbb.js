import{s as w,v as M,bh as B,g as E,w as p,r as f,j as a,aw as y,e as n,ax as P,q as A,a1 as I,b1 as x,ay as O,aN as v,aW as R,bi as k,bj as D,ai as T,aB as N,aC as q,aG as V,aF as W,F as j,aH as L,aI as X,aK as Y,b4 as G,M as K}from"./index.b8b57d0a.js";import{d as g}from"./index.025b1f79.js";import{b as H}from"./index.c623ed89.js";import{e as _}from"./SysDictDataService.0d1a698c.js";import{a as Q,u as $}from"./utils.05658db7.js";import{u as z}from"./useQuery.esm.0c9039e0.js";import{y as J,c as U,a as Z}from"./index.1ae84bf1.js";import{u as ee}from"./index.5ed05b55.js";import{u as te}from"./useMutation.esm.6965c8ad.js";import"./utils.esm.315e4825.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const C=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/notice/model/index.ts/atomMainTableActions",w(void 0));C.debugLabel="atomMainTableActions";const ae=()=>M(C),oe=()=>H(C),l=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/notice/model/index.ts/atomAddOrEditModal",Q({open:!1,actionType:"add"}));l.debugLabel="atomAddOrEditModal";const se=()=>M(l),ce=()=>{const e=E(l);return()=>{e({open:!0,actionType:"add"})}},ie=()=>{const e=E(l);return t=>{e({open:!0,actionType:"edit",record:t})}},ne=()=>$(l),re=["system","notice","dict"],F=()=>z(re,async()=>{const e=await _({dictType:"sys_notice_type"});return B(e)});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function ue(e,t){return p("/system/notice/add",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function de(e,t){return p("/system/notice/edit",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function le(e,t){return p("/system/notice/list",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function he(e,t){return p("/system/notice/remove",{method:"POST",params:{...e},...t||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const me=()=>{const e=f.exports.useRef(),{data:t}=F(),{canAddSysNotice:i,canEditSysConfig:c}=g(),r=ae(),{open:u,actionType:o,record:h}=se(),m=ne(),b=()=>{var s;o==="edit"&&((s=e.current)==null||s.resetFields()),m()};return f.exports.useEffect(()=>{if(u&&o==="edit"){const s=setTimeout(()=>{var d;(d=e.current)==null||d.setFieldsValue(h),clearTimeout(s)},0)}},[u]),a(y,{accessible:i||c,children:n(P,{formRef:e,width:800,title:o==="add"?"\u65B0\u589E\u516C\u544A":"\u7F16\u8F91\u516C\u544A",open:u,modalProps:{onCancel:b,okText:"\u63D0\u4EA4"},grid:!0,onFinish:async s=>{var d;o==="add"?(await ue(s),A.success("\u65B0\u589E\u6210\u529F")):(await de({...s,noticeId:h.noticeId}),A.success("\u7F16\u8F91\u6210\u529F")),r==null||r.reload(),m(),(d=e.current)==null||d.resetFields()},children:[a(I,{name:"noticeTitle",label:"\u516C\u544A\u6807\u9898",required:!0,rules:[{required:!0}],colProps:{span:12}}),a(x,{name:"noticeType",label:"\u516C\u544A\u7C7B\u578B",required:!0,rules:[{required:!0}],valueEnum:t!=null?t:{},colProps:{span:12}}),a(O.Group,{name:"status",label:"\u72B6\u6001",valueEnum:v,initialValue:R.ENABLE}),a(k,{name:"noticeContent",label:"\u5185\u5BB9",children:a(D,{})})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const pe={title:"\u5E8F\u53F7",dataIndex:"noticeId",key:"noticeId",valueType:"text",hideInSearch:!0},Ae={title:"\u516C\u544A\u6807\u9898",dataIndex:"noticeTitle",key:"noticeTitle",valueType:"text"};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ye=()=>{const{canAddSysNotice:e}=g(),t=ce();return a(y,{accessible:e,children:a(T,{icon:a(N,{}),type:"primary",onClick:t,children:"\u65B0\u589E"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Te=({record:e})=>{const t=ie();return a(T,{type:"link",icon:a(q,{}),onClick:()=>t(e),children:"\u7F16\u8F91"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const S=({noticeId:e,noticeTitle:t,disabled:i,isBatch:c})=>{const r=c?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",{canRemoveSysDict:u}=g(),o=ee(),{mutateAsync:h,isLoading:m}=te(async s=>{await he({noticeIds:s})},{onSuccess:()=>{var s;o==null||o.reload(),(s=o==null?void 0:o.clearSelected)==null||s.call(o),A.success("\u5220\u9664\u6210\u529F")}});return a(y,{accessible:u,children:a(T,{type:"link",danger:!0,disabled:i,icon:a(V,{}),onClick:()=>{W.confirm({title:"\u5220\u9664\u516C\u544A\u901A\u77E5",content:n(j,{children:["\u786E\u5B9A\u5220\u9664\u516C\u544A\u901A\u77E5",a(L.Text,{code:!0,children:t}),"\u5417\uFF1F"]}),onOk:async()=>h(e),okButtonProps:{loading:m}})},children:r})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ge="noticeId",Ce=({selectedRows:e})=>n(G,{children:[n("span",{children:["\u5DF2\u9009\u62E9 ",e.length," \u9879"]}),a(S,{isBatch:!0,disabled:e.length===0,noticeTitle:e.map(t=>t.noticeTitle).join(","),noticeId:e.map(t=>t.noticeId).join(",")})]}),be=()=>{const e=oe(),{data:t}=F();return a(X,{rowKey:ge,actionRef:e,columns:[pe,Ae,{title:"\u516C\u544A\u7C7B\u578B",dataIndex:"noticeType",key:"noticeType",valueType:"select",valueEnum:t!=null?t:{}},J,U,Z,{title:"\u64CD\u4F5C",valueType:"option",render:(i,c)=>n(j,{children:[a(Te,{record:c}),a(S,{noticeId:c.noticeId,noticeTitle:c.noticeTitle})]})}],request:async(...i)=>await le(Y(...i)),rowSelection:{alwaysShowAlert:!0},tableAlertRender:Ce,toolbar:{actions:[a(ye,{},"ButtonAdd")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const xe=()=>n(K,{children:[a(be,{}),a(me,{})]});export{xe as default};
