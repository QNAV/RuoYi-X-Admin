import{ad as k,af as D,cg as V,ag as R,r as C,d as a,b3 as g,j as M,bZ as O,aR as f,ch as B,aK as x,b_ as L,bS as N,b6 as X,b4 as Y,b5 as q,ci as _,b7 as G,b8 as w,c8 as K,k as z,aF as H}from"./index-5129c4ee.js";import{b,d as j}from"./index-4d2627ca.js";import{a as Q,b as U}from"./index-d91dac62.js";import{a as W,u as Z}from"./utils-2e2b94e3.js";import{v as $,w as J,x as ee,y as te,z as ae,A as se}from"./System-e98d1e38.js";import{P as T}from"./index-d05c32d6.js";import{P as oe}from"./index-41c8cbc3.js";import{P as E}from"./index-ccd06c0c.js";import{P as ce}from"./index-66210ff3.js";import{P as ie}from"./index-5d729dc5.js";import{u as v}from"./useMutation.esm-a8c6dcb5.js";import{u as re}from"./useRequest-7cae8ac0.js";import"./utils.esm-88b6f67f.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const P=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/dictDetails/model/index.ts/atomMainTableActions",k(void 0));P.debugLabel="atomMainTableActions";const F=()=>D(P),ne=()=>Q(P),S=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/dictDetails/model/index.ts/atomCurDictType",k({dictType:"",dictName:""}));S.debugLabel="atomCurDictType";const de=()=>D(S),le=()=>V(S),A=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/dictDetails/model/index.ts/atomAddOrEditModal",W({actionType:"add",open:!1}));A.debugLabel="atomAddOrEditModal";const ue=()=>D(A),he=()=>Z(A),me=()=>{const e=R(A);return()=>{e({actionType:"add",open:!0})}},pe=()=>{const e=R(A);return t=>{e({actionType:"edit",open:!0,record:t})}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ye=()=>{var n;const e=C.exports.useRef(),{canEditSysDict:t}=b(),i=F(),{open:s,actionType:l,record:c}=ue(),m=he(),p=()=>{var r;l==="edit"&&((r=e.current)==null||r.resetFields()),m()},{dictType:h,dictName:d}=de(),{data:o}=j("sys_normal_disable");return C.exports.useEffect(()=>{if(!s)return;const r=setTimeout(()=>{var u,y;l==="add"?(u=e.current)==null||u.setFieldsValue({dictType:h,dictName:d}):(y=e.current)==null||y.setFieldsValue({...c,dictName:d}),clearTimeout(r)},0)},[s]),a(g,{accessible:t,children:M(O,{formRef:e,width:500,title:"新增字典数据",open:s,modalProps:{onCancel:p,okText:"提交"},onFinish:async r=>{var u;l==="add"?(await $(r),f.success("新增成功")):(await J({...r,dictCode:c.dictCode}),f.success("编辑成功")),i==null||i.reload(),m(),(u=e.current)==null||u.resetFields()},children:[a(T,{name:"dictName",label:"字典名称",readonly:!0}),a(T,{name:"dictType",label:"字典类型",hidden:!0}),a(T,{name:"dictLabel",label:"数据标签",rules:[{required:!0}]}),a(T,{name:"dictValue",label:"数据键值",rules:[{required:!0}]}),a(T,{name:"cssClass",label:"样式属性"}),a(oe,{name:"dictSort",label:"显示排序",initialValue:0}),a(E,{name:"listClass",label:"回显样式",valueEnum:B,initialValue:"default"}),a(ce.Group,{name:"status",label:"状态",valueEnum:(n=o==null?void 0:o.mapData)!=null?n:{},initialValue:o==null?void 0:o.defaultValue}),a(ie,{name:"remark",label:"备注"})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Te=()=>{const{canEditSysDict:e}=b(),t=me();return a(g,{accessible:e,children:a(x,{icon:a(L,{}),type:"primary",onClick:t,children:"新增"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ge=({record:e})=>{const{canEditSysDict:t}=b(),i=pe();return a(g,{accessible:t,children:a(x,{type:"link",icon:a(N,{}),onClick:()=>i(e),children:"编辑"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const be=({searchParams:e})=>{const{canExportSysPost:t}=b(),{isLoading:i,mutate:s}=v(()=>ee(e),{onSuccess:()=>{f.success("导出成功")}});return a(g,{accessible:t,children:a(x,{ghost:!0,type:"primary",icon:a(X,{}),loading:i,onClick:()=>s(),children:"导出当前列表"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const I=({dictCode:e,disabled:t,isBatch:i})=>{const s=i?"批量删除":"删除",{canRemoveSysDict:l}=b(),c=F(),{mutateAsync:m,isLoading:p}=v(async d=>{await te({dictCodes:d})},{onSuccess:()=>{var d;c==null||c.reload(),(d=c==null?void 0:c.clearSelected)==null||d.call(c),f.success("删除成功")}});return a(g,{accessible:l,children:a(x,{type:"link",danger:!0,disabled:t,icon:a(Y,{}),onClick:()=>{q.confirm({title:"删除字典数据",content:`确定删除字典编码为 ${e} 的字典数据吗？`,onOk:()=>m(e),okButtonProps:{loading:p}})},children:s})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ae=()=>{var t;const{data:e}=j("sys_normal_disable");return[{title:"字典编码",dataIndex:"dictCode",key:"dictCode",valueType:"text",hideInSearch:!0},{title:"字典标签",dataIndex:"dictLabel",key:"dictLabel",valueType:"text"},{title:"字典键值",dataIndex:"dictValue",key:"dictValue",valueType:"text",hideInSearch:!0},{title:"字典排序",dataIndex:"dictSort",key:"dictSort",valueType:"text",hideInSearch:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:(t=e==null?void 0:e.mapData)!=null?t:{}},{title:"备注",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",hideInSearch:!0,sorter:!0},{title:"创建时间",dataIndex:"createTimeRange",key:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",valueType:"option",render:(i,s)=>M(z,{children:[a(ge,{record:s}),a(I,{dictCode:s.dictCode})]})}]},Ce=({selectedRows:e})=>a(I,{disabled:e.length===0,isBatch:!0,dictCode:e.map(t=>t.dictCode).join(",")}),fe=()=>{const e=_(),[t,i]=C.exports.useState({}),s=ne(),l=Ae(),c=C.exports.useRef(),[m,p]=le(),{data:h,run:d}=re(async()=>(await ae()).reduce((n,r)=>(n[r.dictType]=r.dictName,n),{}),{manual:!0,onSuccess:o=>{const n=e.dictType;p({dictType:n,dictName:o[n]});const r=setTimeout(()=>{var u,y;(u=c.current)==null||u.setFieldsValue({dictType:n}),(y=s==null?void 0:s.current)==null||y.reload(),clearTimeout(r)},0)}});return U("/system/dict/:dictType",()=>{d()}),a(G,{rowKey:"dictCode",actionRef:s,columns:l,params:m,request:async(...o)=>{const n=w(...o);return i(n),await se(w(...o))},tableAlertOptionRender:Ce,manualRequest:!0,toolbar:{actions:[a(be,{searchParams:t},"ButtonExport"),a(Te,{},"ButtonAdd")]},headerTitle:a(K,{formRef:c,children:a(E,{name:"dictType",valueEnum:h!=null?h:{},allowClear:!1,showSearch:!0,fieldProps:{onChange:o=>{p({dictType:o,dictName:h[o]})}}})})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ve=()=>M(H,{children:[a(fe,{}),a(ye,{})]});export{Ve as default};
