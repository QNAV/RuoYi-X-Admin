import{p as I,s as b,t as h,j as a,ah as d,ai as m,aj as T,ak as D,$ as g,al as B,e as p,F as j,am as S,r as v,K as f,an as k,ao as P,ap as M}from"./index.420d2bc2.js";import{e as C,j as A}from"./index.d0bd967d.js";import{b as O}from"./index.f32b5ff9.js";import{u as y}from"./useMutation.esm.c2afcb52.js";import"./useQuery.esm.86c767cc.js";import"./utils.esm.283448c2.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const F=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/operlog/model/index.ts/atomMainTableActions",I(void 0));F.debugLabel="atomMainTableActions";const x=()=>b(F),L=()=>O(F);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function w(e){return h("/monitor/operlog/clean",{method:"POST",...e||{}})}async function R(e,t){return h("/monitor/operlog/export",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function q(e,t){return h("/monitor/operlog/list",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function _(e,t){return h("/monitor/operlog/remove",{method:"POST",params:{...e},...t||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const V=()=>{const{canRemoveSysOperLog:e}=C(),t=x(),{isLoading:s,mutate:u}=y(()=>w(),{onSuccess:()=>{t==null||t.reload(),g.success("\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u6210\u529F")}});return a(d,{accessible:e,children:a(m,{danger:!0,icon:a(T,{}),onClick:()=>D.confirm({title:"\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7",content:"\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u540E\u5C06\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u5417\uFF1F",okButtonProps:{loading:s},onOk:u}),children:"\u6E05\u7A7A"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const K=({searchParams:e})=>{const{canExportSysOperLog:t}=C(),{isLoading:s,mutate:u}=y(()=>R(e),{onSuccess:()=>{g.success("\u5BFC\u51FA\u6210\u529F")}});return a(d,{accessible:t,children:a(m,{ghost:!0,type:"primary",icon:a(B,{}),loading:s,onClick:()=>u(),children:"\u5BFC\u51FA\u5F53\u524D\u5217\u8868"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const E=({operId:e,title:t,disabled:s,isBatch:u})=>{const n=u?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",{canRemoveSysOperLog:c}=C(),o=x(),{mutateAsync:i,isLoading:r}=y(async l=>{await _({operIds:l})},{onSuccess:()=>{var l;o==null||o.reload(),(l=o==null?void 0:o.clearSelected)==null||l.call(o),g.success("\u5220\u9664\u6210\u529F")}});return a(d,{accessible:c,children:a(m,{type:"link",danger:!0,disabled:s,icon:a(T,{}),onClick:()=>{D.confirm({title:"\u5220\u9664\u64CD\u4F5C\u65E5\u5FD7",content:p(j,{children:["\u786E\u5B9A\u5220\u9664\u64CD\u4F5C\u65E5\u5FD7",a(S.Text,{code:!0,children:t}),"\u5417\uFF1F"]}),onOk:async()=>i(e),okButtonProps:{loading:r}})},children:n})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const N=({selectedRows:e})=>p(M,{children:[p("span",{children:["\u5DF2\u9009\u62E9 ",e.length," \u9879"]}),a(E,{isBatch:!0,disabled:e.length===0,title:e.map(t=>t.operId).join(","),operId:e.map(t=>t.title).join(",")})]}),H=()=>{var c,o;const e=L(),[t,s]=v.exports.useState({}),{data:u}=A("sys_common_status"),{data:n}=A("sys_oper_type");return a(f,{children:a(k,{rowKey:"operId",actionRef:e,columns:[{title:"\u65E5\u5FD7\u7F16\u53F7",dataIndex:"operId",key:"operId",valueType:"text",hideInSearch:!0},{title:"\u7CFB\u7EDF\u6A21\u5757",dataIndex:"title",key:"title",valueType:"text"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"businessType",key:"businessType",valueType:"select",valueEnum:(c=n==null?void 0:n.mapData)!=null?c:{}},{title:"\u8BF7\u6C42\u65B9\u5F0F",dataIndex:"requestMethod",key:"requestMethod",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C\u4EBA\u5458",dataIndex:"operName",key:"operName",valueType:"text"},{title:"\u64CD\u4F5C\u5730\u5740",dataIndex:"operIp",key:"operIp",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C\u5730\u70B9",dataIndex:"operLocation",key:"operLocation",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(o=u==null?void 0:u.mapData)!=null?o:{}},{title:"\u64CD\u4F5C\u65E5\u671F",dataIndex:"operTime",key:"operTime",valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"option",key:"option",valueType:"option",fixed:"right",render:(i,r)=>a(E,{title:r.title,operId:r.operId})}],request:async(...i)=>{const r=P(...i);return s(r),await q(r)},toolbar:{actions:[a(V,{},"ButtonCleanUp"),a(K,{searchParams:t},"ButtonExport")]},rowSelection:{alwaysShowAlert:!0},tableAlertRender:N})})};export{H as default};
