import{j as S,F as I,a as w}from"./jsx-runtime-f6344dff.js";import{u as c,G as d,H as f}from"./vanilla-3fa884d6.js";import{p as i,v as m,w as D}from"./index-f7881e43.js";import{c as b,b as l,u as R}from"./index-88ffc593.js";import{a as p,u as M}from"./utils-7c8fe9f2.js";import{w as h}from"./utils.esm-376a1e3d.js";import{u as x}from"./useMutation.esm-345c3001.js";import{bh as L,bS as j,aw as C}from"./index-0cc72bc5.js";import"./mutation.esm-786b6dc1.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const y="systemMenu",u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",p({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));u.debugLabel="atomSelectedMenuData";const O=()=>M(u),B=()=>b(u),H=()=>l(u),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomModalAdd",p(!1));r.debugLabel="atomModalAdd";const K=()=>M(r),G=()=>{const e=R(r);return()=>e(!0)},W=()=>l(r),A=[y,"list"],z=(e={},a)=>c(A,async()=>{const t=await d(e),o=i(t,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:m(o),map:t.reduce((n,s)=>n.set(s.menuId,s),new Map),parentIds:Array.from(t.reduce((n,s)=>n.add(s.parentId),new Set))}},{onSuccess:t=>{a(t.parentIds)}}),T=()=>{const e=h();return()=>e.invalidateQueries(A)},g=[y,"options"],E=()=>c(g,async()=>{const e=await d({}),a=i(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:D(m(a)),map:e.reduce((t,o)=>t.set(o.menuId,o),new Map)}}),F=()=>{const e=h();return()=>e.invalidateQueries(g)},J=()=>{const e=T(),a=F(),t=O(),{mutateAsync:o,isLoading:n}=x(async s=>{await f({menuId:s})},{onSuccess:async()=>{t(),await Promise.all([e(),a()]),C.success("删除成功")}});return s=>{L.confirm({title:"操作确认",content:S(I,{children:["确定删除菜单",w(j.Text,{code:!0,children:s.menuName}),"吗？"]}),onOk:()=>o(s.menuId),okButtonProps:{loading:n}})}};export{B as useAtomStateSelectedMenuData,W as useAtomValueModalAdd,H as useAtomValueSelectedMenuData,J as useDeleteMenu,K as useHideModalAdd,z as useQueryMenuList,E as useQueryMenuOptions,T as useReFetchMenuList,F as useReFetchMenuOptions,O as useResetSelectedMenuData,G as useShowModalAdd};
