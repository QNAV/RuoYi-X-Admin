import{h as N,l as j,aW as A,Y as T,j as a,af as P,ag as g,bD as R,ai as w,g as B,F,aH as S,r as I,aA as q,bE as M,ak as f,av as x,al as k,I as U}from"./index.77cf182b.js";import{b as V,j as D}from"./index.8cf7e695.js";import{a as L}from"./index.9d0fc2aa.js";import{g as _,h as K,i as O,j as Y,k as X}from"./SysRoleService.1714eb6a.js";import{u as v}from"./useMutation.esm.87ca3d6d.js";import{u as H}from"./index.6f038472.js";import"./useQuery.esm.d069177d.js";import"./utils.esm.c3905fca.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const y=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/roleAuth/model/index.ts/atomMainTable",N(void 0));y.debugLabel="atomMainTable";const C=()=>j(y),Q=()=>L(y);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const E=({userId:e,userName:t,isBatch:n,disabled:u})=>{const o=n?"\u6279\u91CF\u53D6\u6D88\u6388\u6743":"\u53D6\u6D88\u6388\u6743",c=A(),i=Number(c.roleId),{canEditSysRole:h}=V(),r=C(),{mutateAsync:m,isLoading:l}=v(async()=>{Array.isArray(e)?await _({roleId:i,userIds:e}):await K({roleId:i,userId:e})},{onSuccess:()=>{var s;r==null||r.reload(),(s=r==null?void 0:r.clearSelected)==null||s.call(r),T.success("\u53D6\u6D88\u6388\u6743\u6210\u529F")}});return a(P,{accessible:h,children:a(g,{type:"link",danger:!0,disabled:u,icon:a(R,{}),onClick:()=>{w.confirm({title:"\u53D6\u6D88\u6388\u6743",content:B(F,{children:["\u786E\u5B9A\u53D6\u6D88\u6388\u6743\u7528\u6237",a(S.Text,{code:!0,children:t}),"\u5417\uFF1F"]}),onOk:()=>m(),okButtonProps:{loading:l}})},children:o})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const W=()=>{var p;const e=A(),t=Number(e.roleId),[n,{toggle:u}]=H(),o=I.exports.useRef(),[c,i]=I.exports.useState([]),h=C(),{isLoading:r,mutate:m}=v(()=>O({roleId:t,userIds:c}),{onSuccess:()=>{var s,d,b;(s=o.current)==null||s.reload(),(b=(d=o.current)==null?void 0:d.clearSelected)==null||b.call(d),h==null||h.reload(),u(),T.success("\u6388\u6743\u6210\u529F")}}),{data:l}=D("sys_common_status");return B(F,{children:[a(g,{type:"primary",icon:a(q,{}),onClick:()=>{var s;(s=o.current)==null||s.reload(),u()},children:"\u6388\u6743\u7528\u6237"}),a(M,{open:n,title:"\u6388\u6743\u7528\u6237",placement:"left",onClose:u,width:850,footer:a(g,{type:"primary",disabled:c.length===0,loading:r,onClick:()=>m(),children:"\u63D0\u4EA4"}),footerStyle:{textAlign:"right"},children:a(f,{ghost:!0,rowKey:"userId",actionRef:o,columns:[{dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"\u90AE\u7BB1",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},{pattern:x,message:"\u90AE\u7BB1\u683C\u5F0F\u9519\u8BEF"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text",copyable:!0},{title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(p=l==null?void 0:l.mapData)!=null?p:{},formItemProps:{initialValue:l==null?void 0:l.defaultValue,required:!0,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001"}]}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0}],tableAlertRender:!1,rowSelection:{onChange:s=>{i(s)}},request:(...s)=>Y(k(...s))})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const z=({selectedRows:e})=>a(E,{userId:e.map(t=>t.userId),userName:e.map(t=>t.userName).join(","),isBatch:!0,disabled:e.length===0}),G=()=>{var o;const e=A(),t=Number(e.roleId),n=Q(),{data:u}=D("sys_common_status");return a(f,{rowKey:"userId",actionRef:n,params:{roleId:t},columns:[{dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"\u90AE\u7BB1",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},{pattern:x,message:"\u90AE\u7BB1\u683C\u5F0F\u9519\u8BEF"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text",copyable:!0},{title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(o=u==null?void 0:u.mapData)!=null?o:{},formItemProps:{initialValue:u==null?void 0:u.defaultValue,required:!0,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001"}]}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:(c,i)=>a(E,{userId:i.userId,userName:i.userName})}],request:(...c)=>X(k(...c)),tableAlertRender:z,toolbar:{actions:[a(W,{},"DrawerTableAuth")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const re=()=>a(U,{children:a(G,{})});export{re as default};
