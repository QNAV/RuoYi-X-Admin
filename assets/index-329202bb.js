import{j as I,F as S,a as w}from"./jsx-runtime-f6344dff.js";import{y as f,c,u as D,a as d,I as i,J as R}from"./react-661e4416.js";import{p as m,u as l,v as b}from"./index-c0f81502.js";import{w as p}from"./utils.esm-0d150205.js";import{u as x}from"./useMutation.esm-f8681d30.js";import{bg as L,bQ as j,aw as C}from"./index-015dcaaa.js";import{a as M,u as h}from"./utils-c69b597a.js";import"./mutation.esm-7f23d645.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const y="systemMenu",u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",M({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));u.debugLabel="atomSelectedMenuData";const O=()=>h(u),V=()=>f(u),B=()=>c(u),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomModalAdd",M(!1));r.debugLabel="atomModalAdd";const K=()=>h(r),H=()=>{const e=D(r);return()=>e(!0)},J=()=>c(r),A=[y,"list"],W=(e={},a)=>d(A,async()=>{const t=await i(e),o=m(t,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:l(o),map:t.reduce((n,s)=>n.set(s.menuId,s),new Map),parentIds:Array.from(t.reduce((n,s)=>n.add(s.parentId),new Set))}},{onSuccess:t=>{a(t.parentIds)}}),Q=()=>{const e=p();return()=>e.invalidateQueries(A)},g=[y,"options"],z=()=>d(g,async()=>{const e=await i({}),a=m(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:b(l(a)),map:e.reduce((t,o)=>t.set(o.menuId,o),new Map)}}),T=()=>{const e=p();return()=>e.invalidateQueries(g)},E=()=>{const e=Q(),a=T(),t=O(),{mutateAsync:o,isLoading:n}=x(async s=>{await R({menuId:s})},{onSuccess:async()=>{t(),await Promise.all([e(),a()]),C.success("删除成功")}});return s=>{L.confirm({title:"操作确认",content:I(S,{children:["确定删除菜单",w(j.Text,{code:!0,children:s.menuName}),"吗？"]}),onOk:()=>o(s.menuId),okButtonProps:{loading:n}})}};export{V as useAtomStateSelectedMenuData,J as useAtomValueModalAdd,B as useAtomValueSelectedMenuData,E as useDeleteMenu,K as useHideModalAdd,W as useQueryMenuList,z as useQueryMenuOptions,Q as useReFetchMenuList,T as useReFetchMenuOptions,O as useResetSelectedMenuData,H as useShowModalAdd};
