import{h as D,l as I,o as r,j as a,af as i,ag as l,ah as C,ai as y,Y as h,aj as b,r as f,I as B,ak as E,al as v}from"./index.aa4e345d.js";import{b as p,j as g}from"./index.de3758c6.js";import{a as j}from"./index.61c72b77.js";import{u as d}from"./useMutation.esm.bb09728a.js";import"./useQuery.esm.8837d321.js";import"./utils.esm.b46db17b.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const m=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/operlog/model/index.ts/atomMainTableActions",D(void 0));m.debugLabel="atomMainTableActions";const F=()=>I(m),k=()=>j(m);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function S(e){return r("/monitor/operlog/clean",{method:"POST",...e||{}})}async function O(e,t){return r("/monitor/operlog/export",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function P(e,t){return r("/monitor/operlog/list",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function M(e,t){return r("/monitor/operlog/remove",{method:"POST",params:{...e},...t||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const L=()=>{const{canRemoveSysOperLog:e}=p(),t=F(),{isLoading:u,mutate:s}=d(()=>S(),{onSuccess:()=>{t==null||t.reload(),h.success("\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u6210\u529F")}});return a(i,{accessible:e,children:a(l,{danger:!0,icon:a(C,{}),onClick:()=>y.confirm({title:"\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7",content:"\u786E\u8BA4\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u5417\uFF1F",okButtonProps:{loading:u},onOk:s}),children:"\u6E05\u7A7A"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const w=({searchParams:e})=>{const{canExportSysOperLog:t}=p(),{isLoading:u,mutate:s}=d(()=>O(e),{onSuccess:()=>{h.success("\u5BFC\u51FA\u6210\u529F")}});return a(i,{accessible:t,children:a(l,{ghost:!0,type:"primary",icon:a(b,{}),loading:u,onClick:()=>s(),children:"\u5BFC\u51FA\u5F53\u524D\u5217\u8868"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const A=({operId:e,disabled:t=!1,isBatch:u=!1})=>{const s=u?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",{canRemoveSysOperLog:c}=p(),o=F(),{mutateAsync:T,isLoading:x}=d(async n=>{await M({operIds:n})},{onSuccess:()=>{var n;o==null||o.reload(),(n=o==null?void 0:o.clearSelected)==null||n.call(o),h.success("\u5220\u9664\u6210\u529F")}});return a(i,{accessible:c,children:a(l,{type:"link",danger:!0,disabled:t,icon:a(C,{}),onClick:()=>{y.confirm({title:"\u5220\u9664\u64CD\u4F5C\u65E5\u5FD7",content:`\u786E\u5B9A\u5220\u9664\u64CD\u4F5C\u7F16\u53F7\u4E3A ${e} \u7684\u64CD\u4F5C\u65E5\u5FD7\u5417`,onOk:async()=>T(e),okButtonProps:{loading:x}})},children:s})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const R=()=>{var u,s;const{data:e}=g("sys_common_status"),{data:t}=g("sys_oper_type");return[{title:"\u65E5\u5FD7\u7F16\u53F7",dataIndex:"operId",key:"operId",valueType:"text",hideInSearch:!0},{title:"\u7CFB\u7EDF\u6A21\u5757",dataIndex:"title",key:"title",valueType:"text"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"businessType",key:"businessType",valueType:"select",valueEnum:(u=t==null?void 0:t.mapData)!=null?u:{}},{title:"\u8BF7\u6C42\u65B9\u5F0F",dataIndex:"requestMethod",key:"requestMethod",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C\u4EBA\u5458",dataIndex:"operName",key:"operName",valueType:"text"},{title:"\u64CD\u4F5C\u5730\u5740",dataIndex:"operIp",key:"operIp",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C\u5730\u70B9",dataIndex:"operLocation",key:"operLocation",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(s=e==null?void 0:e.mapData)!=null?s:{}},{title:"\u64CD\u4F5C\u65E5\u671F",dataIndex:"operTime",key:"operTime",valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"option",key:"option",valueType:"option",fixed:"right",render:(c,o)=>a(A,{operId:o.operId})}]},q=({selectedRows:e})=>a(A,{isBatch:!0,disabled:e.length===0,operId:e.map(t=>t.operId).join(",")}),Q=()=>{const e=k(),t=R(),[u,s]=f.exports.useState({});return a(B,{children:a(E,{rowKey:"operId",actionRef:e,columns:t,request:async(...c)=>{const o=v(...c);return s(o),await P(o)},toolbar:{actions:[a(L,{},"ButtonCleanUp"),a(w,{searchParams:u},"ButtonExport")]},tableAlertOptionRender:q})})};export{Q as default};
