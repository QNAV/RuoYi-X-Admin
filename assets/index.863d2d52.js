import{a7 as ae,l as te,j as se,b0 as me,a as de,J as H,cT as U,N as ce,V as J,W as Ne,cU as be,cO as Fe,aI as I,r as F,D as e,aH as R,cV as ve,b5 as fe,a$ as pe,U as M,b2 as S,cC as y,cu as Ee,cW as he,ac as Ce,aT as G,bG as ye,cX as Be,ax as De,cY as v,c$ as Ae,aC as Z,c6 as xe}from"./index.98ae5275.js";import{B as Me}from"./index.4f67218f.js";import{u as q,A as K,P as A}from"./useAccess.bdeb68c5.js";import{u as V,M as N,b as ee,E as Y,a as ge,Y as g,c as Q}from"./useMutation.07bbd0ff.js";import{S as Ie,a as Se,b as Pe,c as ke,d as Te}from"./SysMenuService.e2e0388f.js";import{p as we,s as W,g as Re}from"./tree.eee3a2ff.js";import{M as ue,L as qe,T as Ve}from"./Tree.87469cba.js";import{P as Ye}from"./index.f1537d51.js";import{P as _e}from"./index.d631359a.js";import{E as ie}from"./index.eabf19b2.js";import{P}from"./index.0c884b5f.js";import{c as Oe,P as k}from"./index.3568eae8.js";import{M as Le}from"./RouteContext.b3801464.js";import{P as je}from"./index.cb1b1c31.js";import"./index.21b1c34d.js";import"./index.373c6b62.js";/* empty css              */var Xe=["fieldProps","request","params","proFieldProps"],$e=function(u,r){var l=u.fieldProps,n=u.request,d=u.params,s=u.proFieldProps,f=te(u,Xe);return se(me,de({valueType:"cascader",fieldProps:l,ref:r,request:n,params:d,filedConfig:{customLightMode:!0},proFieldProps:s},f))};const Ge=ae.forwardRef($e),_="systemMenu",Qe=i=>{const u=r=>r.filter(l=>l.menuType!==N.F).map(({menuId:l,menuName:n,children:d})=>({menuId:l,menuName:n,children:d?u(d):[]}));return[{menuId:0,menuName:"\u6839\u76EE\u5F55",children:i?u(i):[]}]},O=H({key:`${_}SelectedMenuId`,default:0}),re=()=>U(O),We=()=>ce(O),L=()=>J(O),j=H({key:`${_}VisibleCreateModal`,default:!1}),ze=()=>U(j),le=()=>Ne(j),He=()=>J(j),oe=[_,"list"],X=(i={})=>be(oe,async()=>{const u=await Ie(i),r=we(u,{id:"menuId",pId:"parentId",rootPId:null});return{options:Qe(W(r)),treeData:W(r),map:u.reduce((l,n)=>({...l,[n.menuId]:n}),{}),parentIds:Re(u)}}),ne=()=>{const i=Fe(),u=re();return V(async r=>{ue.confirm({title:"\u5220\u9664\u83DC\u5355",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u83DC\u5355\u5417\uFF1F",onOk:async()=>{await Se({menuId:r}),await i.invalidateQueries(oe),u(),I.success("\u5220\u9664\u6210\u529F")}})})};var a="/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/components/ButtonCreate.tsx";const z=(i,u)=>{const r=[0];if(u===0)return r;const l=n=>{var d;!(i!=null&&i[n])||((d=i==null?void 0:i[n])!=null&&d.parentId&&l(i[n].parentId.toString()),i[n].menuType!==N.F&&r.push(Number(n)))};return l(u.toString()),r},Ue=()=>{var m;const i=q(),u=F.exports.useRef(),r=le(),l=ze(),n=He(),d=L(),{data:s,refetch:f}=X(),{isLoading:p,mutate:E}=V(async()=>{var c,C;const t=await((C=(c=u.current)==null?void 0:c.validateFieldsReturnFormatValue)==null?void 0:C.call(c));!t||await Pe(t)},{onSuccess:()=>{var t;f(),l(),(t=u==null?void 0:u.current)==null||t.resetFields(),I.success("\u65B0\u5EFA\u6210\u529F")}});return F.exports.useEffect(()=>{var t,c;((t=u==null?void 0:u.current)==null?void 0:t.setFieldsValue)&&(s==null?void 0:s.map)&&((c=u==null?void 0:u.current)==null||c.setFieldsValue({parentId:z(s.map,d)}))},[d,s==null?void 0:s.map,u==null?void 0:u.current]),e(K,{accessible:i.canAddSysMenu,children:[e(R,{type:"primary",onClick:()=>r(!0),icon:e(ve,{},void 0,!1,{fileName:a,lineNumber:112,columnNumber:74},void 0),children:"\u65B0\u5EFA"},void 0,!1,{fileName:a,lineNumber:112,columnNumber:7},void 0),e(ue,{open:n,onCancel:l,title:"\u65B0\u5EFA\u83DC\u5355",width:515,okText:"\u63D0\u4EA4",onOk:()=>E(),okButtonProps:{loading:p},children:e(fe,{submitter:!1,formRef:u,children:[e(Ge,{name:"parentId",label:"\u7236\u7EA7\u83DC\u5355",initialValue:z((m=s==null?void 0:s.map)!=null?m:{},d),fieldProps:{options:s==null?void 0:s.options,fieldNames:{label:"menuName",value:"menuId",children:"children"},changeOnSelect:!0},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355"}],transform:t=>({parentId:t[t.length-1]})},void 0,!1,{fileName:a,lineNumber:128,columnNumber:11},void 0),e(A.Group,{name:"menuType",label:"\u83DC\u5355\u7C7B\u578B",valueEnum:ee,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u83DC\u5355\u7C7B\u578B"}]},void 0,!1,{fileName:a,lineNumber:143,columnNumber:11},void 0),e(pe,{name:["menuType"],children:({menuType:t})=>t?e(M,{children:[e(S,{children:[e(y,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0",width:"sm",rules:[{required:!0}]},void 0,!1,{fileName:a,lineNumber:159,columnNumber:21},void 0),e(_e,{name:"orderNum",label:"\u663E\u793A\u6392\u5E8F",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F",rules:[{required:!0}],width:"sm",initialValue:0},void 0,!1,{fileName:a,lineNumber:161,columnNumber:21},void 0)]},void 0,!0,{fileName:a,lineNumber:158,columnNumber:19},void 0),t!==N.F&&e(M,{children:[e(S,{children:[e(A.Group,{tooltip:"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",name:"status",label:"\u83DC\u5355\u72B6\u6001",valueEnum:Y,required:!0,initialValue:ge.ENABLE},void 0,!1,{fileName:a,lineNumber:174,columnNumber:25},void 0),e(A.Group,{name:"visible",label:"\u83DC\u5355\u662F\u5426\u663E\u793A",valueEnum:g,required:!0,initialValue:Q.YES,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"},void 0,!1,{fileName:a,lineNumber:183,columnNumber:25},void 0),e(A.Group,{name:"isFrame",label:"\u662F\u5426\u5916\u94FE",valueEnum:g,required:!0,initialValue:Q.NO,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"},void 0,!1,{fileName:a,lineNumber:192,columnNumber:25},void 0)]},void 0,!0,{fileName:a,lineNumber:173,columnNumber:23},void 0),e(S,{children:[e(y,{name:"icon",label:"\u83DC\u5355\u56FE\u6807",width:"sm",tooltip:"https://ant.design/components/icon-cn/"},void 0,!1,{fileName:a,lineNumber:203,columnNumber:25},void 0),e(y,{width:"sm",name:"path",label:"\u8DEF\u7531\u5730\u5740",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934",rules:[{required:!0}]},void 0,!1,{fileName:a,lineNumber:210,columnNumber:25},void 0)]},void 0,!0,{fileName:a,lineNumber:202,columnNumber:23},void 0)]},void 0,!0),t===N.C&&e(y,{name:"queryParam",label:"\u8DEF\u7531\u53C2\u6570",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'},void 0,!1,{fileName:a,lineNumber:222,columnNumber:21},void 0),t!==N.M&&e(y,{name:"perms",label:"\u6743\u9650\u6807\u8BC6"},void 0,!1,{fileName:a,lineNumber:229,columnNumber:47},void 0)]},void 0,!0):null},void 0,!1,{fileName:a,lineNumber:150,columnNumber:11},void 0),e(Ye,{name:"remark",label:"\u5907\u6CE8"},void 0,!1,{fileName:a,lineNumber:235,columnNumber:11},void 0)]},void 0,!0,{fileName:a,lineNumber:127,columnNumber:9},void 0)},void 0,!1,{fileName:a,lineNumber:116,columnNumber:7},void 0)]},void 0,!0,{fileName:a,lineNumber:111,columnNumber:5},void 0)};var T="/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/components/ButtonDelete.tsx";const Je=()=>{const i=q(),u=L(),{mutate:r,isLoading:l}=ne();return e(K,{accessible:i.canRemoveSysMenu,children:e(R,{icon:e(Ee,{},void 0,!1,{fileName:T,lineNumber:18,columnNumber:15},void 0),loading:l,disabled:u===0,danger:!0,onClick:()=>r(u),children:"\u5220\u9664"},void 0,!1,{fileName:T,lineNumber:17,columnNumber:7},void 0)},void 0,!1,{fileName:T,lineNumber:16,columnNumber:5},void 0)};var h="/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/components/DescDetails.tsx";const w={xs:1,sm:1,md:1,lg:1,xl:2},Ze=i=>F.exports.useMemo(()=>{const u=[];return i?(i!==N.F&&u.push({title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"radio",valueEnum:Y},{title:"\u662F\u5426\u663E\u793A",dataIndex:"visible",key:"visible",valueType:"radio",valueEnum:g,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"},{title:"\u662F\u5426\u5916\u94FE",dataIndex:"isFrame",key:"isFrame",valueType:"radio",valueEnum:g,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u56FE\u6807",dataIndex:"icon",key:"icon",valueType:"text",tooltip:"https://ant.design/components/icon-cn/"},{title:"\u8DEF\u7531\u5730\u5740",dataIndex:"path",key:"path",valueType:"text",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u8DEF\u7531\u53C2\u6570",dataIndex:"queryParam",key:"queryParam",valueType:"code",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'}),i!==N.M&&u.push({title:"\u6743\u9650\u6807\u8BC6",dataIndex:"perms",key:"perms",valueType:"text",copyable:!0}),u):[]},[i]),Ke=()=>{const i=q(),{refetch:u}=X(),r=L(),{data:l,loading:n,refresh:d}=he(async()=>await ke({menuId:r}),{ready:r>0,refreshDeps:[r]}),{mutateAsync:s}=V(Te,{onSuccess:()=>{d(),u(),I.success("\u4FDD\u5B58\u6210\u529F")}}),f=Ze(l==null?void 0:l.menuType),p=i.canEditSysMenu?{onSave:async(E,m)=>{const{menuType:t,orderNum:c,menuName:C,menuId:B}=m;await s({menuId:B,menuType:t,orderNum:c,menuName:C,[E]:m[E]})}}:void 0;return r===0?e(ie,{description:"\u70B9\u51FB\u9009\u62E9\u5DE6\u4FA7\u83DC\u5355\u9879\u67E5\u770B\u8BE6\u60C5"},void 0,!1,{fileName:h,lineNumber:127,columnNumber:36},void 0):e(Ce,{spinning:n,children:[e(P,{columns:[{title:"\u7C7B\u578B",dataIndex:"menuType",key:"menuType",valueType:"select",valueEnum:ee,editable:!1},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1}],dataSource:l,column:w},void 0,!1,{fileName:h,lineNumber:131,columnNumber:7},void 0),e(G,{},void 0,!1,{fileName:h,lineNumber:153,columnNumber:7},void 0),e(P,{columns:[{title:"\u540D\u79F0",dataIndex:"menuName",key:"menuName",valueType:"text"},{title:"\u663E\u793A\u987A\u5E8F",dataIndex:"orderNum",key:"orderNum",valueType:"digit",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F"},{title:"\u5907\u6CE8",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0}],dataSource:l,editable:p,column:w},void 0,!1,{fileName:h,lineNumber:155,columnNumber:7},void 0),e(G,{},void 0,!1,{fileName:h,lineNumber:183,columnNumber:7},void 0),e(P,{columns:f,dataSource:l,editable:p,column:w},void 0,!1,{fileName:h,lineNumber:185,columnNumber:7},void 0)]},void 0,!0,{fileName:h,lineNumber:130,columnNumber:5},void 0)};var o="/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/components/TreeMenu.tsx";const x={M:"blue",C:"green",F:"red"},eu=i=>e(M,{children:[e(v,{color:"rgb(148 163 184)",children:i.orderNum},void 0,!1,{fileName:o,lineNumber:27,columnNumber:7},void 0),(i==null?void 0:i.icon)&&e(Ae,{name:i.icon,className:"mr-1"},void 0,!1,{fileName:o,lineNumber:29,columnNumber:22},void 0),e(v,{color:x[i.menuType],style:{margin:"0 0 2px 0"},children:i.menuName},void 0,!1,{fileName:o,lineNumber:31,columnNumber:7},void 0),(i==null?void 0:i.perms)&&e(v,{style:{margin:"0 0 2px 2px"},children:e(Z,{size:"small",children:[i.perms,e(xe,{style:{color:"#1890ff"},onClick:u=>{Oe(i.perms),I.success("\u590D\u5236\u6210\u529F"),u.stopPropagation()}},void 0,!1,{fileName:o,lineNumber:39,columnNumber:13},void 0)]},void 0,!0,{fileName:o,lineNumber:37,columnNumber:11},void 0)},void 0,!1,{fileName:o,lineNumber:36,columnNumber:9},void 0)]},void 0,!0),uu=()=>e("div",{className:"mb-2",children:["\u6807\u7B7E\u542B\u4E49\uFF1A",e(v,{color:"rgb(148 163 184)",children:"\u663E\u793A\u987A\u5E8F"},void 0,!1,{fileName:o,lineNumber:57,columnNumber:5},void 0),e(v,{color:x[N.M],children:"\u76EE\u5F55"},void 0,!1,{fileName:o,lineNumber:58,columnNumber:5},void 0),e(v,{color:x[N.C],children:"\u83DC\u5355"},void 0,!1,{fileName:o,lineNumber:59,columnNumber:5},void 0),e(v,{color:x[N.F],children:"\u6309\u94AE"},void 0,!1,{fileName:o,lineNumber:60,columnNumber:5},void 0),e(v,{children:"\u6743\u9650\u6807\u8BC6"},void 0,!1,{fileName:o,lineNumber:61,columnNumber:5},void 0)]},void 0,!0,{fileName:o,lineNumber:55,columnNumber:3},void 0),iu=()=>{var $;const[i,u]=F.exports.useState({}),[r,l]=F.exports.useState([]),[n,d]=F.exports.useState([]),[s,f]=We(),p=re(),E=le(),{data:m,refetch:t}=X(i),{mutate:c}=ne(),C=D=>{l(D)},B=(n==null?void 0:n.length)!==0&&(n==null?void 0:n.length)===(($=m==null?void 0:m.parentIds)==null?void 0:$.length);return F.exports.useEffect(()=>{t()},[i]),F.exports.useEffect(()=>{r!=null&&r[0]?f(r[0]):p()},[r]),e(M,{children:[e(uu,{},void 0,!1,{fileName:o,lineNumber:100,columnNumber:7},void 0),e("div",{className:"flex justify-between items-center",children:[e(R,{size:"small",className:"my-2",icon:B?e(ye,{},void 0,!1,{fileName:o,lineNumber:106,columnNumber:33},void 0):e(Be,{},void 0,!1,{fileName:o,lineNumber:106,columnNumber:57},void 0),onClick:()=>d(B?[]:m==null?void 0:m.parentIds),children:B?"\u5168\u90E8\u6298\u53E0":"\u5168\u90E8\u5C55\u5F00"},void 0,!1,{fileName:o,lineNumber:103,columnNumber:9},void 0),e(qe,{onFinish:async D=>{l([]),d([]),u(D)},children:[e(y,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0"},void 0,!1,{fileName:o,lineNumber:119,columnNumber:11},void 0),e(je,{name:"status",label:"\u72B6\u6001",valueEnum:Y},void 0,!1,{fileName:o,lineNumber:121,columnNumber:11},void 0)]},void 0,!0,{fileName:o,lineNumber:112,columnNumber:9},void 0)]},void 0,!0,{fileName:o,lineNumber:102,columnNumber:7},void 0),e(De,{overlay:e(Le,{items:[{label:"\u65B0\u5EFA",key:"create",onClick:()=>E(!0)},{label:"\u5728\u6839\u76EE\u5F55\u4E0B\u65B0\u5EFA",key:"create",onClick:()=>{p(),E(!0)}},{label:"\u5220\u9664",key:"delete",danger:!0,disabled:r.length===0,onClick:()=>c(s)}]},void 0,!1,{fileName:o,lineNumber:127,columnNumber:11},void 0),trigger:["contextMenu"],children:e("div",{className:"max-h-[60vh] overflow-auto",children:m!=null&&m.treeData.length?e(Ve,{blockNode:!0,selectedKeys:r,onSelect:C,expandedKeys:n,titleRender:eu,onExpand:d,showLine:{showLeafIcon:!1},fieldNames:{title:"menuName",key:"menuId",children:"children"},treeData:m==null?void 0:m.treeData,onRightClick:D=>l([D.node.key])},void 0,!1,{fileName:o,lineNumber:156,columnNumber:13},void 0):e(ie,{},void 0,!1,{fileName:o,lineNumber:173,columnNumber:13},void 0)},void 0,!1,{fileName:o,lineNumber:154,columnNumber:9},void 0)},void 0,!1,{fileName:o,lineNumber:125,columnNumber:7},void 0)]},void 0,!0)};var b="/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/index.tsx";const hu=()=>e(Me,{children:e(k,{ghost:!0,gutter:24,children:[e(k,{title:"\u83DC\u5355\u5217\u8868",colSpan:"550px",extra:e(Z,{children:[e(Ue,{},void 0,!1,{fileName:b,lineNumber:19,columnNumber:15},void 0),e(Je,{},void 0,!1,{fileName:b,lineNumber:20,columnNumber:15},void 0)]},void 0,!0,{fileName:b,lineNumber:18,columnNumber:13},void 0),children:e(iu,{},void 0,!1,{fileName:b,lineNumber:24,columnNumber:11},void 0)},void 0,!1,{fileName:b,lineNumber:14,columnNumber:9},void 0),e(k,{title:"\u83DC\u5355\u8BE6\u60C5",children:e(Ke,{},void 0,!1,{fileName:b,lineNumber:28,columnNumber:11},void 0)},void 0,!1,{fileName:b,lineNumber:27,columnNumber:9},void 0)]},void 0,!0,{fileName:b,lineNumber:13,columnNumber:7},void 0)},void 0,!1,{fileName:b,lineNumber:12,columnNumber:5},void 0);export{hu as default};
