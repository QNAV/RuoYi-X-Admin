import{q as w,v as I,t as B,R as x,j as o,A as g,T as P,U as S,y as k,p as l,a as M,F,V as O,W as K,X as V,Y,Z as q,w as L,_ as N,x as X,$,o as D,z as W,m as H,a0 as U,B as _}from"./index-b5eebe28.js";import{D as y}from"./index-f26b40b8.js";import{a as z,u as Q}from"./utils-2835fcdf.js";import{bg as p,r as d,B as Z,b7 as G}from"./antd-f7a9cbdb.js";import{u as C}from"./useMutation-cb32f323.js";import"./@icon-park/react-8ab893b5.js";import"./@wangeditor/editor-2b25ac2d.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const A=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/config/model/index.ts/atomMainTableActions",w(void 0));A.debugLabel="atomMainTableActions";const j=()=>I(A),J=()=>B(A);var m=(e=>(e[e.Add=0]="Add",e[e.Edit=1]="Edit",e))(m||{});const ee={[y.Add]:"新增",[y.Edit]:"编辑"},u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/config/model/index.ts/atomAddOrEditModal",z({open:!1,actionType:0}));u.debugLabel="atomAddOrEditModal";const te=()=>I(u),oe=()=>{const e=x(u);return()=>{e({open:!0,actionType:0})}},ae=()=>{const e=x(u);return t=>{e({open:!0,actionType:1,record:t})}},se=()=>Q(u);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ce=({record:e})=>{const t=ae();return o(g,{accessKey:"system:config:edit",children:o(P,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const E=({configIds:e,disabled:t,batch:s})=>{const{modal:c,message:i}=p.useApp(),a=j(),{mutate:n,isLoading:f}=C(S,{onSuccess:()=>{var h;a==null||a.reload(),(h=a==null?void 0:a.clearSelected)==null||h.call(a),i.success("删除成功")}});return o(g,{accessKey:"system:config:remove",children:o(k,{batch:s,disabled:t,onClick:()=>{c.confirm({title:"操作确认",content:`确定删除参数编号为 ${e.join(",")} 的参数吗？`,onOk:()=>n({configIds:e}),okButtonProps:{loading:f}})}})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const[ne]=l({title:"参数主键",dataIndex:"configId",table:{valueType:"text",hideInSearch:!0}}),[ie,,re]=l({title:"参数名称",dataIndex:"configName",table:{valueType:"text"},form:{valueType:"text",formItemProps:{rules:[{required:!0}]}}}),[le,,ue]=l({title:"参数键名",dataIndex:"configKey",table:{valueType:"text"},form:{valueType:"text",formItemProps:{rules:[{required:!0}]}}}),[he,,de]=l({title:"参数键值",dataIndex:"configValue",table:{valueType:"text"},form:{valueType:"text",formItemProps:{rules:[{required:!0}]}}}),R=()=>{const{valueEnumSysYesNo:e}=O();return l({title:"系统内置",dataIndex:"configType",valueEnum:e,table:{valueType:"select"},form:{valueType:"radio",formItemProps:{rules:[{required:!0}]}}})},[me,,ge]=l({title:"备注",dataIndex:"remark",table:{valueType:"textarea",hideInSearch:!0},form:{valueType:"textarea"}}),[pe]=l({title:"创建时间",dataIndex:"createTime",table:{valueType:"dateTime",hideInSearch:!0,sorter:!0}}),[fe]=l({title:"创建时间",dataIndex:"createTimeRange",table:{valueType:"dateTimeRange",hideInTable:!0}}),Te=()=>{const[e]=R();return[ne,ie,le,he,e,me,pe,fe,{title:"操作",valueType:"option",fixed:"right",render:(t,s)=>M(F,{children:[o(ce,{record:s}),o(E,{configIds:[s.configId]})]})}]},Ce=()=>{const[,,e]=R();return[re,ue,de,e,ge]};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ae=()=>{const{message:e}=p.useApp(),t=d.useRef(),s=j(),{open:c,actionType:i,record:a}=te(),n=se(),f=()=>{var r;i===m.Edit&&((r=t.current)==null||r.resetFields()),n()},T=ee[i],h=async r=>{var b;i===m.Add?await V(r):await Y({...r,configId:a.configId}),n(),(b=t.current)==null||b.resetFields(),s==null||s.reload(),e.success(`${T}成功`)},v=Ce();return d.useEffect(()=>{c&&i===m.Edit&&d.startTransition(()=>{var r;(r=t.current)==null||r.setFieldsValue(a)})},[c]),o(K,{title:`${T}参数设置`,layoutType:"ModalForm",formRef:t,width:500,open:c,modalProps:{onCancel:f,okText:"提交"},onFinish:h,columns:v})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const be=()=>{const e=oe();return o(g,{accessKey:"system:config:add",children:o(q,{onClick:e})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ye=async e=>{const{data:t}=await N(e,{format:"blob"});await X(t,`config_${new Date().getTime()}.xlsx`)},Ie=({searchParams:e})=>{const{message:t}=p.useApp(),{isLoading:s,mutate:c}=C(ye,{onSuccess:()=>{t.success("导出成功")}});return o(g,{accessKey:"system:config:export",children:o(L,{loading:s,onClick:()=>c(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const xe=()=>{const{message:e,modal:t}=p.useApp(),{isLoading:s,mutate:c}=C($,{onSuccess:()=>{e.success("刷新成功")}});return o(Z,{danger:!0,icon:o(G,{}),onClick:()=>{t.confirm({title:"操作确认",content:"确定刷新缓存吗？",onOk:()=>c({}),okButtonProps:{loading:s}})},children:"刷新缓存"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Me=({selectedRowKeys:e})=>o(E,{disabled:e.length===0,batch:!0,configIds:e}),je=()=>{const e=J(),t=Te(),[s,c]=d.useState({});return o(D,{rowKey:"configId",actionRef:e,columns:t,tableAlertOptionRender:Me,request:async(...i)=>{const{createTimeRange:a,...n}=W(...i);return H(a)&&(n.beginTime=a[0],n.endTime=a[1]),c(n),await U(n)},toolbar:{actions:[o(xe,{},"ButtonRefresh"),o(Ie,{searchParams:s},"ButtonExport"),o(be,{},"ButtonAdd")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ke=()=>M(_,{children:[o(je,{}),o(Ae,{})]});export{ke as default};
