import{r as m}from"./jsx-runtime-f6344dff.js";import{a as Et}from"./vanilla-228b7eb5.js";const R=Symbol(),L=c=>!!c[R],v=c=>!c[R].c,y=c=>{var d;const{b:a,c:f}=c[R];f&&(f(),(d=pt.get(a))==null||d())},x=(c,d)=>{const a=c[R].o,f=d[R].o;return a===f||c===f||L(a)&&x(a,d)},q=(c,d)=>{const a={b:c,o:d,c:null},f=new Promise(_=>{a.c=()=>{a.c=null,_()},d.finally(a.c)});return f[R]=a,f},lt=c=>q(c[R].b,c[R].o),pt=new WeakMap,U=c=>"init"in c,X="r",z="w",D="c",W="s",rt="h",_t="n",ht="l",At="a",Ot="m",St=c=>{const d=new WeakMap,a=new WeakMap,f=new Map;let _,h;if(({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&(_=new Set,h=new Set),c)for(const[e,t]of c){const n={v:t,r:0,y:!0,d:new Map};({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&(Object.freeze(n),U(e)||console.warn("Found initial value for derived atom which can cause unexpected behavior",e)),d.set(e,n)}const A=new WeakMap,O=(e,t,n)=>{let r=A.get(t);r||(r=new Map,A.set(t,r)),n.then(()=>{r.get(e)===n&&(r.delete(e),r.size||A.delete(t))}),r.set(e,n)},I=e=>{const t=new Set,n=A.get(e);return n&&(A.delete(e),n.forEach((r,o)=>{y(r),t.add(o)})),t},S=new WeakMap,T=e=>{let t=S.get(e);return t||(t=new Map,S.set(e,t)),t},E=(e,t)=>{if(e){const n=T(e);let r=n.get(t);return r||(r=E(e.p,t),r&&"p"in r&&v(r.p)&&(r=void 0),r&&n.set(t,r)),r}return d.get(t)},l=(e,t,n)=>{if(({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&Object.freeze(n),e)T(e).set(t,n);else{const r=d.get(t);d.set(t,n),f.has(t)||f.set(t,r)}},p=(e,t=new Map,n)=>{if(!n)return t;const r=new Map;let o=!1;return n.forEach(i=>{var s;const u=((s=E(e,i))==null?void 0:s.r)||0;r.set(i,u),t.get(i)!==u&&(o=!0)}),t.size===r.size&&!o?t:r},P=(e,t,n,r,o)=>{const i=E(e,t);if(i){if(o&&(!("p"in i)||!x(i.p,o)))return i;"p"in i&&y(i.p)}const s={v:n,r:(i==null?void 0:i.r)||0,y:!0,d:p(e,i==null?void 0:i.d,r)};let u=!(i!=null&&i.y);return!i||!("v"in i)||!Object.is(i.v,n)?(u=!0,++s.r,s.d.has(t)&&(s.d=new Map(s.d).set(t,s.r))):s.d!==i.d&&(s.d.size!==i.d.size||!Array.from(s.d.keys()).every(w=>i.d.has(w)))&&(u=!0,Promise.resolve().then(()=>{V(e)})),i&&!u?i:(l(e,t,s),s)},j=(e,t,n,r,o)=>{const i=E(e,t);if(i){if(o&&(!("p"in i)||!x(i.p,o)))return i;"p"in i&&y(i.p)}const s={e:n,r:((i==null?void 0:i.r)||0)+1,y:!0,d:p(e,i==null?void 0:i.d,r)};return l(e,t,s),s},$=(e,t,n,r)=>{const o=E(e,t);if(o&&"p"in o){if(x(o.p,n)&&!v(o.p))return o.y?o:{...o,y:!0};y(o.p)}O(e,t,n);const i={p:n,r:((o==null?void 0:o.r)||0)+1,y:!0,d:p(e,o==null?void 0:o.d,r)};return l(e,t,i),i},K=(e,t,n,r)=>{if(n instanceof Promise){const o=q(n,n.then(i=>{P(e,t,i,r,o)}).catch(i=>{if(i instanceof Promise)return L(i)?i.then(()=>{M(e,t,!0)}):i;j(e,t,i,r,o)}));return $(e,t,o,r)}return P(e,t,n,r)},st=(e,t)=>{const n=E(e,t);if(n){const r={...n,y:!1};l(e,t,r)}else({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&console.warn("[Bug] could not invalidate non existing atom",t)},M=(e,t,n)=>{if(!n){const o=E(e,t);if(o){if(o.y&&"p"in o&&!v(o.p))return o;if(o.d.forEach((i,s)=>{if(s!==t)if(!a.has(s))M(e,s);else{const u=E(e,s);u&&!u.y&&M(e,s)}}),Array.from(o.d).every(([i,s])=>{const u=E(e,i);return u&&!("p"in u)&&u.r===s}))return o.y?o:{...o,y:!0}}}const r=new Set;try{const o=t.read(i=>{r.add(i);const s=i===t?E(e,i):M(e,i);if(s){if("e"in s)throw s.e;if("p"in s)throw s.p;return s.v}if(U(i))return i.init;throw new Error("no atom init")});return K(e,t,o,r)}catch(o){if(o instanceof Promise){const i=L(o)&&v(o)?lt(o):q(o,o);return $(e,t,i,r)}return j(e,t,o,r)}},J=(e,t)=>M(t,e),ct=(e,t)=>{let n=a.get(t);return n||(n=C(e,t)),n},N=(e,t)=>!t.l.size&&(!t.t.size||t.t.size===1&&t.t.has(e)),ut=(e,t)=>{const n=a.get(t);n&&N(t,n)&&k(e,t)},H=(e,t)=>{const n=a.get(t);n==null||n.t.forEach(r=>{r!==t&&(st(e,r),H(e,r))})},Q=(e,t,n)=>{let r=!0;const o=(u,w)=>{const g=M(e,u);if("e"in g)throw g.e;if("p"in g){if(w!=null&&w.unstable_promise)return g.p.then(()=>{const Y=E(e,u);return Y&&"p"in Y&&Y.p===g.p?new Promise(B=>setTimeout(B)).then(()=>o(u,w)):o(u,w)});throw({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&console.info("Reading pending atom state in write operation. We throw a promise for now.",u),g.p}if("v"in g)return g.v;throw({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",u),new Error("no value found")},i=(u,w)=>{let g;if(u===t){if(!U(u))throw new Error("atom not writable");I(u).forEach(ot=>{ot!==e&&K(ot,u,w)});const B=E(e,u),ft=K(e,u,w);B!==ft&&H(e,u)}else g=Q(e,u,w);return r||V(e),g},s=t.write(o,i,n);return r=!1,s},b=(e,t,n)=>{const r=Q(n,e,t);return V(n),r},at=e=>!!e.write,C=(e,t,n)=>{const r={t:new Set(n&&[n]),l:new Set};if(a.set(t,r),({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&h.add(t),M(void 0,t).d.forEach((i,s)=>{const u=a.get(s);u?u.t.add(t):s!==t&&C(e,s,t)}),at(t)&&t.onMount){const i=u=>b(t,u,e),s=t.onMount(i);e=void 0,s&&(r.u=s)}return r},k=(e,t)=>{var n;const r=(n=a.get(t))==null?void 0:n.u;r&&r(),a.delete(t),({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&h.delete(t);const o=E(e,t);o?("p"in o&&y(o.p),o.d.forEach((i,s)=>{if(s!==t){const u=a.get(s);u&&(u.t.delete(t),N(s,u)&&k(e,s))}})):({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&console.warn("[Bug] could not find atom state to unmount",t)},Z=(e,t,n,r)=>{const o=new Set(n.d.keys());r==null||r.forEach((i,s)=>{if(o.has(s)){o.delete(s);return}const u=a.get(s);u&&(u.t.delete(t),N(s,u)&&k(e,s))}),o.forEach(i=>{const s=a.get(i);s?s.t.add(t):a.has(t)&&C(e,i,t)})},V=e=>{if(e){T(e).forEach((n,r)=>{const o=d.get(r);if(n!==o){const i=a.get(r);i==null||i.l.forEach(s=>s(e))}});return}for(;f.size;){const t=Array.from(f);f.clear(),t.forEach(([n,r])=>{const o=E(void 0,n);if(o&&o.d!==(r==null?void 0:r.d)&&Z(void 0,n,o,r==null?void 0:r.d),r&&!r.y&&(o!=null&&o.y))return;const i=a.get(n);i==null||i.l.forEach(s=>s())})}({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&_.forEach(t=>t())},dt=e=>{T(e).forEach((n,r)=>{const o=d.get(r);(!o||n.r>o.r||n.y!==o.y||n.r===o.r&&n.d!==o.d)&&(d.set(r,n),n.d!==(o==null?void 0:o.d)&&Z(e,r,n,o==null?void 0:o.d))})},tt=(e,t)=>{t&&dt(t),V(void 0)},et=(e,t,n)=>{const o=ct(n,e).l;return o.add(t),()=>{o.delete(t),ut(n,e)}},nt=(e,t)=>{for(const[n,r]of e)U(n)&&(K(t,n,r),H(t,n));V(t)};return({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"?{[X]:J,[z]:b,[D]:tt,[W]:et,[rt]:nt,[_t]:e=>(_.add(e),()=>{_.delete(e)}),[ht]:()=>h.values(),[At]:e=>d.get(e),[Ot]:e=>a.get(e)}:{[X]:J,[z]:b,[D]:tt,[W]:et,[rt]:nt}},it=(c,d)=>({s:d?d(c).SECRET_INTERNAL_store:St(c)}),G=new Map,F=c=>(G.has(c)||G.set(c,m.createContext(it())),G.get(c)),Rt=({children:c,initialValues:d,scope:a,unstable_createStore:f,unstable_enableVersionedWrite:_})=>{const[h,A]=m.useState({});m.useEffect(()=>{const S=O.current;S.w&&(S.s[D](null,h),delete h.p,S.v=h)},[h]);const O=m.useRef();if(!O.current){const S=it(d,f);if(_){let T=0;S.w=E=>{A(l=>{const p=T?l:{p:l};return E(p),p})},S.v=h,S.r=E=>{++T,E(),--T}}O.current=S}const I=F(a);return m.createElement(I.Provider,{value:O.current},c)};function It(c,d){return Et(c,d)}function Tt(c,d){const a=F(d),f=m.useContext(a),{s:_,v:h}=f,A=l=>{const p=_[X](c,l);if(({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&!p.y)throw new Error("should not be invalidated");if("e"in p)throw p.e;if("p"in p)throw p.p;if("v"in p)return p.v;throw new Error("no atom value")},[[O,I,S],T]=m.useReducer((l,p)=>{const P=A(p);return Object.is(l[1],P)&&l[2]===c?l:[p,P,c]},h,l=>{const p=A(l);return[l,p,c]});let E=I;return S!==c&&(T(O),E=A(O)),m.useEffect(()=>{const{v:l}=f;l&&_[D](c,l);const p=_[W](c,T,l);return T(l),p},[_,c,f]),m.useEffect(()=>{_[D](c,O)}),m.useDebugValue(E),E}function mt(c,d){const a=F(d),{s:f,w:_}=m.useContext(a);return m.useCallback(A=>{if(({VITE_API_HOST:"https://test-ryx-admin-api.p.quicknav.cn",VITE_TOKEN_KEY:"RUOYI_TOKEN_GH",BASE_URL:"/RuoYi-X-Admin/",MODE:"gh",DEV:!1,PROD:!0}&&"gh")!=="production"&&!("write"in c))throw new Error("not writable atom");const O=I=>f[z](c,A,I);return _?_(O):O()},[f,_,c])}function Mt(c,d){return"scope"in c&&(console.warn("atom.scope is deprecated. Please do useAtom(atom, scope) instead."),d=c.scope),[Tt(c,d),mt(c,d)]}export{Rt as P,It as a,Tt as b,Mt as c,F as g,mt as u};
