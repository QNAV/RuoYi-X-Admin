import{b4 as st,j as o,a as A,F as Se,n as X,u as Ct,b5 as bt,b6 as wt,q as St,v as it,t as It,R as Rt,a1 as lt,b7 as Et,b8 as Tt,b9 as ct,ba as dt,bb as ut,a4 as At,bc as kt,p as se,a5 as Pt,A as Ie,W as Dt,Z as Nt,bd as Kt,i as _t,be as Mt,y as Bt,bf as jt,a9 as Lt,bg as zt,bh as $t,bi as Ot,d as Ft,aa as $e,bj as Ht,bk as Vt,bl as qt,B as Qt}from"./index-b5eebe28.js";import{r as u,C as Oe,i as Fe,k as He,m as be,p as W,o as n,bs as Le,g as C,aX as Ye,aa as Ut,e as ge,a0 as Wt,bt as Yt,bu as Xt,n as Xe,a5 as Gt,bg as _e,B as we,bc as Jt,M as Zt,ai as Ve,aL as ea,ah as ze,ba as ta,E as aa,b8 as na,b9 as oa,al as mt,a$ as ht}from"./antd-f7a9cbdb.js";import{u as qe}from"./useMutation-cb32f323.js";import{a as ra,u as sa}from"./utils-2835fcdf.js";import{P as Ge}from"./index-b65ca6ac.js";import{i as Je,u as ia}from"./useRequest-238e95e7.js";import{P as la}from"./index-ddc152a2.js";import"./@icon-park/react-8ab893b5.js";import"./@wangeditor/editor-2b25ac2d.js";function ca(e,t){for(var a=e,r=0;r<t.length;r+=1){if(a==null)return;a=a[t[r]]}return a}var da=["title","subTitle","avatar","description","extra","content","actions","type"],ua=da.reduce(function(e,t){return e.set(t,!0),e},new Map);function ma(e,t){return ga(e)||fa(e,t)||pa(e,t)||ha()}function ha(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pa(e,t){if(e){if(typeof e=="string")return Ze(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ze(e,t)}}function Ze(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function fa(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var a=[],r=!0,i=!1,c=void 0;try{for(var s=e[Symbol.iterator](),h;!(r=(h=s.next()).done)&&(a.push(h.value),!(t&&a.length===t));r=!0);}catch(I){i=!0,c=I}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw c}}return a}}function ga(e){if(Array.isArray(e))return e}function ya(e,t){var a=t||{},r=a.defaultValue,i=a.value,c=a.onChange,s=a.postState,h=u.useState(function(){return i!==void 0?i:r!==void 0?typeof r=="function"?r():r:typeof e=="function"?e():e}),I=ma(h,2),w=I[0],d=I[1],p=i!==void 0?i:w;s&&(p=s(p));function x(S){d(S),p!==S&&c&&c(S,p)}var l=u.useRef(!0);return u.useEffect(function(){if(l.current){l.current=!1;return}i===void 0&&d(i)},[i]),[p,x]}var xa=["title","subTitle","content","itemTitleRender","prefixCls","actions","item","recordKey","avatar","cardProps","description","isEditable","checkbox","index","selected","loading","expand","onExpand","expandable","rowSupportExpand","showActions","showExtra","type","style","className","record","onRow","onItem","itemHeaderRender","cardActionProps","extra"];function va(e){var t,a=e.prefixCls,r=e.expandIcon,i=r===void 0?o(Ut,{}):r,c=e.onExpand,s=e.expanded,h=e.record,I=e.hashId,w=i,d="".concat(a,"-row-expand-icon"),p=function(l){c(!s),l.stopPropagation()};return typeof i=="function"&&(w=i({expanded:s,onExpand:c,record:h})),o("span",{className:W(d,I,(t={},n(t,"".concat(a,"-row-expanded"),s),n(t,"".concat(a,"-row-collapsed"),!s),t)),onClick:p,children:w})}function Ca(e){var t,a,r,i,c,s=e.prefixCls,h=u.useContext(Oe||Fe.ConfigContext),I=h.getPrefixCls,w=u.useContext(st),d=w.hashId,p=I("pro-list",s),x="".concat(p,"-row"),l=e.title,S=e.subTitle,M=e.content,P=e.itemTitleRender;e.prefixCls;var k=e.actions;e.item,e.recordKey;var g=e.avatar,j=e.cardProps,q=e.description,G=e.isEditable,m=e.checkbox,b=e.index,J=e.selected,z=e.loading,Y=e.expand,v=e.onExpand,K=e.expandable,B=e.rowSupportExpand,ie=e.showActions,le=e.showExtra,ce=e.type,Q=e.style,Z=e.className,F=Z===void 0?x:Z,E=e.record,$=e.onRow,D=e.onItem,R=e.itemHeaderRender,N=e.cardActionProps,_=e.extra,ee=He(e,xa),O=K||{},te=O.expandedRowRender,de=O.expandIcon,Re=O.expandRowByClick,Ee=O.indentSize,U=Ee===void 0?8:Ee,Te=O.expandedRowClassName,xe=ya(!!Y,{value:Y,onChange:v}),L=be(xe,2),f=L[0],T=L[1],y=W((t={},n(t,"".concat(x,"-selected"),!j&&J),n(t,"".concat(x,"-show-action-hover"),ie==="hover"),n(t,"".concat(x,"-type-").concat(ce),!!ce),n(t,"".concat(x,"-editable"),G),n(t,"".concat(x,"-show-extra-hover"),le==="hover"),t),d,x),ae=W(d,n({},"".concat(F,"-extra"),le==="hover")),ue=f||Object.values(K||{}).length===0,me=te&&te(E,b,U,f),ne=u.useMemo(function(){if(!(!k||N==="actions"))return[o("div",{onClick:function(V){return V.stopPropagation()},children:k},"action")]},[k,N]),Ae=u.useMemo(function(){if(!(!k||!N||N==="extra"))return[o("div",{className:"".concat(y,"-actions ").concat(d),onClick:function(V){return V.stopPropagation()},children:k},"action")]},[k,N,y,d]),ve=l||S?A("div",{className:"".concat(y,"-header-title ").concat(d),children:[l&&o("div",{className:"".concat(y,"-title ").concat(d),children:l}),S&&o("div",{className:"".concat(y,"-subTitle ").concat(d),children:S})]}):null,he=(a=P&&(P==null?void 0:P(E,b,ve)))!==null&&a!==void 0?a:ve,ke=he||g||S||q?o(Le.Item.Meta,{avatar:g,title:he,description:q&&ue&&o("div",{className:"".concat(y,"-description ").concat(d),children:q})}):null,Pe=W(d,(r={},n(r,"".concat(y,"-item-has-checkbox"),m),n(r,"".concat(y,"-item-has-avatar"),g),n(r,y,y),r)),H=u.useMemo(function(){return g||l?A(Se,{children:[g,o("span",{className:"".concat(I("list-item-meta-title")," ").concat(d),children:l})]}):null},[g,I,d,l]),pe=j?o(X,C(C(C({bordered:!0,loading:z,hoverable:!0},j),{},{title:H,subTitle:S,extra:ne,actions:Ae,bodyStyle:C({padding:24},j.bodyStyle)},D==null?void 0:D(E,b)),{},{children:o(Ye,{avatar:!0,title:!1,loading:z,active:!0,children:A("div",{className:"".concat(y,"-header ").concat(d),children:[P&&(P==null?void 0:P(E,b,ve)),M]})})})):o(Le.Item,C(C(C(C({className:W(Pe,d,n({},F,F!==x))},ee),{},{actions:ne,extra:!!_&&o("div",{className:ae,children:_})},$==null?void 0:$(E,b)),D==null?void 0:D(E,b)),{},{onClick:function(V){var oe,fe,De,Be;$==null||(oe=$(E,b))===null||oe===void 0||(fe=oe.onClick)===null||fe===void 0||fe.call(oe,V),D==null||(De=D(E,b))===null||De===void 0||(Be=De.onClick)===null||Be===void 0||Be.call(De,V),Re&&T(!f)},children:A(Ye,{avatar:!0,title:!1,loading:z,active:!0,children:[A("div",{className:"".concat(y,"-header ").concat(d),children:[A("div",{className:"".concat(y,"-header-option ").concat(d),children:[!!m&&o("div",{className:"".concat(y,"-checkbox ").concat(d),children:m}),Object.values(K||{}).length>0&&B&&va({prefixCls:p,hashId:d,expandIcon:de,onExpand:T,expanded:f,record:E})]}),(i=R&&(R==null?void 0:R(E,b,ke)))!==null&&i!==void 0?i:ke]}),ue&&(M||me)&&A("div",{className:"".concat(y,"-content ").concat(d),children:[M,te&&B&&o("div",{className:Te&&Te(E,b,U),children:me})]})]})}));return j?o("div",{className:W(d,(c={},n(c,"".concat(y,"-card"),j),n(c,F,F!==x),c)),style:Q,children:pe}):pe}var ba=["dataSource","columns","rowKey","showActions","showExtra","prefixCls","actionRef","itemTitleRender","renderItem","itemCardProps","itemHeaderRender","expandable","rowSelection","pagination","onRow","onItem","rowClassName"];function wa(e){var t=e.dataSource,a=e.columns,r=e.rowKey,i=e.showActions,c=e.showExtra,s=e.prefixCls,h=e.actionRef,I=e.itemTitleRender,w=e.renderItem,d=e.itemCardProps,p=e.itemHeaderRender,x=e.expandable,l=e.rowSelection,S=e.pagination,M=e.onRow,P=e.onItem,k=e.rowClassName,g=He(e,ba),j=u.useContext(st),q=j.hashId,G=u.useContext(Oe||Fe.ConfigContext),m=G.getPrefixCls,b=ge.useMemo(function(){return typeof r=="function"?r:function(L,f){return L[r]||f}},[r]),J=Wt(t,"children",b),z=be(J,1),Y=z[0],v=Yt(t.length,function(){},S),K=be(v,1),B=K[0],ie=ge.useMemo(function(){if(S===!1||!B.pageSize||t.length<B.total)return t;var L=B.current,f=L===void 0?1:L,T=B.pageSize,y=T===void 0?10:T,ae=t.slice((f-1)*y,f*y);return ae},[t,B,S]),le=m("pro-list",s),ce=Xt({getRowKey:b,getRecordByKey:Y,prefixCls:le,data:t,pageData:ie,expandType:"row",childrenColumnName:"children",locale:{}},l),Q=be(ce,2),Z=Q[0],F=Q[1],E=x||{},$=E.expandedRowKeys,D=E.defaultExpandedRowKeys,R=E.defaultExpandAllRows,N=R===void 0?!0:R,_=E.onExpand,ee=E.onExpandedRowsChange,O=E.rowExpandable,te=ge.useState(function(){return D||(N!==!1?t.map(b):[])}),de=be(te,2),Re=de[0],Ee=de[1],U=ge.useMemo(function(){return new Set($||Re||[])},[$,Re]),Te=ge.useCallback(function(L){var f=b(L,t.indexOf(L)),T,y=U.has(f);y?(U.delete(f),T=Xe(U)):T=[].concat(Xe(U),[f]),Ee(T),_&&_(!y,L),ee&&ee(T)},[b,U,t,_,ee]),xe=Z([])[0];return o(Le,C(C({},g),{},{className:W(m("pro-list-container",s),q,g.className),dataSource:ie,pagination:S&&B,renderItem:function(f,T){var y,ae,ue,me={className:typeof k=="function"?k(f,T):k};a==null||a.forEach(function(H){var pe=H.listKey,Ce=H.cardActionProps;if(ua.has(pe)){var V=H.dataIndex||pe||H.key,oe=Array.isArray(V)?ca(f,V):f[V];Ce==="actions"&&pe==="actions"&&(me.cardActionProps=Ce);var fe=H.render?H.render(oe,f,T):oe;fe!=="-"&&(me[H.listKey]=fe)}});var ne;xe&&xe.render&&(ne=xe.render(f,f,T)||void 0);var Ae=((y=h.current)===null||y===void 0?void 0:y.isEditable(C(C({},f),{},{index:T})))||{},ve=Ae.isEditable,he=Ae.recordKey,ke=F.has(he||T),Pe=o(Ca,C(C({cardProps:g.grid?C(C(C({},d),g.grid),{},{checked:ke,onChecked:ge.isValidElement(ne)?(ae=ne)===null||ae===void 0||(ue=ae.props)===null||ue===void 0?void 0:ue.onChange:void 0}):void 0},me),{},{recordKey:he,isEditable:ve||!1,expandable:x,expand:U.has(b(f,T)),onExpand:function(){Te(f)},index:T,record:f,item:f,showActions:i,showExtra:c,itemTitleRender:I,itemHeaderRender:p,rowSupportExpand:!O||O&&O(f),selected:F.has(b(f,T)),checkbox:ne,onRow:M,onItem:P}),he);return w?w(f,T,Pe):Pe}}))}var Sa=new Gt("techUiListActive",{"0%":{backgroundColor:"unset"},"30%":{background:"#fefbe6"},"100%":{backgroundColor:"unset"}}),Ia=function(t){var a,r,i,c,s,h;return n({},t.componentCls,(h={backgroundColor:"transparent"},n(h,"".concat(t.proComponentsCls,"-table-alert"),{marginBlockEnd:"16px"}),n(h,"&-row",(s={borderBlockEnd:"1px solid ".concat(t.colorSplit)},n(s,"".concat(t.antCls,"-list-item-meta-title"),{borderBlockEnd:"none",margin:0}),n(s,"&:last-child",n({borderBlockEnd:"none"},"".concat(t.antCls,"-list-item"),{borderBlockEnd:"none"})),n(s,"&:hover",(a={backgroundColor:"rgba(0, 0, 0, 0.02)",transition:"background-color 0.3s"},n(a,"".concat(t.antCls,"-list-item-action"),{display:"block"}),n(a,"".concat(t.antCls,"-list-item-extra"),{display:"flex"}),n(a,"".concat(t.componentCls,"-row-extra"),{display:"block"}),n(a,"".concat(t.componentCls,"-row-subheader-actions"),{display:"block"}),a)),n(s,"&-card",n({marginBlock:8,marginInline:0,paddingBlock:0,paddingInline:8,"&:hover":{backgroundColor:"transparent"}},"".concat(t.antCls,"-list-item-meta-title"),{flexShrink:9,marginBlock:0,marginInline:0,lineHeight:"22px"})),n(s,"&".concat(t.componentCls,"-row-editable"),n({},"".concat(t.componentCls,"-list-item"),{"&-meta":{"&-avatar,&-description,&-title":{paddingBlock:6,paddingInline:0}},"&-action":{display:"block"}})),n(s,"&".concat(t.componentCls,"-row-selected"),{backgroundColor:t.colorPrimaryBgHover,"&:hover":{backgroundColor:t.colorPrimaryBgHover}}),n(s,"&".concat(t.componentCls,"-row-type-new"),{animationName:Sa,animationDuration:"3s"}),n(s,"&".concat(t.componentCls,"-row-type-inline"),n({},"".concat(t.componentCls,"-row-title"),{fontWeight:"normal"})),n(s,"&".concat(t.componentCls,"-row-type-top"),{backgroundImage:"url('https://gw.alipayobjects.com/zos/antfincdn/DehQfMbOJb/icon.svg')",backgroundRepeat:"no-repeat",backgroundPosition:"left top",backgroundSize:"12px 12px"}),n(s,"&-show-action-hover",n({},"".concat(t.antCls,`-list-item-action,
            `).concat(t.proComponentsCls,`-card-extra,
            `).concat(t.proComponentsCls,"-card-actions"),{display:"flex"})),n(s,"&-show-extra-hover",n({},"".concat(t.antCls,"-list-item-extra"),{display:"none"})),n(s,"&-extra",{display:"none"}),n(s,"&-subheader",{display:"flex",alignItems:"center",justifyContent:"space-between",height:"44px",paddingInline:24,paddingBlock:0,color:t.colorTextSecondary,lineHeight:"44px",background:"rgba(0, 0, 0, 0.02)","&-actions":{display:"none"},"&-actions *":{marginInlineEnd:8,"&:last-child":{marginInlineEnd:0}}}),n(s,"&-expand-icon",{marginInlineEnd:8,display:"flex",fontSize:12,cursor:"pointer",height:"24px",marginRight:4,color:t.colorTextSecondary,"> .anticon > svg":{transition:"0.3s"}}),n(s,"&-expanded",{" > .anticon > svg":{transform:"rotate(90deg)"}}),n(s,"&-title",{marginInlineEnd:"16px",wordBreak:"break-all",cursor:"pointer","&:hover":{color:t.colorPrimary}}),n(s,"&-content",{position:"relative",display:"flex",flex:"1",flexDirection:"column",marginBlock:0,marginInline:32}),n(s,"&-subTitle",{color:"rgba(0, 0, 0, 0.45)"}),n(s,"&-description",{marginBlockStart:"4px",wordBreak:"break-all"}),n(s,"&-avatar",{display:"flex"}),n(s,"&-header",{display:"flex",flex:"1",justifyContent:"flex-start",h4:{margin:0,padding:0}}),n(s,"&-header-title",{display:"flex",alignItems:"center",justifyContent:"flex-start"}),n(s,"&-header-option",{display:"flex"}),n(s,"&-checkbox",{width:"16px",marginInlineEnd:"12px"}),n(s,"&-no-split",(r={},n(r,"".concat(t.componentCls,"-row"),{borderBlockEnd:"none"}),n(r,"".concat(t.antCls,"-list ").concat(t.antCls,"-list-item"),{borderBlockEnd:"none"}),r)),n(s,"&-bordered",n({},"".concat(t.componentCls,"-toolbar"),{borderBlockEnd:"1px solid ".concat(t.colorSplit)})),n(s,"".concat(t.antCls,"-list-vertical"),(i={},n(i,"".concat(t.componentCls,"-row"),{borderBlockEnd:"12px 18px 12px 24px"}),n(i,"&-header-title",{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"}),n(i,"&-content",{marginBlock:0,marginInline:0}),n(i,"&-subTitle",{marginBlockStart:8}),n(i,"".concat(t.antCls,"-list-item-extra"),n({display:"flex",alignItems:"center",marginInlineStart:"32px"},"".concat(t.componentCls,"-row-description"),{marginBlockStart:16})),n(i,"".concat(t.antCls,"-list-bordered ").concat(t.antCls,"-list-item"),{paddingInline:0}),n(i,"".concat(t.componentCls,"-row-show-extra-hover"),n({},"".concat(t.antCls,"-list-item-extra "),{display:"none"})),i)),n(s,"".concat(t.antCls,"-list-pagination"),{marginBlockStart:t.margin,marginBlockEnd:t.margin}),n(s,"".concat(t.antCls,"-list-list"),{"&-item":{cursor:"pointer",paddingBlock:12,paddingInline:12}}),n(s,"".concat(t.antCls,"-list-vertical ").concat(t.proComponentsCls,"-list-row"),n({"&-header":{paddingBlock:0,paddingInline:0,borderBlockEnd:"none"}},"".concat(t.antCls,"-list-item"),(c={width:"100%",paddingBlock:12,paddingInlineStart:24,paddingInlineEnd:18},n(c,"".concat(t.antCls,"-list-item-meta-avatar"),{display:"flex",alignItems:"center",marginInlineEnd:8}),n(c,"".concat(t.antCls,"-list-item-action-split"),{display:"none"}),n(c,"".concat(t.antCls,"-list-item-meta-title"),{marginBlock:0,marginInline:0}),c))),s)),h))};function Ra(e){return Ct("ProList",function(t){var a=C(C({},t),{},{componentCls:".".concat(e)});return[Ia(a)]})}var Ea=["metas","split","footer","rowKey","tooltip","className","options","search","expandable","showActions","showExtra","rowSelection","pagination","itemLayout","renderItem","grid","itemCardProps","onRow","onItem","rowClassName","locale","itemHeaderRender","itemTitleRender"];function Ta(e){var t=e.metas,a=e.split,r=e.footer,i=e.rowKey,c=e.tooltip,s=e.className,h=e.options,I=h===void 0?!1:h,w=e.search,d=w===void 0?!1:w,p=e.expandable,x=e.showActions,l=e.showExtra,S=e.rowSelection,M=S===void 0?!1:S,P=e.pagination,k=P===void 0?!1:P,g=e.itemLayout,j=e.renderItem,q=e.grid,G=e.itemCardProps,m=e.onRow,b=e.onItem,J=e.rowClassName,z=e.locale,Y=e.itemHeaderRender,v=e.itemTitleRender,K=He(e,Ea),B=u.useRef();u.useImperativeHandle(K.actionRef,function(){return B.current});var ie=u.useContext(Oe||Fe.ConfigContext),le=ie.getPrefixCls,ce=u.useMemo(function(){var D=[];return Object.keys(t||{}).forEach(function(R){var N=t[R]||{},_=N.valueType;_||(R==="avatar"&&(_="avatar"),R==="actions"&&(_="option"),R==="description"&&(_="textarea")),D.push(C(C({listKey:R,dataIndex:(N==null?void 0:N.dataIndex)||R},N),{},{valueType:_}))}),D},[t]),Q=le("pro-list",e.prefixCls),Z=Ra(Q),F=Z.wrapSSR,E=Z.hashId,$=W(Q,E,n({},"".concat(Q,"-no-split"),!a));return F(o(wt,C(C({tooltip:c},K),{},{actionRef:B,pagination:k,type:"list",rowSelection:M,search:d,options:I,className:W(Q,s,$),columns:ce,rowKey:i,tableViewRender:function(R){var N=R.columns,_=R.size,ee=R.pagination,O=R.rowSelection,te=R.dataSource,de=R.loading;return o(wa,{grid:q,itemCardProps:G,itemTitleRender:v,prefixCls:e.prefixCls,columns:N,renderItem:j,actionRef:B,dataSource:te||[],size:_,footer:r,split:a,rowKey:i,expandable:p,rowSelection:M===!1?void 0:O,showActions:x,showExtra:l,pagination:ee,itemLayout:g,loading:de,itemHeaderRender:Y,onRow:m,onItem:b,rowClassName:J,locale:z})}})))}function Aa(e){return o(bt,{needDeps:!0,children:o(Ta,C({},e))})}const Ke=new Set;let re,et={xs:0,sm:576,md:768,lg:992,xl:1200};function je(){const e=re;if(pt(),e!==re)for(const t of Ke)t()}let Ne=!1;function pt(){const e=window.innerWidth,t={};let a=!1;for(const r of Object.keys(et))t[r]=e>=et[r],t[r]!==re[r]&&(a=!0);a&&(re=t)}function ka(){Je&&!Ne&&(re={},pt(),window.addEventListener("resize",je),Ne=!0);const[e,t]=u.useState(re);return u.useEffect(()=>{if(!Je)return;Ne||window.addEventListener("resize",je);const a=()=>{t(re)};return Ke.add(a),()=>{Ke.delete(a),Ke.size===0&&(window.removeEventListener("resize",je),Ne=!1)}},[]),e}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Qe=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/role/model/index.ts/atomRoleListActions",St(void 0));Qe.debugLabel="atomRoleListActions";const Ue=()=>it(Qe),Pa=()=>It(Qe),Me=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/role/model/index.ts/atomRoleDetails",ra({open:!1}));Me.debugLabel="atomRoleDetails";const Da=()=>sa(Me),Na=()=>{const e=Rt(Me);return t=>{e({open:!0,roleId:t})}},ye=()=>it(Me),ft="sysRole",gt=[ft,"details"],yt=e=>{const{roleId:t}=ye(),a=lt(gt,()=>Et({roleId:t}),{onSuccess:e,enabled:!1});return u.useEffect(()=>{t&&a.refetch()},[t]),a},xt=[ft,"tree"],Ka=e=>{const{roleId:t}=ye(),a=lt(xt,async()=>{const{menus:r,checkedKeys:i}=await Tt({roleId:t});return{treeData:r,selectedMenuIds:i,selectedTreeData:ct(r,i),allMenuIds:dt(r),allExpandedKeys:ut(r)}},{onSuccess:r=>{e(r.selectedTreeData)},enabled:!1});return u.useEffect(()=>{t&&a.refetch()},[t]),a},vt=e=>{const t=At(),{message:a}=_e.useApp();return qe(async r=>{const i=t.getQueryData(gt),c=t.getQueryData(xt);await kt({roleId:i.roleId,roleKey:i.roleKey,roleName:i.roleName,roleSort:i.roleSort,status:i.status,menuIds:c.selectedMenuIds,menuCheckStrictly:"NO",deptCheckStrictly:"NO",...r})},{onSuccess:async()=>{e(),a.success("保存成功")}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const tt=[{required:!0,message:"请输入角色名称"}],[,_a,Ma,Ba]=se({title:"角色名称",dataIndex:"roleName",descriptions:{valueType:"text",formItemProps:{rules:tt}},form:{valueType:"text",formItemProps:{rules:tt}},meta:{valueType:"text"}}),[,ja]=se({title:"角色编号",dataIndex:"roleId",descriptions:{valueType:"text"}}),at="控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasRole('admin')`)",nt=[{required:!0,message:"请输入权限字符"}],[,La,za,$a]=se({title:"权限字符",dataIndex:"roleKey",descriptions:{valueType:"text",tooltip:at,formItemProps:{rules:nt}},form:{valueType:"text",tooltip:at,formItemProps:{rules:nt}},meta:{valueType:"text"}}),Oa="NORMAL",We=()=>{const{valueEnumSysNormalDisable:e}=Pt();return se({title:"状态",dataIndex:"status",valueEnum:e,table:{valueType:"select"},form:{initialValue:Oa,valueType:"radio",colProps:{span:12}},meta:{valueType:"select"}})},ot=[{required:!0,message:"请输入显示排序"}],[,Fa,Ha]=se({title:"显示排序",dataIndex:"roleSort",descriptions:{valueType:"digit",formItemProps:{initialValue:0,rules:ot}},form:{valueType:"digit",formItemProps:{initialValue:0,rules:ot},colProps:{span:12}}}),[,Va,qa]=se({title:"备注",dataIndex:"remark",descriptions:{valueType:"textarea"},form:{valueType:"textarea"}}),[,Qa]=se({title:"创建时间",dataIndex:"createTime",descriptions:{valueType:"dateTime"}}),Ua=()=>{const[,,,e]=We();return{title:Ba,subTitle:e,description:$a}},Wa=()=>{const[,,e]=We();return[Ma,za,e,Ha,qa]},Ya=[ja,Qa],Xa=()=>{const[,e]=We();return[e,Fa,_a,La,Va]};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ga=()=>{const e=u.useRef(),t=Ue(),a=Wa(),{message:r}=_e.useApp();return o(Ie,{accessKey:"system:role:add",children:o(Dt,{title:"新增角色",trigger:o(Nt,{}),formRef:e,onFinish:async c=>{var s;return await Kt({...c,menuIds:[],menuCheckStrictly:"NO",deptCheckStrictly:"NO"}),t==null||t.reload(),(s=e.current)==null||s.resetFields(),r.success("新增成功"),!0},width:500,modalProps:{okText:"提交"},grid:!0,colProps:{span:24},layoutType:"ModalForm",columns:a})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ja=()=>{const e=_t(),{roleId:t,open:a}=ye();return o(Ie,{accessKey:"system:user:edit",children:o(we,{type:"primary",onClick:()=>e(Mt("/system/role-auth/:roleId",{roleId:t.toString()})),icon:o(Jt,{}),disabled:!a,children:"分配用户"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Za=()=>{const e=Ue(),t=Da(),{roleId:a,open:r}=ye(),{message:i,modal:c}=_e.useApp(),{isLoading:s,mutateAsync:h}=qe(jt,{onSuccess:()=>{var w;e==null||e.reload(),(w=e==null?void 0:e.clearSelected)==null||w.call(e),t(),i.success("删除成功")}});return o(Ie,{accessKey:"system:role:remove",children:o(Bt,{type:"primary",size:"middle",disabled:!r,onClick:()=>c.confirm({title:"操作确认",content:`确定删除角色编号为 ${a} 的角色吗？`,onOk:()=>h({roleIds:[a]}),okButtonProps:{loading:s}})})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const en=()=>{const[e,t]=u.useState([]),[a]=Zt.useForm(),r=Xa(),i=Ue(),{data:c,isFetching:s,refetch:h}=yt(()=>{t([]),a.resetFields()}),{mutateAsync:I}=vt(()=>{h(),i==null||i.reload()}),d=Lt()("system:role:edit")?{form:a,editableKeys:e,onChange:(p,x)=>{if(t(p),p.length>0){const l=p[0];a.setFieldsValue({[l]:x[l]})}},onSave:async(p,x)=>{await I({[p]:x[p]})}}:void 0;return A(Ve,{spinning:s,children:[o(Ge,{column:2,columns:Ya,dataSource:c}),o(ea,{}),o(Ge,{column:2,columns:r,dataSource:c,editable:d})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const tn=()=>{const e=Pa(),t=Na(),a=Ua();return o(Aa,{ghost:!0,rowKey:"roleId",actionRef:e,metas:a,tableAlertRender:!1,rowSelection:{type:"radio",onSelect:({roleId:r})=>t(r)},search:{filterType:"light"},pagination:{defaultPageSize:10,defaultCurrent:1,showSizeChanger:!0},request:r=>zt(r)})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const an=()=>{const[e,t]=u.useState([]),[a,r]=u.useState(!1),[i,c]=u.useState([]),[s,h]=u.useState([]),[I,w]=u.useState(!1),[d,p]=u.useState(!0),{message:x}=_e.useApp(),[l,S]=u.useState(),M=u.useRef(),{open:P,roleId:k}=ye(),{valueEnumSysDataScope:g}=$t(),{refetch:j}=yt(({dataScope:v})=>{var K;S(v),(K=M.current)==null||K.setFieldsValue({dataScope:v})}),{loading:q,refresh:G,data:m}=ia(async()=>{const{depts:v,checkedKeys:K}=await Ot(k);return{treeData:v,selectedMenuIds:K,selectedTreeData:ct(v,K),allMenuIds:dt(v),allExpandedKeys:ut(v)}},{ready:P,refreshDeps:[k],onSuccess:v=>{r(!1),h(v.selectedTreeData)}}),{isLoading:b,mutate:J}=qe(async()=>{await Ht({roleId:k,dataScope:l,deptIds:e})},{onSuccess:()=>{G(),j(),x.success("保存成功")}}),z=i.length===(m==null?void 0:m.allExpandedKeys.length),Y=v=>{if(v||d){t((m==null?void 0:m.allMenuIds)??[]);return}t([])};return u.useEffect(()=>{if((m==null?void 0:m.allMenuIds.length)===e.length){w(!0),p(!1);return}if(e.length===0){w(!1),p(!1);return}p(!0)},[m==null?void 0:m.allMenuIds,e]),A(Se,{children:[A("header",{className:"flex justify-between items-start flex-wrap",children:[o(Ft,{formRef:M,submitter:!1,layout:"horizontal",children:o(la,{name:"dataScope",label:"数据权限范围",valueEnum:g,fieldProps:{onChange:v=>{S(v)}},readonly:!a})}),o(Ie,{accessKey:"system:role:edit",children:a?A(ze,{children:[o(we,{loading:b,onClick:()=>{r(!1),h((m==null?void 0:m.selectedTreeData)??[])},children:"取消编辑"}),o(we,{type:"primary",ghost:!0,icon:o(ta,{}),loading:b,onClick:()=>J(),children:"保存"})]}):o(we,{type:"primary",ghost:!0,icon:o(aa,{}),onClick:()=>{r(!0),t((m==null?void 0:m.selectedMenuIds)??[]),h((m==null?void 0:m.treeData)??[])},children:"编辑数据权限"})})]}),l==="CUSTOM"&&A(Se,{children:[A(ze,{wrap:!0,className:"my-2",children:[s.length>0&&o(we,{size:"small",icon:z?o(na,{}):o(oa,{}),onClick:()=>c(z?[]:m.allExpandedKeys),children:z?"全部折叠":"全部展开"}),a&&o(mt,{indeterminate:d,onChange:v=>Y(v.target.checked),checked:I,children:"全选/全不选"})]}),o(Ve,{spinning:q,children:s.length>0?o(ht,{blockNode:!0,showLine:{showLeafIcon:!1},checkable:a,checkStrictly:!0,fieldNames:{title:"label",key:"id"},checkedKeys:e,treeData:s,expandedKeys:i,onExpand:v=>c(v),onCheck:v=>{t(v.checked)}}):o($e,{description:"暂未分配数据权限"})})]})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const nn=()=>{const[e,t]=u.useState([]),[a,r]=u.useState(!1),[i,c]=u.useState([]),[s,h]=u.useState([]),[I,w]=u.useState(!1),[d,p]=u.useState(!0),{isFetching:x,data:l,refetch:S}=Ka(g=>{r(!1),h(g)}),{isLoading:M,mutate:P}=vt(()=>{S()}),k=g=>{if(g||d){t((l==null?void 0:l.allMenuIds)??[]);return}t([])};return u.useEffect(()=>{if((l==null?void 0:l.allMenuIds.length)===e.length){w(!0),p(!1);return}if(e.length===0){w(!1),p(!1);return}p(!0)},[l==null?void 0:l.allMenuIds,e]),A(Se,{children:[A("header",{className:"flex justify-between items-end mb-2",children:[o(Vt,{expanded:i.length===(l==null?void 0:l.allExpandedKeys.length),onChange:g=>{c(g?(l==null?void 0:l.allExpandedKeys)??[]:[])}}),o(Ie,{accessKey:"system:role:edit",children:o(qt,{editable:a,loading:M,onCancel:()=>{r(!1),h((l==null?void 0:l.selectedTreeData)??[])},onSave:()=>P({menuIds:e}),onStartEdit:()=>{r(!0),t((l==null?void 0:l.selectedMenuIds)??[]),h((l==null?void 0:l.treeData)??[])}})})]}),A(Ve,{spinning:x,children:[o("div",{className:"pl-1 mb-1",children:a&&o(mt,{indeterminate:d,onChange:g=>k(g.target.checked),checked:I,children:"全选/全不选"})}),s.length>0?o(ht,{blockNode:!0,showLine:{showLeafIcon:!1},checkable:a,checkStrictly:!0,fieldNames:{title:"label",key:"id"},checkedKeys:e,treeData:s,expandedKeys:i,onExpand:g=>c(g),onCheck:g=>{t(g.checked)},height:500}):o($e,{description:"暂未分配菜单权限"})]})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const rt={list:{xxl:7,xl:10,lg:13,md:24,sm:24,xs:24},details:{xxl:17,xl:14,lg:11,md:24,sm:24,xs:24}},pn=()=>{const{xl:e}=ka(),{open:t}=ye();return o(Qt,{children:A(X,{ghost:!0,gutter:[16,16],wrap:!0,children:[o(X,{title:"角色列表",colSpan:rt.list,extra:o(Ga,{}),children:o(tn,{})}),o(X,{split:"horizontal",title:"角色详情",colSpan:rt.details,extra:A(ze,{children:[o(Za,{}),o(Ja,{})]}),className:"h-full",children:t?A(Se,{children:[o(X,{children:o(en,{})}),A(X,{split:e?"vertical":"horizontal",children:[o(X,{children:o(nn,{})}),o(X,{children:o(an,{})})]})]}):o($e,{description:"点击选择左侧角色查看详情"})})]})})};export{pn as default};
