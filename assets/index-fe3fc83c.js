import{a5 as b,j as a,A as n,a as y,ad as k,ae as E,af as M,Z as j,T as w,w as P,ag as v,x as I,i as R,ah as S,ai as D,aj as F,y as N,o as O,z as K,ak as V,F as q,B as L}from"./index-b5eebe28.js";import{u as x,a as Q,b as $,D as p,d as H,c as z,e as G,f as W}from"./index-f26b40b8.js";import{r as l,bg as u,B as Z,b7 as _}from"./antd-f7a9cbdb.js";import{P as J}from"./index-80c0c3aa.js";import{P as f}from"./index-843b2515.js";import{P as U}from"./index-b2d143af.js";import{u as g}from"./useMutation-cb32f323.js";import"./@icon-park/react-8ab893b5.js";import"./@wangeditor/editor-2b25ac2d.js";import"./utils-2835fcdf.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const X=()=>{const e=l.useRef(),{message:t}=u.useApp(),s=x(),{open:o,actionType:i,record:c}=Q(),d=$(),m=()=>{var r;i===p.Edit&&((r=e.current)==null||r.resetFields()),d()},T=async r=>{var A;i===p.Add?(await E(r),t.success("新增成功")):(await M({...r,dictId:c.dictId}),t.success("编辑成功")),s==null||s.reload(),d(),(A=e.current)==null||A.resetFields()},{defaultValueSysNormalDisable:h,valueEnumSysNormalDisable:B}=b();return l.useEffect(()=>{o&&i===p.Edit&&l.startTransition(()=>{var r;(r=e.current)==null||r.setFieldsValue(c)})},[o]),a(n,{accessKey:["system:dict:add","system:dict:edit"],children:y(k,{formRef:e,width:500,title:`${H[i]}字典类型`,open:o,modalProps:{onCancel:m,okText:"提交"},onFinish:T,children:[a(f,{name:"dictName",label:"字典名称",rules:[{required:!0}]}),a(f,{name:"dictType",label:"字典类型",rules:[{required:!0}]}),a(U.Group,{name:"status",label:"状态",valueEnum:B,initialValue:h}),a(J,{name:"remark",label:"备注"})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Y=()=>{const e=z();return a(n,{accessKey:"system:dict:add",children:a(j,{onClick:e})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ee=({record:e})=>{const t=G();return a(n,{accessKey:"system:dict:edit",children:a(w,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const te=async e=>{const{data:t}=await v(e,{format:"blob"});await I(t,`user_${new Date().getTime()}.xlsx`)},ae=({searchParams:e})=>{const{message:t}=u.useApp(),{isLoading:s,mutate:o}=g(te,{onSuccess:()=>{t.success("导出成功")}});return a(n,{accessKey:"system:dict:export",children:a(P,{loading:s,onClick:()=>o(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const se=({dictType:e})=>{const t=R();return a(n,{accessKey:"system:dict:query",children:a(S,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ce=()=>{const{message:e,modal:t}=u.useApp(),{mutateAsync:s,isLoading:o}=g(D,{onSuccess:()=>e.success("刷新成功")});return a(Z,{danger:!0,icon:a(_,{}),onClick:()=>{t.confirm({title:"操作确认",content:"刷新缓存后，所有字典数据将重新加载",onOk:()=>s({}),okButtonProps:{loading:o}})},children:"刷新缓存"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const C=({dictId:e,disabled:t,batch:s})=>{const{message:o,modal:i}=u.useApp(),c=x(),{mutateAsync:d,isLoading:m}=g(F,{onSuccess:()=>{var h;c==null||c.reload(),(h=c==null?void 0:c.clearSelected)==null||h.call(c),o.success("删除成功")}});return a(n,{accessKey:"system:dict:remove",children:a(N,{batch:s,disabled:t,onClick:()=>{i.confirm({title:"操作确认",content:`确定删除字典编号为 ${e} 的字典吗？`,onOk:()=>d({dictIds:e}),okButtonProps:{loading:m}})}})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const oe=()=>{const{valueEnumSysNormalDisable:e}=b();return[{title:"字典编号",dataIndex:"dictId",key:"dictId",valueType:"text",hideInSearch:!0},{title:"字典名称",dataIndex:"dictName",key:"dictName",valueType:"text"},{title:"字典类型",dataIndex:"dictType",key:"dictType",valueType:"text"},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:e},{title:"备注",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"创建时间",dataIndex:"createTimeRange",key:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",valueType:"option",render:(t,s)=>y(q,{children:[a(se,{dictType:s.dictType}),a(ee,{record:s}),a(C,{dictId:[s.dictId]})]})}]},ie=({selectedRowKeys:e})=>a(C,{disabled:e.length===0,batch:!0,dictId:e}),re=()=>{const e=W(),t=oe(),[s,o]=l.useState({});return a(O,{rowKey:"dictId",actionRef:e,columns:t,tableAlertOptionRender:ie,request:async(...i)=>{const c=K(...i);return o(c),await V(c)},toolbar:{actions:[a(ce,{},"ButtonRefresh"),a(ae,{searchParams:s},"ButtonExport"),a(Y,{},"ButtonAdd")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ae=()=>y(L,{children:[a(re,{}),a(X,{})]});export{Ae as default};
