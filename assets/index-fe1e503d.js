import{aT as b,Y as i,ai as p,at as h,aw as M,p as R,d as x,q as f,j as L,aA as T,bo as A,av as y,bp as S,bq as j,br as C}from"./index-cde0b745.js";import{u as O}from"./useMutation-c6d67192.js";import{a as l,u as m}from"./utils-c4afd625.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const g="systemMenu",r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",l({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));r.debugLabel="atomSelectedMenuData";const Y=()=>m(r),v=()=>b(r),F=()=>i(r),c=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomModalAdd",l(!1));c.debugLabel="atomModalAdd";const V=()=>m(c),N=()=>{const e=p(c);return()=>e(!0)},B=()=>i(c),d=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomDrawerSelectIcon",l({open:!1,onSelected:void 0}));d.debugLabel="atomDrawerSelectIcon";const H=()=>m(d),K=()=>{const e=p(d);return t=>e({open:!0,onSelected:t})},W=()=>i(d),I=[g,"list"],z=(e={},t)=>h(I,async()=>{const s=await A(e),a=y(s,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:S(a),map:s.reduce((n,o)=>n.set(o.menuId,o),new Map),parentIds:Array.from(s.reduce((n,o)=>n.add(o.parentId),new Set))}},{onSuccess:s=>{t(s.parentIds)}}),q=()=>{const e=M();return()=>e.invalidateQueries(I)},w=[g,"options"],E=()=>h(w,async()=>{const e=await A({}),t=y(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:j(S(t)),map:e.reduce((s,a)=>s.set(a.menuId,a),new Map)}}),P=()=>{const e=M();return()=>e.invalidateQueries(w)},G=()=>{const e=q(),t=P(),s=Y(),{message:a,modal:n}=R.useApp(),{mutateAsync:o,isLoading:D}=O(async u=>{await C({menuId:u})},{onSuccess:async()=>{s(),await Promise.all([e(),t()]),a.success("删除成功")}});return u=>{n.confirm({title:"操作确认",content:x(f,{children:["确定删除菜单",L(T.Text,{code:!0,children:u.menuName}),"吗？"]}),onOk:()=>o(u.menuId),okButtonProps:{loading:D}})}};export{v as useAtomStateSelectedMenuData,W as useAtomValueDrawerSelectIcon,B as useAtomValueModalAdd,F as useAtomValueSelectedMenuData,G as useDeleteMenu,H as useHideDrawerSelectIcon,V as useHideModalAdd,z as useQueryMenuList,E as useQueryMenuOptions,q as useReFetchMenuList,P as useReFetchMenuOptions,Y as useResetSelectedMenuData,K as useShowDrawerSelectIcon,N as useShowModalAdd};
