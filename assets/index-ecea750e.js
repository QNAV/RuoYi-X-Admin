import{j as s,M as C,d as T,n as B,q as E}from"./antdProComponents-4ea99293.js";import{V as j,A as n,a0 as M,a1 as k,L as w,G as v,j as I,a2 as P,k as R,b as S,a3 as D,a4 as F,a5 as N,l as O,d as K,m as V,a6 as q,B as L}from"./index-bb49039a.js";import{u as A,a as $,b as Q,D as y,d as G,c as H,e as _,f as W}from"./index-f70d93ac.js";import{r as l,bd as u,B as z,a$ as J}from"./antd-32711b0a.js";import{u as g}from"./useMutation-2f9169af.js";import"./iconPark-b0719f80.js";import"./wangEditor-e5fa0fef.js";import"./utils-672e9857.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const U=()=>{const e=l.useRef(),{message:t}=u.useApp(),a=A(),{open:o,actionType:i,record:c}=$(),d=Q(),m=()=>{var r;i===y.Edit&&((r=e.current)==null||r.resetFields()),d()},p=async r=>{var x;i===y.Add?(await M(r),t.success("新增成功")):(await k({...r,dictId:c.dictId}),t.success("编辑成功")),a==null||a.reload(),d(),(x=e.current)==null||x.resetFields()},{defaultValueSysNormalDisable:h,valueEnumSysNormalDisable:f}=j();return l.useEffect(()=>{o&&i===y.Edit&&l.startTransition(()=>{var r;(r=e.current)==null||r.setFieldsValue(c)})},[o]),s.jsx(n,{accessKey:["system:dict:add","system:dict:edit"],children:s.jsxs(C,{formRef:e,width:500,title:`${G[i]}字典类型`,open:o,modalProps:{onCancel:m,okText:"提交"},onFinish:p,children:[s.jsx(T,{name:"dictName",label:"字典名称",rules:[{required:!0}]}),s.jsx(T,{name:"dictType",label:"字典类型",rules:[{required:!0}]}),s.jsx(B.Group,{name:"status",label:"状态",valueEnum:f,initialValue:h}),s.jsx(E,{name:"remark",label:"备注"})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const X=()=>{const e=H();return s.jsx(n,{accessKey:"system:dict:add",children:s.jsx(w,{onClick:e})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Y=({record:e})=>{const t=_();return s.jsx(n,{accessKey:"system:dict:edit",children:s.jsx(v,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Z=async e=>{const{data:t}=await P(e,{format:"blob"});await R(t,`user_${new Date().getTime()}.xlsx`)},ee=({searchParams:e})=>{const{message:t}=u.useApp(),{isLoading:a,mutate:o}=g(Z,{onSuccess:()=>{t.success("导出成功")}});return s.jsx(n,{accessKey:"system:dict:export",children:s.jsx(I,{loading:a,onClick:()=>o(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const te=({dictType:e})=>{const t=S();return s.jsx(n,{accessKey:"system:dict:query",children:s.jsx(D,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const se=()=>{const{message:e,modal:t}=u.useApp(),{mutateAsync:a,isLoading:o}=g(F,{onSuccess:()=>e.success("刷新成功")}),i=()=>{t.confirm({title:"操作确认",content:"刷新缓存后，所有字典数据将重新加载",onOk:()=>a({}),okButtonProps:{loading:o}})};return s.jsx(z,{danger:!0,icon:s.jsx(J,{}),onClick:i,children:"刷新缓存"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const b=({dictId:e,disabled:t,batch:a})=>{const{message:o,modal:i}=u.useApp(),c=A(),{mutateAsync:d,isLoading:m}=g(N,{onSuccess:()=>{var h;c==null||c.reload(),(h=c==null?void 0:c.clearSelected)==null||h.call(c),o.success("删除成功")}}),p=()=>{i.confirm({title:"操作确认",content:`确定删除字典编号为 ${e} 的字典吗？`,onOk:()=>d({dictIds:e}),okButtonProps:{loading:m}})};return s.jsx(n,{accessKey:"system:dict:remove",children:s.jsx(O,{batch:a,disabled:t,onClick:p})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ae=()=>{const{valueEnumSysNormalDisable:e}=j();return[{title:"字典编号",dataIndex:"dictId",key:"dictId",valueType:"text",hideInSearch:!0},{title:"字典名称",dataIndex:"dictName",key:"dictName",valueType:"text"},{title:"字典类型",dataIndex:"dictType",key:"dictType",valueType:"text"},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:e},{title:"备注",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"创建时间",dataIndex:"createTimeRange",key:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",valueType:"option",render:(t,a)=>s.jsxs(s.Fragment,{children:[s.jsx(te,{dictType:a.dictType}),s.jsx(Y,{record:a}),s.jsx(b,{dictId:[a.dictId]})]})}]},ce=({selectedRowKeys:e})=>s.jsx(b,{disabled:e.length===0,batch:!0,dictId:e}),oe=()=>{const e=W(),t=ae(),[a,o]=l.useState({});return s.jsx(K,{rowKey:"dictId",actionRef:e,columns:t,tableAlertOptionRender:ce,request:async(...i)=>{const c=V(...i);return o(c),await q(c)},toolbar:{actions:[s.jsx(se,{},"ButtonRefresh"),s.jsx(ee,{searchParams:a},"ButtonExport"),s.jsx(X,{},"ButtonAdd")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const pe=()=>s.jsxs(L,{children:[s.jsx(oe,{}),s.jsx(U,{})]});export{pe as default};
