import{cx as I,aW as c,ai as S,ak as d,c7 as i,cT as m,c9 as l,cU as p,aY as D,j as w,k as R,d as f,cb as C,cK as T,aF as b,cV as x}from"./index-3af5a8dd.js";import{a as M,u as h}from"./utils-667a4caf.js";import{u as L}from"./useMutation.esm-483465d4.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const y="systemMenu",O=e=>{const s=a=>a.filter(n=>n.menuType!==T.F).map(({menuId:n,menuName:o,children:t})=>({menuId:n,menuName:o,children:t?s(t):[]}));return[{menuId:0,menuName:"根目录",children:e?s(e):[]}]},u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",M({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));u.debugLabel="atomSelectedMenuData";const j=()=>h(u),q=()=>I(u),N=()=>c(u),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomAddModal",M(!1));r.debugLabel="atomAddModal";const V=()=>h(r),X=()=>{const e=S(r);return()=>e(!0)},v=()=>c(r),A=[y,"list"],F=()=>{const e=d();return()=>e.invalidateQueries(A)},K=(e={},s)=>i(A,async()=>{const a=await m(e),n=l(a,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:p(n),map:a.reduce((o,t)=>o.set(t.menuId,t),new Map),parentIds:Array.from(a.reduce((o,t)=>o.add(t.parentId),new Set))}},{onSuccess:a=>{s(a.parentIds)}}),g=[y,"options"],k=()=>{const e=d();return()=>e.invalidateQueries(g)},B=()=>i(g,async()=>{const e=await m({}),s=l(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:O(p(s)),map:e.reduce((a,n)=>a.set(n.menuId,n),new Map)}}),W=()=>{const e=F(),s=k(),a=j(),{mutateAsync:n,isLoading:o}=L(async t=>{await x({menuId:t})},{onSuccess:async()=>{a(),await Promise.all([e(),s()]),b.success("删除成功")}});return t=>{D.confirm({title:"删除菜单",content:w(R,{children:["确定删除菜单",f(C.Text,{code:!0,children:t.menuName}),"吗？"]}),onOk:()=>n(t.menuId),okButtonProps:{loading:o}})}};export{q as useAtomStateSelectedMenuData,v as useAtomValueCreateModal,N as useAtomValueSelectedMenuData,W as useDeleteMenu,V as useHideCreateModal,K as useQueryMenuList,B as useQueryMenuOptions,F as useReFetchMenuList,k as useReFetchMenuOptions,j as useResetSelectedMenuData,X as useShowCreateModal};
