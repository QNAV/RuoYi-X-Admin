import{aU as S,l as c,n as I,q as i,ai as D,g as F,F as f,j as C,aH as w,aG as d,b4 as m,Y as R,aY as b}from"./index.ca0a842c.js";import{c as l,d as T}from"./SysMenuService.ecab32e7.js";import{a as p,u as M}from"./utils.a39c6320.js";import{u as h}from"./useQuery.esm.a73cc2ec.js";import{u as x}from"./useMutation.esm.9f92fcef.js";import"./utils.esm.b01b006b.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const y="systemMenu",L=e=>{const s=a=>a.filter(n=>n.menuType!==b.F).map(({menuId:n,menuName:u,children:t})=>({menuId:n,menuName:u,children:t?s(t):[]}));return[{menuId:0,menuName:"\u6839\u76EE\u5F55",children:e?s(e):[]}]},o=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",p({hasSelected:!1,selectedMenuId:0,selectedMenuName:"\u6839\u76EE\u5F55"}));o.debugLabel="atomSelectedMenuData";const O=()=>M(o),X=()=>S(o),v=()=>c(o),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomAddModal",p(!1));r.debugLabel="atomAddModal";const B=()=>M(r),V=()=>{const e=I(r);return()=>e(!0)},H=()=>c(r),A=[y,"list"],j=()=>{const e=i();return()=>e.invalidateQueries(A)},K=(e={},s)=>h(A,async()=>{const a=await l(e),n=d(a,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:m(n),map:a.reduce((u,t)=>u.set(t.menuId,t),new Map),parentIds:Array.from(a.reduce((u,t)=>u.add(t.parentId),new Set))}},{onSuccess:a=>{s(a.parentIds)}}),g=[y,"options"],P=()=>{const e=i();return()=>e.invalidateQueries(g)},G=()=>h(g,async()=>{const e=await l({}),s=d(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:L(m(s)),map:e.reduce((a,n)=>a.set(n.menuId,n),new Map)}}),U=()=>{const e=j(),s=P(),a=O(),{mutateAsync:n,isLoading:u}=x(async t=>{await T({menuId:t})},{onSuccess:async()=>{a(),await Promise.all([e(),s()]),R.success("\u5220\u9664\u6210\u529F")}});return t=>{D.confirm({title:"\u5220\u9664\u83DC\u5355",content:F(f,{children:["\u786E\u5B9A\u5220\u9664\u83DC\u5355",C(w.Text,{code:!0,children:t.menuName}),"\u5417\uFF1F"]}),onOk:()=>n(t.menuId),okButtonProps:{loading:u}})}};export{X as useAtomStateSelectedMenuData,H as useAtomValueCreateModal,v as useAtomValueSelectedMenuData,U as useDeleteMenu,B as useHideCreateModal,K as useQueryMenuList,G as useQueryMenuOptions,j as useReFetchMenuList,P as useReFetchMenuOptions,O as useResetSelectedMenuData,V as useShowCreateModal};
