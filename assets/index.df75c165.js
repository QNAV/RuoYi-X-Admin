import{p as E,s as j,b0 as A,$ as T,j as a,ah as P,ai as g,bG as R,ak as w,e as B,F,am as S,r as I,aI as q,bH as M,an as f,aA as x,ao as k,K as U}from"./index.420d2bc2.js";import{e as V,j as C}from"./index.d0bd967d.js";import{b as K}from"./index.f32b5ff9.js";import{g as L,h as _,i as O,j as X,k as Y}from"./SysRoleService.fea3e865.js";import{u as D}from"./useMutation.esm.c2afcb52.js";import{u as G}from"./index.f4d81f98.js";import"./useQuery.esm.86c767cc.js";import"./utils.esm.283448c2.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const y=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/roleAuth/model/index.ts/atomMainTable",E(void 0));y.debugLabel="atomMainTable";const v=()=>j(y),H=()=>K(y);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const N=({userId:e,userName:t,isBatch:n,disabled:u})=>{const o=n?"\u6279\u91CF\u53D6\u6D88\u6388\u6743":"\u53D6\u6D88\u6388\u6743",c=A(),i=Number(c.roleId),{canEditSysRole:h}=V(),r=v(),{mutateAsync:m,isLoading:l}=D(async()=>{Array.isArray(e)?await L({roleId:i,userIds:e}):await _({roleId:i,userId:e})},{onSuccess:()=>{var s;r==null||r.reload(),(s=r==null?void 0:r.clearSelected)==null||s.call(r),T.success("\u53D6\u6D88\u6388\u6743\u6210\u529F")}});return a(P,{accessible:h,children:a(g,{type:"link",danger:!0,disabled:u,icon:a(R,{}),onClick:()=>{w.confirm({title:"\u53D6\u6D88\u6388\u6743",content:B(F,{children:["\u786E\u5B9A\u53D6\u6D88\u6388\u6743\u7528\u6237",a(S.Text,{code:!0,children:t}),"\u5417\uFF1F"]}),onOk:()=>m(),okButtonProps:{loading:l}})},children:o})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Q=()=>{var p;const e=A(),t=Number(e.roleId),[n,{toggle:u}]=G(),o=I.exports.useRef(),[c,i]=I.exports.useState([]),h=v(),{isLoading:r,mutate:m}=D(()=>O({roleId:t,userIds:c}),{onSuccess:()=>{var s,d,b;(s=o.current)==null||s.reload(),(b=(d=o.current)==null?void 0:d.clearSelected)==null||b.call(d),h==null||h.reload(),u(),T.success("\u6388\u6743\u6210\u529F")}}),{data:l}=C("sys_common_status");return B(F,{children:[a(g,{type:"primary",icon:a(q,{}),onClick:()=>{var s;(s=o.current)==null||s.reload(),u()},children:"\u6388\u6743\u7528\u6237"}),a(M,{open:n,title:"\u6388\u6743\u7528\u6237",placement:"left",onClose:u,width:850,footer:a(g,{type:"primary",disabled:c.length===0,loading:r,onClick:()=>m(),children:"\u63D0\u4EA4"}),footerStyle:{textAlign:"right"},children:a(f,{ghost:!0,rowKey:"userId",actionRef:o,columns:[{dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"\u90AE\u7BB1",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},{pattern:x,message:"\u90AE\u7BB1\u683C\u5F0F\u9519\u8BEF"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text",copyable:!0},{title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(p=l==null?void 0:l.mapData)!=null?p:{},formItemProps:{initialValue:l==null?void 0:l.defaultValue,required:!0,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001"}]}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0}],tableAlertRender:!1,rowSelection:{onChange:s=>{i(s)}},request:(...s)=>X(k(...s))})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const $=({selectedRows:e})=>a(N,{userId:e.map(t=>t.userId),userName:e.map(t=>t.userName).join(","),isBatch:!0,disabled:e.length===0}),z=()=>{var o;const e=A(),t=Number(e.roleId),n=H(),{data:u}=C("sys_common_status");return a(f,{rowKey:"userId",actionRef:n,params:{roleId:t},columns:[{dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"\u90AE\u7BB1",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},{pattern:x,message:"\u90AE\u7BB1\u683C\u5F0F\u9519\u8BEF"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text",copyable:!0},{title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(o=u==null?void 0:u.mapData)!=null?o:{},formItemProps:{initialValue:u==null?void 0:u.defaultValue,required:!0,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001"}]}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:(c,i)=>a(N,{userId:i.userId,userName:i.userName})}],request:(...c)=>Y(k(...c)),tableAlertRender:$,toolbar:{actions:[a(Q,{},"DrawerTableAuth")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const re=()=>a(U,{children:a(z,{})});export{re as default};
