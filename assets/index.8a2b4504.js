import{h as v,l as j,n as B,o as A,r as M,j as a,af as T,g as l,ay as k,Y as y,$ as w,aS as O,az as R,b9 as S,ba as D,ag as C,aC as V,aD as _,ah as q,ai as W,ak as Y,al as L,F as X,aV as N,I as $}from"./index.55c98aee.js";import{c as p,a as b}from"./index.a5de79f1.js";import{a as z}from"./index.c47676f8.js";import{a as G,u as H}from"./utils.ddd569b9.js";import{u as K}from"./useMutation.esm.d3760a47.js";import"./useQuery.esm.c15be1e4.js";import"./utils.esm.b2247ccb.js";import"./SysLoginService.a719c65b.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const F=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/notice/model/index.ts/atomMainTableActions",v(void 0));F.debugLabel="atomMainTableActions";const P=()=>j(F),Q=()=>z(F),h=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/notice/model/index.ts/atomAddOrEditModal",G({open:!1,actionType:"add"}));h.debugLabel="atomAddOrEditModal";const J=()=>j(h),U=()=>{const e=B(h);return()=>{e({open:!0,actionType:"add"})}},Z=()=>{const e=B(h);return t=>{e({open:!0,actionType:"edit",record:t})}},ee=()=>H(h);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function te(e,t){return A("/system/notice/add",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function ae(e,t){return A("/system/notice/edit",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function oe(e,t){return A("/system/notice/list",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function se(e,t){return A("/system/notice/remove",{method:"POST",params:{...e},...t||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ce=()=>{var f,E;const e=M.exports.useRef(),{data:t}=p("sys_notice_type"),{data:s}=p("sys_notice_status"),{canAddSysNotice:i,canEditSysNotice:m}=b(),o=P(),{open:r,actionType:n,record:g}=J(),c=ee(),x=()=>{var u;n==="edit"&&((u=e.current)==null||u.resetFields()),c()};return M.exports.useEffect(()=>{if(r&&n==="edit"){const u=setTimeout(()=>{var d;(d=e.current)==null||d.setFieldsValue(g),clearTimeout(u)},0)}},[r]),a(T,{accessible:i||m,children:l(k,{formRef:e,width:800,title:n==="add"?"\u65B0\u589E\u516C\u544A":"\u7F16\u8F91\u516C\u544A",open:r,modalProps:{onCancel:x,okText:"\u63D0\u4EA4"},grid:!0,onFinish:async u=>{var d;return n==="add"?(await te(u),y.success("\u65B0\u589E\u6210\u529F")):(await ae({...u,noticeId:g.noticeId}),y.success("\u7F16\u8F91\u6210\u529F")),o==null||o.reload(),c(),(d=e.current)==null||d.resetFields(),!0},children:[a(w,{name:"noticeTitle",label:"\u516C\u544A\u6807\u9898",required:!0,rules:[{required:!0}],colProps:{span:12}}),a(O,{name:"noticeType",label:"\u516C\u544A\u7C7B\u578B",required:!0,rules:[{required:!0}],valueEnum:(f=t==null?void 0:t.mapData)!=null?f:{},colProps:{span:12}}),a(R.Group,{name:"status",label:"\u72B6\u6001",valueEnum:(E=s==null?void 0:s.mapData)!=null?E:{},initialValue:s==null?void 0:s.defaultValue}),a(S,{name:"noticeContent",label:"\u5185\u5BB9",children:a(D,{})})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ue=()=>{const{canAddSysNotice:e}=b(),t=U();return a(T,{accessible:e,children:a(C,{icon:a(V,{}),type:"primary",onClick:t,children:"\u65B0\u589E"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ie=({record:e})=>{const t=Z();return a(C,{type:"link",icon:a(_,{}),onClick:()=>t(e),children:"\u7F16\u8F91"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const I=({noticeId:e,disabled:t,isBatch:s})=>{const i=s?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",{canRemoveSysDict:m}=b(),o=P(),{mutateAsync:r,isLoading:n}=K(async c=>{await se({noticeIds:c})},{onSuccess:()=>{var c;o==null||o.reload(),(c=o==null?void 0:o.clearSelected)==null||c.call(o),y.success("\u5220\u9664\u6210\u529F")}});return a(T,{accessible:m,children:a(C,{type:"link",danger:!0,disabled:t,icon:a(q,{}),onClick:()=>{W.confirm({title:"\u5220\u9664\u516C\u544A\u901A\u77E5",content:`\u786E\u5B9A\u5220\u9664\u516C\u544A\u7F16\u53F7\u4E3A ${e} \u7684\u516C\u544A\u901A\u77E5\u5417\uFF1F`,onOk:async()=>r(e),okButtonProps:{loading:n}})},children:i})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ne=()=>{var s,i;const{data:e}=p("sys_notice_type"),{data:t}=p("sys_notice_status");return[{title:"\u516C\u544A\u7F16\u53F7",dataIndex:"noticeId",key:"noticeId",valueType:"text",hideInSearch:!0},{title:"\u516C\u544A\u6807\u9898",dataIndex:"noticeTitle",key:"noticeTitle",valueType:"text"},{title:"\u516C\u544A\u7C7B\u578B",dataIndex:"noticeType",key:"noticeType",valueType:"select",valueEnum:(s=e==null?void 0:e.mapData)!=null?s:{}},{title:"\u521B\u5EFA\u8005",dataIndex:"createBy",key:"createBy",valueType:"text"},{title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(i=t==null?void 0:t.mapData)!=null?i:{}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"\u64CD\u4F5C",valueType:"option",render:(m,o)=>l(X,{children:[a(ie,{record:o}),a(I,{noticeId:o.noticeId})]})}]},re=({selectedRows:e})=>l(N,{children:[l("span",{children:["\u5DF2\u9009\u62E9 ",e.length," \u9879"]}),a(I,{isBatch:!0,disabled:e.length===0,noticeId:e.map(t=>t.noticeId).join(",")})]}),de=()=>{const e=Q(),t=ne();return a(Y,{rowKey:"noticeId",actionRef:e,columns:t,request:(...s)=>oe(L(...s)),tableAlertOptionRender:re,toolbar:{actions:[a(ue,{},"ButtonAdd")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ce=()=>l($,{children:[a(de,{}),a(ce,{})]});export{Ce as default};
