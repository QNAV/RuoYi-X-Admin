import{a as I,F as S,j as D}from"./jsx-runtime-5957e344.js";import{d2 as b,bm as c,aH as w,cD as d,dp as i,cF as m,dq as l,aJ as p,dr as R,bp as f,cI as x,b5 as L,ds as j}from"./index-64501b2e.js";import{a as M,u as h}from"./utils-e8674839.js";import{u as C}from"./useMutation.esm-6ef6e6de.js";import"./mutation.esm-d605227f.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const y="systemMenu",u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",M({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));u.debugLabel="atomSelectedMenuData";const F=()=>h(u),Y=()=>b(u),v=()=>c(u),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomModalAdd",M(!1));r.debugLabel="atomModalAdd";const N=()=>h(r),V=()=>{const e=w(r);return()=>e(!0)},B=()=>c(r),A=[y,"list"],H=(e={},a)=>d(A,async()=>{const t=await i(e),n=m(t,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:l(n),map:t.reduce((o,s)=>o.set(s.menuId,s),new Map),parentIds:Array.from(t.reduce((o,s)=>o.add(s.parentId),new Set))}},{onSuccess:t=>{a(t.parentIds)}}),O=()=>{const e=p();return()=>e.invalidateQueries(A)},g=[y,"options"],K=()=>d(g,async()=>{const e=await i({}),a=m(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:R(l(a)),map:e.reduce((t,n)=>t.set(n.menuId,n),new Map)}}),T=()=>{const e=p();return()=>e.invalidateQueries(g)},J=()=>{const e=O(),a=T(),t=F(),{mutateAsync:n,isLoading:o}=C(async s=>{await j({menuId:s})},{onSuccess:async()=>{t(),await Promise.all([e(),a()]),L.success("删除成功")}});return s=>{f.confirm({title:"操作确认",content:I(S,{children:["确定删除菜单",D(x.Text,{code:!0,children:s.menuName}),"吗？"]}),onOk:()=>n(s.menuId),okButtonProps:{loading:o}})}};export{Y as useAtomStateSelectedMenuData,B as useAtomValueModalAdd,v as useAtomValueSelectedMenuData,J as useDeleteMenu,N as useHideModalAdd,H as useQueryMenuList,K as useQueryMenuOptions,O as useReFetchMenuList,T as useReFetchMenuOptions,F as useResetSelectedMenuData,V as useShowModalAdd};
