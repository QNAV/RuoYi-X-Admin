import{j as a,M as q,d as x,n as w,m as G,p as k,q as X,o as K}from"./antdProComponents-4ea99293.js";import{e as P,h as f,f as W,a7 as $,F as I,I as B,V as N,a8 as H,a9 as Q,aa as U,A as C,L as _,G as z,j as J,ab as Z,k as ee,ac as te,l as ae,ad as se,ae as oe,af as ce,d as ie,m as v,ag as re,B as ne}from"./index-bb49039a.js";import{a as le,u as de}from"./utils-672e9857.js";import{r as g,bd as E,B as ue}from"./antd-32711b0a.js";import{u as F}from"./useMutation-2f9169af.js";import{u as he}from"./useRequest-bf72057a.js";import"./iconPark-b0719f80.js";import"./wangEditor-e5fa0fef.js";import"./tslib.es6-3c43c0a4.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};var V=(e=>(e.NONE="none",e.DEFAULT="default",e.ERROR="error",e.SUCCESS="success",e.PROCESSING="processing",e.WARNING="warning",e))(V||{});const O=new Map([["none",{text:"无"}],["default",{text:"默认",status:"Default"}],["processing",{text:"进行中",status:"Processing"}],["warning",{text:"警告",status:"Warning"}],["error",{text:"错误",status:"Error"}],["success",{text:"成功",status:"Success"}]]);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const S=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/dictDetails/model/index.ts/atomMainTableActions",P(void 0));S.debugLabel="atomMainTableActions";const Y=()=>f(S),me=()=>W(S),M=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/dictDetails/model/index.ts/atomCurDictType",P({dictType:"",dictName:""}));M.debugLabel="atomCurDictType";const pe=()=>f(M),ye=()=>$(M);var b=(e=>(e[e.Add=0]="Add",e[e.Edit=1]="Edit",e))(b||{});const ge={[0]:"新增",[1]:"编辑"},A=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/dictDetails/model/index.ts/atomAddOrEditModal",le({actionType:0,open:!1}));A.debugLabel="atomAddOrEditModal";const Te=()=>f(A),xe=()=>de(A),Ae=()=>{const e=I(A);return()=>{e({actionType:0,open:!0})}},je=()=>{const e=I(A);return t=>{e({actionType:1,open:!0,record:t})}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const be=()=>{const e=g.useRef(),{message:t}=E.useApp(),l=Y(),{open:r,actionType:s,record:i}=Te(),m=xe(),T=()=>{var c;s===b.Edit&&((c=e.current)==null||c.resetFields()),m()},p=ge[s],{dictType:y,dictName:j}=pe(),{valueEnumSysYesNo:d}=B(),{defaultValueSysNormalDisable:o,valueEnumSysNormalDisable:u}=N(),n=async c=>{var h;s===b.Add?await Q(c):await U({...c,dictCode:i.dictCode}),m(),(h=e.current)==null||h.resetFields(),t.success(`${p}成功`),l==null||l.reload()};return g.useEffect(()=>{r&&g.startTransition(()=>{var c,h;s===b.Add?(c=e.current)==null||c.setFieldsValue({dictType:y,dictName:j}):(h=e.current)==null||h.setFieldsValue({...i,dictName:j})})},[r]),a.jsx(H,{accessible:!0,fallback:a.jsx(ue,{children:"111"}),children:a.jsxs(q,{formRef:e,width:500,title:`${p}字典数据`,open:r,modalProps:{onCancel:T,okText:"提交"},onFinish:n,children:[a.jsx(x,{name:"dictName",label:"字典名称",readonly:!0}),a.jsx(x,{name:"dictType",label:"字典类型",hidden:!0}),a.jsx(x,{name:"dictLabel",label:"数据标签",rules:[{required:!0}]}),a.jsx(x,{name:"dictValue",label:"数据键值",rules:[{required:!0}]}),a.jsx(w.Group,{name:"isDefault",label:"是否默认值",valueEnum:d}),a.jsx(x,{name:"cssClass",label:"样式属性"}),a.jsx(G,{name:"dictSort",label:"显示排序",initialValue:0}),a.jsx(k,{name:"listClass",label:"回显样式",valueEnum:O,initialValue:V.NONE}),a.jsx(w.Group,{name:"status",label:"状态",valueEnum:u,initialValue:o}),a.jsx(X,{name:"remark",label:"备注"})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ce=()=>{const e=Ae();return a.jsx(C,{accessKey:"system:dict:edit",children:a.jsx(_,{onClick:e})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const fe=({record:e})=>{const t=je();return a.jsx(C,{accessKey:"system:dict:edit",children:a.jsx(z,{onClick:()=>t(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ee=async e=>{const{data:t}=await Z(e,{format:"blob"});await ee(t,`dict_${new Date().getTime()}.xlsx`)},Se=({searchParams:e})=>{const{message:t}=E.useApp(),{isLoading:l,mutate:r}=F(Ee,{onSuccess:()=>{t.success("导出成功")}});return a.jsx(C,{accessKey:"system:dict:export",children:a.jsx(J,{loading:l,onClick:()=>r(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const L=({dictCode:e,disabled:t,batch:l})=>{const{message:r,modal:s}=E.useApp(),i=Y(),{mutateAsync:m,isLoading:T}=F(te,{onSuccess:()=>{var y;i==null||i.reload(),(y=i==null?void 0:i.clearSelected)==null||y.call(i),r.success("删除成功")}}),p=()=>{s.confirm({title:"操作确认",content:`确定删除字典编码为 ${e} 的字典数据吗？`,onOk:()=>m({dictCodes:e}),okButtonProps:{loading:T}})};return a.jsx(C,{accessKey:"system:dict:edit",children:a.jsx(ae,{batch:l,disabled:t,onClick:p})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Me=()=>{const{valueEnumSysNormalDisable:e}=N(),{valueEnumSysYesNo:t}=B();return[{title:"字典编码",dataIndex:"dictCode",key:"dictCode",valueType:"text",hideInSearch:!0},{title:"字典标签",dataIndex:"dictLabel",key:"dictLabel",valueType:"text"},{title:"字典键值",dataIndex:"dictValue",key:"dictValue",valueType:"text",hideInSearch:!0},{title:"是否默认值",dataIndex:"isDefault",key:"isDefault",valueType:"radio",valueEnum:t,hideInSearch:!0},{title:"字典排序",dataIndex:"dictSort",key:"dictSort",valueType:"text",hideInSearch:!0},{title:"回显样式",dataIndex:"listClass",key:"listClass",valueType:"select",valueEnum:O},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:e},{title:"备注",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",hideInSearch:!0,sorter:!0},{title:"创建时间",dataIndex:"createTimeRange",key:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",valueType:"option",render:(l,r)=>a.jsxs(a.Fragment,{children:[a.jsx(fe,{record:r}),a.jsx(L,{dictCode:[r.dictCode]})]})}]},De=({selectedRowKeys:e})=>a.jsx(L,{disabled:e.length===0,batch:!0,dictCode:e});let R;const we="/system/dict/:dictType",ve=()=>{const e=se(),[t,l]=g.useState({}),r=oe(we),s=me(),i=Me(),m=g.useRef(),[T,p]=ye(),{data:y,run:j}=he(async()=>(await ce()).reduce((o,u)=>(o[u.dictType]=u.dictName,o),{}),{ready:!!e.dictType,onSuccess:d=>{const o=e.dictType;p({dictType:o,dictName:d[o]}),g.startTransition(()=>{var u,n,c,h,D;(u=m.current)==null||u.setFieldsValue({dictType:o}),(c=(n=s==null?void 0:s.current)==null?void 0:n.clearSelected)==null||c.call(n),(D=(h=s.current)==null?void 0:h.reloadAndRest)==null||D.call(h)})}});return g.useEffect(()=>{e.dictType===void 0||e.dictType===R||(R=e.dictType,j())},[r]),a.jsx(ie,{rowKey:"dictCode",actionRef:s,columns:i,params:T,request:async(...d)=>{const o=v(...d);return l(o),await re(v(...d))},tableAlertOptionRender:De,manualRequest:!0,toolbar:{actions:[a.jsx(Se,{searchParams:t},"ButtonExport"),a.jsx(Ce,{},"ButtonAdd")]},headerTitle:a.jsx(K,{formRef:m,children:a.jsx(k,{name:"dictType",valueEnum:y??{},allowClear:!1,showSearch:!0,fieldProps:{onChange:d=>{var o,u,n,c;(u=(o=s==null?void 0:s.current)==null?void 0:o.clearSelected)==null||u.call(o),(c=(n=s.current)==null?void 0:n.reset)==null||c.call(n),p({dictType:d,dictName:y[d]})}}})})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ye=()=>a.jsxs(ne,{children:[a.jsx(ve,{}),a.jsx(be,{})]});export{Ye as default};
