import{u}from"./index-79096473.js";import{a as p,l as s,b as g,g as d,d as f,e as y,f as A}from"./index-1465a0a3.js";import{r as n}from"./jsx-runtime-0e3d513e.js";import{u as b}from"./index-7a6a4985.js";import{s as T,t as i,v as C}from"./index-4f978b96.js";import{u as j}from"./utils.esm-4224fae3.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const K=()=>{const{data:e}=u();return n.useCallback((t,a)=>{var o;const c=new Set(((o=e==null?void 0:e.userInfo)==null?void 0:o.permissions)??[]);return typeof t=="function"?t(c):p(t,c,a)},[e])};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const x=e=>{const t=n.useRef(),a=b(e);return n.useEffect(()=>{n.startTransition(()=>{a(t.current)})},[]),t};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const v=[{name:"测试菜单",path:"demo",children:[{name:"测试单表",path:"demo",element:s("demo/demo"),access:"demo:demo:list"},{name:"测试树表",path:"tree",element:s("demo/tree"),access:"demo:tree:list"}]}],M=[{name:"首页",path:"/",errorElement:s("error"),element:g(),children:[{name:"首页",index:!0,element:s("home"),closableTab:!1},{name:"系统管理",path:"system",children:[{name:"用户管理",path:"user",element:s("system/user"),access:"system:user:list"},{name:"角色管理",path:"role",element:s("system/role"),access:"system:role:list"},{name:"角色授权",path:"role-auth/:roleId",element:s("system/roleAuth"),access:"system:role:list"},{name:"菜单管理",path:"menu",element:s("system/menu"),access:"system:menu:list"},{name:"部门管理",path:"dept",element:s("system/dept"),access:"system:dept:list"},{name:"岗位管理",path:"post",element:s("system/post"),access:"system:post:list"},{name:"字典管理",path:"dict",element:s("system/dict"),access:"system:dict:list"},{name:"字典管理-详情",path:"dict/:dictType",element:s("system/dictDetails"),access:"system:dict:list",isKeepAlive:!0},{name:"参数管理",path:"config",element:s("system/config"),access:"system:config:list"},{name:"通知公告",path:"notice",element:s("system/notice"),access:"system:notice:list"},{name:"日志管理",path:"log",children:[{name:"操作日志",path:"operlog",element:s("monitor/operlog"),access:"monitor:operlog:list"},{name:"登录日志",path:"logininfor",element:s("monitor/logininfor"),access:"monitor:logininfor:list"}]},{name:"文件管理",path:"oss",element:s("system/oss"),access:"system:oss:list"}]},{name:"系统监控",path:"monitor",children:[{name:"在线用户",path:"online",element:s("monitor/online"),access:"monitor:online:list"},{name:"缓存管理",path:"cache",element:s("monitor/cache"),access:"monitor:cache:list"}]},{name:"系统工具",path:"tool",children:[{name:"表单构建",path:"build",element:s("tool/build"),access:"tool:build:list"},{name:"代码生成",path:"gen",element:s("tool/gen"),access:"tool:gen:list"},{name:"代码生成详情",path:"gen-edit/:tableId",element:s("tool/gen-edit"),access:"tool:gen:list"}]},{name:"个人中心",path:"settings",element:s("settings")},...v]}],l=[...M,{name:"登录",path:"login",element:s("login")}],w=d(l),O=Object.keys(w),r=f(l),h=Object.keys(r).filter(e=>r[e].isKeepAlive),q=new Set(h);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const z=(e,t=!0)=>{const a=n.useRef({}),{pathname:c}=T();return n.useEffect(()=>{const o=h.find(m=>i(m,c));if(a.current.isActivated=!1,!!o){if(a.current.pattern===void 0&&t){a.current.pattern=o;return}if(a.current.pattern===void 0&&!t){a.current.pattern=o,e();return}i(a.current.pattern,c)&&(a.current.isActivated=!0,e())}},[c]),a.current.isActivated};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const R=(e={})=>y({path:"/logout",method:"POST",secure:!0,skipErrorHandler:!1,...e});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Q=()=>{const e=j(),t=C();return async()=>{await R(),A(),e.clear(),t("/login")}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{Q as a,O as b,w as c,x as d,z as e,q as i,l as r,r as s,K as u};
