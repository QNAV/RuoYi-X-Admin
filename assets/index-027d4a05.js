import{j as a,J as R}from"./antdProComponents-d97761a4.js";import{e as w,f as B,h as D,ad as x,b3 as I,b4 as q,a8 as E,V as f,d as j,x as N,b5 as M,m as k,b6 as V,B as L}from"./index-7df8d6db.js";import{b6 as v,B as g,N as K,r as A,aB as O,aD as U}from"./antd-79b0e736.js";import{u as C}from"./useMutation-6894a2eb.js";import{u as F}from"./index-371e4e07.js";import"./iconPark-31f72c99.js";import"./wangEditor-f0c73729.js";import"./tslib.es6-59680bf8.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const b=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/roleAuth/model/index.ts/atomMainTable",w(void 0));b.debugLabel="atomMainTable";const S=()=>D(b),X=()=>B(b);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const P=({userId:e,userName:t,isBatch:u,disabled:l})=>{const o=u?"批量取消授权":"取消授权",i=x(),c=Number(i.roleId),s=S(),{message:h,modal:m}=v.useApp(),{mutateAsync:d,isLoading:p}=C(async()=>{Array.isArray(e)?await I({roleId:c,userIds:e}):await q({roleId:c,userId:e})},{onSuccess:()=>{var r;s==null||s.reload(),(r=s==null?void 0:s.clearSelected)==null||r.call(s),h.success("取消授权成功")}}),y=()=>{m.confirm({title:"取消授权",content:a.jsxs(a.Fragment,{children:["确定取消授权用户",a.jsx(K.Text,{code:!0,children:t}),"吗？"]}),onOk:()=>d(),okButtonProps:{loading:p}})};return a.jsx(E,{accessible:!0,children:a.jsx(g,{type:"link",danger:!0,disabled:l,icon:a.jsx(R,{}),onClick:y,children:o})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Y=()=>{const e=x(),t=Number(e.roleId),[u,{toggle:l}]=F(),o=A.useRef(),[i,c]=A.useState([]),s=S(),{message:h}=v.useApp(),{isLoading:m,mutate:d}=C(()=>I({roleId:t,userIds:i}),{onSuccess:()=>{var r,n,T;(r=o.current)==null||r.reload(),(T=(n=o.current)==null?void 0:n.clearSelected)==null||T.call(n),s==null||s.reload(),l(),h.success("授权成功")}}),{valueEnumSysNormalDisable:p,defaultValueSysNormalDisable:y}=f();return a.jsxs(a.Fragment,{children:[a.jsx(g,{type:"primary",icon:a.jsx(O,{}),onClick:()=>{var r;(r=o.current)==null||r.reload(),l()},children:"授权用户"}),a.jsx(U,{open:u,title:"授权用户",placement:"left",onClose:l,width:850,footer:a.jsx(g,{type:"primary",disabled:i.length===0,loading:m,onClick:()=>d(),children:"提交"}),footerStyle:{textAlign:"right"},children:a.jsx(j,{ghost:!0,rowKey:"userId",actionRef:o,columns:[{dataIndex:"userName",key:"userName",title:"用户名称",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"用户昵称",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"邮箱",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"请输入邮箱"},{pattern:N,message:"邮箱格式错误"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"手机号码",valueType:"text",copyable:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:p,formItemProps:{initialValue:y,required:!0,rules:[{required:!0,message:"请选择状态"}]}},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0}],tableAlertRender:!1,rowSelection:{onChange:r=>{c(r)}},request:(...r)=>M(k(...r))})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const J=({selectedRows:e})=>a.jsx(P,{userId:e.map(t=>t.userId),userName:e.map(t=>t.userName).join(","),isBatch:!0,disabled:e.length===0}),Q=()=>{const e=x(),t=Number(e.roleId),u=X(),{valueEnumSysNormalDisable:l,defaultValueSysNormalDisable:o}=f();return a.jsx(j,{rowKey:"userId",actionRef:u,params:{roleId:t},columns:[{dataIndex:"userName",key:"userName",title:"用户名称",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"用户昵称",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"邮箱",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"请输入邮箱"},{pattern:N,message:"邮箱格式错误"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"手机号码",valueType:"text",copyable:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:l,formItemProps:{initialValue:o,required:!0,rules:[{required:!0,message:"请选择状态"}]}},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"操作",dataIndex:"option",valueType:"option",render:(i,c)=>a.jsx(P,{userId:c.userId,userName:c.userName})}],request:(...i)=>V(k(...i)),tableAlertRender:J,toolbar:{actions:[a.jsx(Y,{},"DrawerTableAuth")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const te=()=>a.jsx(L,{children:a.jsx(Q,{})});export{te as default};
