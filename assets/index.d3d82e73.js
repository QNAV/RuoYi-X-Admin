import{j as F,F as f,a,b2 as d,aD as p,bd as I,r as N,bL as y,av as c,bM as E,bN as h,br as g,bO as T,b3 as C,aE as B}from"./index.9ab0876b.js";import{B as D}from"./index.20e76e68.js";import{c as O}from"./common.061d994b.js";import{C as P,a as v,b as w,c as k,d as A,e as G,f as x,g as _,h as L,i as j,j as R,k as q,l as M,m as J,n as K,o as Q,p as z,q as S,r as Z,s as H,t as U,u as V,v as W,G as X,w as Y}from"./GenService.911aa729.js";import{G as $,u as ee}from"./useMutation.esm.f654451f.js";import{u as se}from"./useRequest.0a696058.js";import"./utils.esm.0b591295.js";const ae=({dataSource:s,handleEdit:n})=>{const l={onSave:async(u,e)=>{const t=u;await n({[t]:e[t]})}};return F(f,{children:[a(d,{dataSource:s,columns:[P,v,w,k,O],editable:l}),a(p,{}),a(d,{columns:[A,G,x,_,L,j,...(s==null?void 0:s.genType)===$.ZIP?[]:[R]],dataSource:s,editable:l})]})},ne=({dataSource:s,handleEdit:n,loading:l=!1})=>{const[u]=I.useForm(),[e,t]=N.exports.useState([]),m=(e==null?void 0:e.length)>0;return a(y,{toolbar:{actions:m?[a(c,{onClick:()=>t([]),icon:a(E,{}),children:"\u53D6\u6D88\u7F16\u8F91"},"cancelEdit"),a(c,{type:"primary",loading:l,icon:a(h,{}),onClick:async()=>{const o=await u.validateFields();await n({columns:Object.keys(o).map(i=>({...o[i],columnId:Number(i)}))}),t([])},children:"\u4FDD\u5B58"},"edit")]:[a(c,{icon:a(g,{}),type:"primary",onClick:()=>{s&&t(s==null?void 0:s.map(o=>{var i,r;return(r=(i=o==null?void 0:o.columnId)==null?void 0:i.toString())!=null?r:""}))},children:"\u7F16\u8F91"},"edit")]},rowKey:"columnId",ghost:!0,size:"small",scroll:{x:"max-content"},columns:[q,M,J,K,Q,z,S,Z,H,U,V,W],value:s,recordCreatorProps:!1,editable:{form:u,editableKeys:e}})},b={BASE_INFO:"\u57FA\u672C\u4FE1\u606F",FIELD_INFO:"\u5B57\u6BB5\u4FE1\u606F"},ce=()=>{var i;const s=T(),n=Number((i=s==null?void 0:s.tableId)!=null?i:"0"),[l,u]=N.exports.useState("BASE_INFO"),{data:e,refresh:t}=se(async()=>await X({tableId:n}),{ready:n>0,refreshDeps:[n]}),{mutateAsync:m,isLoading:o}=ee(async r=>{await Y({tableId:n,businessName:e.info.businessName,functionName:e.info.functionName,className:e.info.className,functionAuthor:e.info.functionAuthor,moduleName:e.info.moduleName,packageName:e.info.packageName,tableComment:e.info.tableComment,tableName:e.info.tableName,columns:e.rows,...r})},{onSuccess:()=>{t(),B.success("\u4FDD\u5B58\u6210\u529F")}});return a(D,{children:F(C,{tabs:{activeKey:l,onChange:r=>{u(r)}},children:[a(C.TabPane,{tab:b.BASE_INFO,children:a(ae,{dataSource:e==null?void 0:e.info,handleEdit:m})},"BASE_INFO"),a(C.TabPane,{tab:b.FIELD_INFO,children:a(ne,{dataSource:e==null?void 0:e.rows,handleEdit:m,loading:o})},"FIELD_INFO")]})})};export{ce as default};
