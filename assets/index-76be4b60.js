import{j as s}from"./antdProComponents-e22c8f35.js";import{e as y,f,h as T,A as c,j,k as I,l as k,B as v,d as b,m as C,i as A,n as S}from"./index-745cf65f.js";import{s as B,h as L,i as w,j as R}from"./Monitor-fe0b5f84.js";import{b9 as l,B as P,aD as M,r as E}from"./antd-1f44218c.js";import{u}from"./useMutation-4e59d89d.js";import"./iconPark-b877fbca.js";import"./wangEditor-efc1ec1c.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const h=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/logininfor/model/index.ts/atomMainTableActions",y(void 0));h.debugLabel="atomMainTableActions";const g=()=>T(h),D=()=>f(h);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const O=()=>{const{message:e,modal:t}=l.useApp(),a=g(),{mutate:o,isLoading:r}=u(B,{onSuccess:()=>{var n;(n=a==null?void 0:a.clearSelected)==null||n.call(a),a==null||a.reload(),e.success("清空成功")}}),i=()=>{t.confirm({title:"操作确认",content:"确认清空访问记录吗？",okButtonProps:{loading:r},onOk:()=>o({})})};return s.jsx(c,{accessKey:"monitor:logininfor:remove",children:s.jsx(P,{danger:!0,icon:s.jsx(M,{}),onClick:i,children:"清空"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const K=async e=>{const{data:t}=await L(e,{format:"blob"});await I(t,`user_${new Date().getTime()}.xlsx`)},U=({searchParams:e})=>{const{message:t}=l.useApp(),{isLoading:a,mutate:o}=u(K,{onSuccess:()=>{t.success("导出成功")}});return s.jsx(c,{accessKey:"monitor:logininfor:export",children:s.jsx(j,{loading:a,onClick:()=>o(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const m=({infoIds:e,disabled:t,batch:a})=>{const o=g(),{message:r,modal:i}=l.useApp(),{mutate:n,isLoading:p}=u(w,{onSuccess:()=>{var d;(d=o==null?void 0:o.clearSelected)==null||d.call(o),o==null||o.reload(),r.success("删除成功")}}),x=()=>{i.confirm({title:"操作确认",content:`确定删除访问编号为 ${e.join(",")} 的访问记录吗？`,okButtonProps:{loading:p},onOk:()=>n({infoIds:e})})};return s.jsx(c,{accessKey:"monitor:logininfor:remove",children:s.jsx(k,{batch:a,disabled:t,onClick:x})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const N=()=>{const{valueEnumSysLoginStatus:e}=S();return[{title:"访问编号",dataIndex:"infoId",key:"infoId",valueType:"text",hideInSearch:!0},{title:"用户名称",dataIndex:"userName",key:"userName",valueType:"text"},{title:"登录地址",dataIndex:"ipaddr",key:"ipaddr",valueType:"text"},{title:"登录地点",dataIndex:"loginLocation",key:"loginLocation",valueType:"text",hideInSearch:!0},{title:"浏览器",dataIndex:"browser",key:"browser",valueType:"text",hideInSearch:!0},{title:"操作系统",dataIndex:"os",key:"os",valueType:"text",hideInSearch:!0},{title:"登录状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:e},{title:"操作信息",dataIndex:"msg",key:"msg",valueType:"text",hideInSearch:!0},{title:"登录时间",dataIndex:"loginTime",key:"loginTime",valueType:"dateTime",hideInSearch:!0},{title:"登录时间",dataIndex:"dateTimeRange",key:"dateTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",dataIndex:"option",key:"option",valueType:"option",fixed:"right",render:(t,a)=>s.jsx(m,{infoIds:[a.infoId]})}]},V=({selectedRowKeys:e})=>s.jsx(m,{batch:!0,disabled:e.length===0,infoIds:e}),W=()=>{const e=D(),[t,a]=E.useState({}),o=N();return s.jsx(v,{children:s.jsx(b,{rowKey:"infoId",actionRef:e,columns:o,request:async(...r)=>{const{dateTimeRange:i,...n}=C(...r);return A(i)&&(n.beginTime=i[0],n.endTime=i[1]),a(n),await R(n)},toolbar:{actions:[s.jsx(O,{},"ButtonCleanUp"),s.jsx(U,{searchParams:t},"ButtonExport")]},tableAlertOptionRender:V})})};export{W as default};
