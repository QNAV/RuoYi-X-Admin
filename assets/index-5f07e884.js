import{aX as R,aY as M,cL as y,aH as A,dH as q,dI as B,d as a,af as L,aA as g,dJ as U,a_ as _,j as f,h as x,cd as E,r as T,dK as K,b9 as v,c1 as V,G as D,b0 as k,be as N,dL as O,b1 as P,dM as S,av as X}from"./index-5350100f.js";import{a as Y}from"./index-722ae1ee.js";import{u as j}from"./useMutation.esm-86b49fa0.js";import{u as H}from"./index-e40c4c77.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const b=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/roleAuth/model/index.ts/atomMainTable",R(void 0));b.debugLabel="atomMainTable";const C=()=>M(b),F=()=>Y(b);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const w=({userId:e,userName:t,isBatch:n,disabled:s})=>{const o=n?"批量取消授权":"取消授权",c=y(),u=Number(c.roleId),r=C(),{mutateAsync:m,isLoading:p}=j(async()=>{Array.isArray(e)?await q({roleId:u,userIds:e}):await B({roleId:u,userId:e})},{onSuccess:()=>{var h;r==null||r.reload(),(h=r==null?void 0:r.clearSelected)==null||h.call(r),A.success("取消授权成功")}});return a(L,{accessible:!0,children:a(g,{type:"link",danger:!0,disabled:s,icon:a(U,{}),onClick:()=>{_.confirm({title:"取消授权",content:f(x,{children:["确定取消授权用户",a(E.Text,{code:!0,children:t}),"吗？"]}),onOk:()=>m(),okButtonProps:{loading:p}})},children:o})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const G=()=>{var h;const e=y(),t=Number(e.roleId),[n,{toggle:s}]=H(),o=T.exports.useRef(),[c,u]=T.exports.useState([]),r=C(),{isLoading:m,mutate:p}=j(()=>K({roleId:t,userIds:c}),{onSuccess:()=>{var l,d,I;(l=o.current)==null||l.reload(),(I=(d=o.current)==null?void 0:d.clearSelected)==null||I.call(d),r==null||r.reload(),s(),A.success("授权成功")}}),{data:i}=v("sys_common_status");return f(x,{children:[a(g,{type:"primary",icon:a(V,{}),onClick:()=>{var l;(l=o.current)==null||l.reload(),s()},children:"授权用户"}),a(D,{open:n,title:"授权用户",placement:"left",onClose:s,width:850,footer:a(g,{type:"primary",disabled:c.length===0,loading:m,onClick:()=>p(),children:"提交"}),footerStyle:{textAlign:"right"},children:a(k,{ghost:!0,rowKey:"userId",actionRef:o,columns:[{dataIndex:"userName",key:"userName",title:"用户名称",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"用户昵称",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"邮箱",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"请输入邮箱"},{pattern:N,message:"邮箱格式错误"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"手机号码",valueType:"text",copyable:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:(h=i==null?void 0:i.valueEnum)!=null?h:{},formItemProps:{initialValue:i==null?void 0:i.defaultValue,required:!0,rules:[{required:!0,message:"请选择状态"}]}},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0}],tableAlertRender:!1,rowSelection:{onChange:l=>{u(l)}},request:(...l)=>O(P(...l))})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const J=({selectedRows:e})=>a(w,{userId:e.map(t=>t.userId),userName:e.map(t=>t.userName).join(","),isBatch:!0,disabled:e.length===0}),Q=()=>{var o;const e=y(),t=Number(e.roleId),n=F(),{data:s}=v("sys_common_status");return a(k,{rowKey:"userId",actionRef:n,params:{roleId:t},columns:[{dataIndex:"userName",key:"userName",title:"用户名称",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"用户昵称",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"邮箱",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"请输入邮箱"},{pattern:N,message:"邮箱格式错误"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"手机号码",valueType:"text",copyable:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:(o=s==null?void 0:s.valueEnum)!=null?o:{},formItemProps:{initialValue:s==null?void 0:s.defaultValue,required:!0,rules:[{required:!0,message:"请选择状态"}]}},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"操作",dataIndex:"option",valueType:"option",render:(c,u)=>a(w,{userId:u.userId,userName:u.userName})}],request:(...c)=>S(P(...c)),tableAlertRender:J,toolbar:{actions:[a(G,{},"DrawerTableAuth")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ee=()=>a(X,{children:a(Q,{})});export{ee as default};
