import{w as i,q as p,j as o,ai as d,aj as m,ak as T,al as F,e as l,F as E,am as S,an as a,s as j,v as B,ap as O,r as v,O as f,aq as k,ar as M,as as P}from"./index.60379a16.js";import{e as C,j as A}from"./index.c3c21a27.js";import{b as L}from"./index.127d6907.js";import{u as g}from"./useMutation.esm.b6a2a5cc.js";import"./useQuery.esm.1bb28d99.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function w(e){return i("/monitor/operlog/clean",{method:"POST",...e||{}})}async function R(e,t){return i("/monitor/operlog/export",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function q(e,t){return i("/monitor/operlog/list",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function _(e,t){return i("/monitor/operlog/remove",{method:"POST",params:{...e},...t||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const b=({operId:e,title:t,disabled:s,isBatch:c})=>{const h=c?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",{canRemoveSysOperLog:n}=C(),u=x(),{mutateAsync:D,isLoading:I}=g(async r=>{await _({operIds:r})},{onSuccess:()=>{var r;u==null||u.reload(),(r=u==null?void 0:u.clearSelected)==null||r.call(u),p.success("\u5220\u9664\u6210\u529F")}});return o(d,{accessible:n,children:o(m,{type:"link",danger:!0,disabled:s,icon:o(T,{}),onClick:()=>{F.confirm({title:"\u5220\u9664\u64CD\u4F5C\u65E5\u5FD7",content:l(E,{children:["\u786E\u5B9A\u5220\u9664\u64CD\u4F5C\u65E5\u5FD7",o(S.Text,{code:!0,children:t}),"\u5417\uFF1F"]}),onOk:async()=>D(e),okButtonProps:{loading:I}})},children:h})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const[N]=a({title:"\u65E5\u5FD7\u7F16\u53F7",dataIndex:"operId",key:"operId",valueType:"text",hideInSearch:!0}),[V]=a({title:"\u7CFB\u7EDF\u6A21\u5757",dataIndex:"title",key:"title",valueType:"text"}),[U]=a({title:"\u8BF7\u6C42\u65B9\u5F0F",dataIndex:"requestMethod",key:"requestMethod",valueType:"text",hideInSearch:!0}),[X]=a({title:"\u64CD\u4F5C\u4EBA\u5458",dataIndex:"operName",key:"operName",valueType:"text"}),[Y]=a({title:"\u64CD\u4F5C\u5730\u5740",dataIndex:"operIp",key:"operIp",valueType:"text",hideInSearch:!0}),[K]=a({title:"\u64CD\u4F5C\u5730\u70B9",dataIndex:"operLocation",key:"operLocation",valueType:"text",hideInSearch:!0}),Q=a({title:"\u64CD\u4F5C\u65E5\u671F",dataIndex:"operTime",key:"operTime",valueType:"dateTime",hideInSearch:!0}),[z]=a({title:"\u64CD\u4F5C",dataIndex:"option",key:"option",valueType:"option",render:(e,t)=>o(b,{title:t.title,operId:t.operId})},{table:{fixed:"right"}}),G=()=>{const{data:e}=A("sys_oper_type");return a({title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"businessType",key:"businessType",valueType:"select",valueEnum:e!=null?e:{}})},H=()=>{const{data:e}=A("sys_common_status");return a({title:"\u64CD\u4F5C\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:e!=null?e:{}})},J=()=>[N,V,G(),U,X,Y,K,H(),Q,z];globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const y=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/operlog/model/index.ts/atomMainTableActions",j(void 0));y.debugLabel="atomMainTableActions";const x=()=>B(y),W=()=>L(y);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Z=()=>{const{canRemoveSysOperLog:e}=C(),t=x(),{isLoading:s,mutate:c}=g(()=>w(),{onSuccess:()=>{t==null||t.reload(),p.success("\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u6210\u529F")}});return o(d,{accessible:e,children:o(m,{danger:!0,icon:o(T,{}),onClick:()=>F.confirm({title:"\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7",content:"\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u540E\u5C06\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u6E05\u7A7A\u64CD\u4F5C\u65E5\u5FD7\u5417\uFF1F",okButtonProps:{loading:s},onOk:c}),children:"\u6E05\u7A7A"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const $=({searchParams:e})=>{const{canExportSysOperLog:t}=C(),{isLoading:s,mutate:c}=g(()=>R(e),{onSuccess:()=>{p.success("\u5BFC\u51FA\u6210\u529F")}});return o(d,{accessible:t,children:o(m,{ghost:!0,type:"primary",icon:o(O,{}),loading:s,onClick:()=>c(),children:"\u5BFC\u51FA\u5F53\u524D\u5217\u8868"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ee=({selectedRows:e})=>l(P,{children:[l("span",{children:["\u5DF2\u9009\u62E9 ",e.length," \u9879"]}),o(b,{isBatch:!0,disabled:e.length===0,title:e.map(t=>t.operId).join(","),operId:e.map(t=>t.title).join(",")})]}),ne=()=>{const e=J(),t=W(),[s,c]=v.exports.useState({});return o(f,{children:o(k,{rowKey:"operId",actionRef:t,columns:e,request:async(...h)=>{const n=M(...h);return c(n),await q(n)},toolbar:{actions:[o(Z,{},"ButtonCleanUp"),o($,{searchParams:s},"ButtonExport")]},rowSelection:{alwaysShowAlert:!0},tableAlertRender:ee})})};export{ne as default};
