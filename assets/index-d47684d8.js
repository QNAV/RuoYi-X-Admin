import{V as l,j as a,f as n,X as f,r as y,A as R,B as S,b as V,Q as i,Y as h,Z as g}from"./index-fe009615.js";import{a as G,b as M,d as O,e as q,f as E,g as Q}from"./Monitor-22bef4b1.js";import{u}from"./useRequest-14518e37.js";import{u as m}from"./useMutation-59a0dfa2.js";import{P as X}from"./index-7b555ffc.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const[Y,Z]=l({title:"缓存名称",dataIndex:"cacheName",table:{valueType:"text",ellipsis:!0},descriptions:{valueType:"text",copyable:!0}}),[z,F]=l({title:"缓存键名",dataIndex:"cacheKey",table:{valueType:"text",ellipsis:!0},descriptions:{valueType:"text",copyable:!0}}),[,H]=l({title:"缓存内容",dataIndex:"cacheValue",descriptions:{valueType:"text",copyable:!0}}),[J,U]=l({title:"备注",dataIndex:"remark",table:{valueType:"text"},descriptions:{valueType:"text"}}),W=e=>[{title:"序号",valueType:"indexBorder",width:50},Y,J,{title:"操作",valueType:"option",width:50,render:(s,c)=>a(n,{type:"text",danger:!0,icon:a(f,{}),onClick:o=>{o.stopPropagation(),e(c.cacheName)}})}],_=e=>[{title:"序号",valueType:"indexBorder",width:50},z,{title:"操作",valueType:"option",width:50,render:(s,c)=>a(n,{type:"text",danger:!0,icon:a(f,{}),onClick:o=>{o.stopPropagation(),e(c.cacheKey)}})}],$=[Z,F,H,U];globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const oe=()=>{const[e,s]=y.useState(),[c,o]=y.useState(),{message:r}=R.useApp(),{data:x,refresh:d,loading:T}=u(G),{data:K,refresh:p,loading:b,mutate:N}=u(async()=>(await M(e)).map(L=>({cacheKey:L})),{ready:!!e,refreshDeps:[e]}),{data:w,mutate:C}=u(()=>O(e,c),{ready:!!c,refreshDeps:[c]}),{mutate:D,isLoading:I}=m(async t=>{await q(t),t===e&&N([]),d(),r.success("操作成功")}),{mutate:v,isLoading:k}=m(async t=>{await E(e,t),t===c&&C({}),p(),r.success("操作成功")}),{mutate:B,isLoading:A}=m(async()=>{await Q(),C({}),r.success("操作成功")}),P=W(D),j=_(v);return a(S,{children:V(i,{ghost:!0,gutter:[8,8],children:[a(i,{title:"缓存列表",extra:[a(n,{type:"text",icon:a(h,{}),onClick:d,loading:I},"Button")],children:a(g,{rowKey:"cacheName",ghost:!0,search:!1,rowSelection:!1,pagination:!1,columns:P,options:!1,dataSource:x,scroll:{},loading:T,onRow:t=>({onClick:()=>s(t.cacheName)})})}),a(i,{title:"键名列表",extra:[a(n,{type:"text",icon:a(h,{}),onClick:p,loading:k},"Button")],children:a(g,{rowKey:"cacheKey",ghost:!0,search:!1,rowSelection:!1,pagination:!1,columns:j,options:!1,dataSource:K,scroll:{},loading:b,onRow:t=>({onClick:()=>o(t.cacheKey)})})}),a(i,{title:"缓存内容",extra:[a(n,{type:"text",icon:a(h,{}),onClick:()=>B(),loading:A,children:"清理全部"},"Button")],children:a(X,{column:1,columns:$,dataSource:w})})]})})};export{oe as default};
