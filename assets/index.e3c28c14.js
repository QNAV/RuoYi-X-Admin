import{h as B,l as j,n as x,o as h,r as m,j as a,ai as M,g as F,W as D,$ as E,az as I,Y as C,af as A,ag as g,aA as v,aB as O,aj as R,ah as V,ak as L,al as q,F as Y,I as W}from"./index.77cf182b.js";import{j as S,b as y}from"./index.8cf7e695.js";import{a as X}from"./index.9d0fc2aa.js";import{a as _,u as N}from"./utils.10b4f726.js";import{P as $}from"./index.fe005647.js";import{P as z}from"./index.c836376f.js";import{u as T}from"./useMutation.esm.87ca3d6d.js";import"./useQuery.esm.d069177d.js";import"./utils.esm.c3905fca.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const b=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/post/model/index.ts/atomMainTableActions",B(void 0));b.debugLabel="atomMainTableActions";const G=()=>X(b),k=()=>j(b),p=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/post/model/index.ts/atomAddOrEditModal",_({open:!1,actionType:"add"}));p.debugLabel="atomAddOrEditModal";const H=()=>{const t=x(p);return()=>t({open:!0,actionType:"add"})},K=()=>{const t=x(p);return e=>t({open:!0,actionType:"edit",record:e})},Q=()=>N(p),J=()=>j(p);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};async function U(t,e){return h("/system/post/add",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function Z(t,e){return h("/system/post/edit",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function tt(t,e){return h("/system/post/export",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function et(t,e){return h("/system/post/list",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function at(t,e){return h("/system/post/remove",{method:"POST",params:{...t},...e||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ot=()=>{var P;const t=m.exports.useRef(),{open:e,actionType:o,record:u}=J(),d=Q(),s=()=>{var i;o==="edit"&&((i=t.current)==null||i.resetFields()),d()},r=k(),{data:c}=S("sys_normal_disable"),{mutate:f,isLoading:n}=T(async()=>{var l;const i=await((l=t.current)==null?void 0:l.validateFields());if(!!i){if(o==="add"){await U(i);return}await Z({...i,postId:u.postId})}},{onSuccess:()=>{r==null||r.reload(),s(),C.success(o==="add"?"\u65B0\u5EFA\u6210\u529F":"\u4FDD\u5B58\u6210\u529F")}});return m.exports.useEffect(()=>{if(e&&o==="edit"){const i=setTimeout(()=>{var l;(l=t.current)==null||l.setFieldsValue(u),clearTimeout(i)},0)}},[e]),a(M,{open:e,onCancel:s,okText:"\u63D0\u4EA4",okButtonProps:{loading:n},onOk:()=>f(),title:o==="add"?"\u65B0\u5EFA\u5C97\u4F4D":"\u7F16\u8F91\u5C97\u4F4D\u4FE1\u606F",children:F(D,{submitter:!1,formRef:t,children:[a(E,{name:"postName",label:"\u5C97\u4F4D\u540D\u79F0",rules:[{required:!0}]}),a(E,{name:"postCode",label:"\u5C97\u4F4D\u7F16\u7801",rules:[{required:!0}]}),a($,{name:"postSort",label:"\u663E\u793A\u987A\u5E8F",rules:[{required:!0}],initialValue:0}),a(I.Group,{name:"status",label:"\u72B6\u6001",valueEnum:(P=c==null?void 0:c.mapData)!=null?P:{},initialValue:c==null?void 0:c.defaultValue}),a(z,{name:"remark",label:"\u5907\u6CE8"})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const st=()=>{const{canAddSysPost:t}=y(),e=H();return a(A,{accessible:t,children:a(g,{type:"primary",icon:a(v,{}),onClick:e,children:"\u65B0\u5EFA"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ut=({record:t})=>{const{canEditSysPost:e}=y(),o=K();return a(A,{accessible:e,children:a(g,{type:"link",icon:a(O,{}),onClick:()=>o(t),children:"\u7F16\u8F91"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const rt=({searchParams:t})=>{const{canExportSysPost:e}=y(),{isLoading:o,mutate:u}=T(()=>tt(t),{onSuccess:()=>{C.success("\u5BFC\u51FA\u6210\u529F")}});return a(A,{accessible:e,children:a(g,{type:"primary",ghost:!0,icon:a(R,{}),loading:o,onClick:()=>u(),children:"\u5BFC\u51FA\u5F53\u524D\u5217\u8868"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const w=({postId:t,isBatch:e,disabled:o})=>{const u=e?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",{canRemoveSysPost:d}=y(),s=k(),{mutateAsync:r,isLoading:c}=T(async n=>{await at({postIds:n})},{onSuccess:()=>{var n;s==null||s.reload(),(n=s==null?void 0:s.clearSelected)==null||n.call(s),C.success("\u5220\u9664\u6210\u529F")}});return a(A,{accessible:d,children:a(g,{type:"link",danger:!0,disabled:o,icon:a(V,{}),onClick:()=>{M.confirm({title:"\u5220\u9664\u5C97\u4F4D",content:`\u786E\u5B9A\u5220\u9664\u5C97\u4F4D\u7F16\u53F7\u4E3A ${t} \u7684\u5C97\u4F4D\u5417\uFF1F`,onOk:async()=>r(t),okButtonProps:{loading:c}})},children:u})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ct=()=>{var e;const{data:t}=S("sys_normal_disable");return[{dataIndex:"postId",key:"postId",title:"\u5C97\u4F4D\u7F16\u53F7",valueType:"text",hideInSearch:!0},{dataIndex:"postCode",key:"postCode",title:"\u5C97\u4F4D\u7F16\u7801",valueType:"text"},{dataIndex:"postName",key:"postName",title:"\u5C97\u4F4D\u540D\u79F0",valueType:"text"},{dataIndex:"postSort",key:"postSort",title:"\u663E\u793A\u987A\u5E8F",valueType:"text",hideInSearch:!0},{title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"select",valueEnum:(e=t==null?void 0:t.mapData)!=null?e:{}},{title:"\u5907\u6CE8",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"\u64CD\u4F5C",valueType:"option",render:(o,u)=>F(Y,{children:[a(ut,{record:u}),a(w,{postId:u.postId})]})}]},it=({selectedRows:t})=>a(w,{disabled:t.length===0,isBatch:!0,postId:t.map(e=>e.postId).join(",")}),nt=()=>{const[t,e]=m.exports.useState({}),o=m.exports.useRef(),u=G(),d=ct();return a(L,{formRef:o,actionRef:u,rowKey:"postId",request:async(...s)=>{const r=q(...s);return e(r),await et(r)},columns:d,toolbar:{actions:[a(rt,{searchParams:t},"ButtonExport"),a(st,{},"ButtonAdd")]},tableAlertOptionRender:it})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ct=()=>F(W,{children:[a(nt,{}),a(ot,{})]});export{Ct as default};
