import{cg as I,af as c,ag as S,aj as d,c2 as i,cr as m,b5 as f,j as D,k as R,d as w,c3 as C,ck as b,aR as T}from"./index-5129c4ee.js";import{u as l,E as p,F as j}from"./System-e98d1e38.js";import{a as M,u as h}from"./utils-2e2b94e3.js";import{u as x}from"./useMutation.esm-a8c6dcb5.js";import"./utils.esm-88b6f67f.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const y="systemMenu",L=e=>{const s=a=>a.filter(n=>n.menuType!==b.F).map(({menuId:n,menuName:o,children:t})=>({menuId:n,menuName:o,children:t?s(t):[]}));return[{menuId:0,menuName:"根目录",children:e?s(e):[]}]},u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",M({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));u.debugLabel="atomSelectedMenuData";const O=()=>h(u),Y=()=>I(u),v=()=>c(u),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomAddModal",M(!1));r.debugLabel="atomAddModal";const V=()=>h(r),B=()=>{const e=S(r);return()=>e(!0)},K=()=>c(r),g=[y,"list"],F=()=>{const e=d();return()=>e.invalidateQueries(g)},E=(e={},s)=>l(g,async()=>{const a=await p(e),n=i(a,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:m(n),map:a.reduce((o,t)=>o.set(t.menuId,t),new Map),parentIds:Array.from(a.reduce((o,t)=>o.add(t.parentId),new Set))}},{onSuccess:a=>{s(a.parentIds)}}),A=[y,"options"],k=()=>{const e=d();return()=>e.invalidateQueries(A)},H=()=>l(A,async()=>{const e=await p({}),s=i(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:L(m(s)),map:e.reduce((a,n)=>a.set(n.menuId,n),new Map)}}),W=()=>{const e=F(),s=k(),a=O(),{mutateAsync:n,isLoading:o}=x(async t=>{await j({menuId:t})},{onSuccess:async()=>{a(),await Promise.all([e(),s()]),T.success("删除成功")}});return t=>{f.confirm({title:"删除菜单",content:D(R,{children:["确定删除菜单",w(C.Text,{code:!0,children:t.menuName}),"吗？"]}),onOk:()=>n(t.menuId),okButtonProps:{loading:o}})}};export{Y as useAtomStateSelectedMenuData,K as useAtomValueCreateModal,v as useAtomValueSelectedMenuData,W as useDeleteMenu,V as useHideCreateModal,E as useQueryMenuList,H as useQueryMenuOptions,F as useReFetchMenuList,k as useReFetchMenuOptions,O as useResetSelectedMenuData,B as useShowCreateModal};
