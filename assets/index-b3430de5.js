import{$ as d,a0 as m,a1 as g,A as n,j as o,a2 as i,f as y,X as T,a3 as x,a4 as I,a5 as v,r as C,B as b,Z as A,a6 as f,a7 as k,a9 as S}from"./index-186fd45b.js";import{m as j,n as w,o as B,p as M}from"./Monitor-0cc3755c.js";import{u as R}from"./useMutation-c1b56ef0.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const l=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/operlog/model/index.ts/atomMainTableActions",d(void 0));l.debugLabel="atomMainTableActions";const u=()=>g(l),E=()=>m(l);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const O=()=>{const e=u(),{message:t,modal:s}=n.useApp();return o(i,{accessKey:"monitor:operlog:remove",children:o(y,{danger:!0,icon:o(T,{}),onClick:()=>{s.confirm({title:"操作确认",content:"确认清空操作日志吗？",onOk:async()=>{var r;await j(),(r=e==null?void 0:e.reloadAndRest)==null||r.call(e),e==null||e.reload(),t.success("清空成功")}})},children:"清空"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const P=async e=>{const{data:t}=await w(e,{format:"blob"});await I(t,`operlog_${new Date().getTime()}.xlsx`)},L=({searchParams:e})=>{const{message:t}=n.useApp(),{isLoading:s,mutate:a}=R(P,{onSuccess:()=>{t.success("导出成功")}});return o(i,{accessKey:"monitor:operlog:export",children:o(x,{loading:s,onClick:()=>a(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const p=({operId:e,disabled:t=!1,batch:s=!1})=>{const a=u(),{message:r,modal:c}=n.useApp();return o(i,{accessKey:"monitor:operlog:remove",children:o(v,{disabled:t,batch:s,onClick:()=>{c.confirm({title:"操作确认",content:`确定删除日志编号为 ${e} 的操作日志吗?`,onOk:async()=>{var h;await B({operIds:e}),(h=a==null?void 0:a.clearSelected)==null||h.call(a),a==null||a.reload(),r.success("删除成功")}})}})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const D=()=>{const{valueEnumSysNormalDisable:e}=k(),{valueEnumSysOperType:t}=S();return[{title:"日志编号",dataIndex:"operId",key:"operId",valueType:"text",hideInSearch:!0},{title:"系统模块",dataIndex:"title",key:"title",valueType:"text"},{title:"操作类型",dataIndex:"businessType",key:"businessType",valueType:"select",valueEnum:t},{title:"请求方式",dataIndex:"requestMethod",key:"requestMethod",valueType:"text",hideInSearch:!0},{title:"操作人员",dataIndex:"operName",key:"operName",valueType:"text"},{title:"操作地址",dataIndex:"operIp",key:"operIp",valueType:"text",hideInSearch:!0},{title:"操作地点",dataIndex:"operLocation",key:"operLocation",valueType:"text",hideInSearch:!0},{title:"操作状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:e},{title:"操作时间",dataIndex:"operTime",key:"operTime",valueType:"dateTime",hideInSearch:!0},{title:"操作时间",dataIndex:"dateTimeRange",key:"dateTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",dataIndex:"option",key:"option",valueType:"option",fixed:"right",render:(s,a)=>o(p,{operId:[a.operId]})}]},K=({selectedRows:e})=>o(p,{batch:!0,disabled:e.length===0,operId:e.map(t=>t.operId)}),$=()=>{const e=E(),t=D(),[s,a]=C.useState({});return o(b,{children:o(A,{rowKey:"operId",actionRef:e,columns:t,request:async(...r)=>{const c=f(...r);return a(c),await M(c)},toolbar:{actions:[o(O,{},"ButtonCleanUp"),o(L,{searchParams:s},"ButtonExport")]},tableAlertOptionRender:K})})};export{$ as default};
