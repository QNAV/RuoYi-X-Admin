import{u as D,M as F}from"./useMutation.esm.f654451f.js";import{c as i,d as R}from"./SysMenuService.6ce02f18.js";import{R as d,b7 as l,o as h,i as p,n as C,E as m,b9 as _,j as x,F as w,a as O,bc as E,aE as Q}from"./index.9ab0876b.js";import{p as M,s as y}from"./tree.c5bc5173.js";import{u as I}from"./useQuery.esm.f2392cff.js";import"./utils.esm.0b591295.js";const r="systemMenu",L=e=>{const s=t=>t.filter(n=>n.menuType!==F.F).map(({menuId:n,menuName:u,children:a})=>({menuId:n,menuName:u,children:a?s(a):[]}));return[{menuId:0,menuName:"\u6839\u76EE\u5F55",children:e?s(e):[]}]},o=d({key:`${r}SelectedMenuData`,default:{hasSelected:!1,selectedMenuId:0,selectedMenuName:"\u6839\u76EE\u5F55"}}),P=()=>l(o),N=()=>h(o),B=()=>p(o),c=d({key:`${r}CreateModal`,default:!1}),K=()=>l(c),V=()=>{const e=C(c);return()=>e(!0)},$=()=>p(c),S=[r,"list"],T=()=>{const e=m();return()=>e.invalidateQueries(S)},H=(e={},s)=>I(S,async()=>{const t=await i(e),n=M(t,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:y(n),map:t.reduce((u,a)=>u.set(a.menuId,a),new Map),parentIds:Array.from(t.reduce((u,a)=>u.add(a.parentId),new Set))}},{onSuccess:t=>{s(t.parentIds)}}),f=[r,"options"],g=()=>{const e=m();return()=>e.invalidateQueries(f)},z=()=>I(f,async()=>{const e=await i({}),s=M(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:L(y(s)),map:e.reduce((t,n)=>t.set(n.menuId,n),new Map)}}),G=()=>{const e=T(),s=g(),t=P();return D(async({menuId:n,menuName:u})=>{_.confirm({title:"\u5220\u9664\u83DC\u5355",content:x(w,{children:["\u786E\u5B9A\u5220\u9664\u83DC\u5355",O(E.Text,{code:!0,children:u}),"\u5417\uFF1F"]}),onOk:async()=>{await R({menuId:n}),t(),await Promise.all([e(),s()]),Q.success("\u5220\u9664\u6210\u529F")}})})};export{G as useDeleteMenu,K as useHideCreateModal,H as useQueryMenuList,z as useQueryMenuOptions,T as useReFetchMenuList,g as useReFetchMenuOptions,P as useResetSelectedMenuData,V as useShowCreateModal,N as useStateSelectedMenuData,$ as useValueCreateModal,B as useValueSelectedMenuData};
