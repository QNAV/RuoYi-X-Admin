import{aV as b,X as d,aj as w,aw as i,az as l,A as D,b as R,p as f,j,aC as x,bn as m,ay as p,bo as M,bp as C,bq as L}from"./index-e9bba9a2.js";import{u as O}from"./useMutation-656aed2c.js";import{a as h,u as A}from"./utils-aa38ad6e.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const y="systemMenu",r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",h({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));r.debugLabel="atomSelectedMenuData";const T=()=>A(r),k=()=>b(r),V=()=>d(r),c=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomModalAdd",h(!1));c.debugLabel="atomModalAdd";const Y=()=>A(c),v=()=>{const e=w(c);return()=>e(!0)},N=()=>d(c),g=[y,"list"],B=(e={},s)=>i(g,async()=>{const t=await m(e),a=p(t,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:M(a),map:t.reduce((o,n)=>o.set(n.menuId,n),new Map),parentIds:Array.from(t.reduce((o,n)=>o.add(n.parentId),new Set))}},{onSuccess:t=>{s(t.parentIds)}}),P=()=>{const e=l();return()=>e.invalidateQueries(g)},S=[y,"options"],K=()=>i(S,async()=>{const e=await m({}),s=p(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:C(M(s)),map:e.reduce((t,a)=>t.set(a.menuId,a),new Map)}}),Q=()=>{const e=l();return()=>e.invalidateQueries(S)},z=()=>{const e=P(),s=Q(),t=T(),{message:a,modal:o}=D.useApp(),{mutateAsync:n,isLoading:I}=O(async u=>{await L({menuId:u})},{onSuccess:async()=>{t(),await Promise.all([e(),s()]),a.success("删除成功")}});return u=>{o.confirm({title:"操作确认",content:R(f,{children:["确定删除菜单",j(x.Text,{code:!0,children:u.menuName}),"吗？"]}),onOk:()=>n(u.menuId),okButtonProps:{loading:I}})}};export{k as useAtomStateSelectedMenuData,N as useAtomValueModalAdd,V as useAtomValueSelectedMenuData,z as useDeleteMenu,Y as useHideModalAdd,B as useQueryMenuList,K as useQueryMenuOptions,P as useReFetchMenuList,Q as useReFetchMenuOptions,T as useResetSelectedMenuData,v as useShowModalAdd};
