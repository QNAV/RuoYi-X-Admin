import{R as f,H as h,J as A,aV as y,r as x,aT as I,g as l,j as e,aE as D}from"./index.ef912f72.js";import{B as N}from"./index.fa2a799d.js";import{C as P,b as F}from"./common.58c02837.js";import{A as B,P as C}from"./index.5e3cc60b.js";import{c as R}from"./keepAlive.1e0d4c88.js";import{u as g,c as k}from"./useInitActionType.ce72715b.js";import{u as E}from"./index.fade9bf7.js";import{u as v}from"./useMutation.esm.393173fd.js";import{B as U,b as M}from"./index.9ade6068.js";import{M as _,T as q}from"./Tree.729caba6.js";import{a as w,I as j}from"./index.0e0f914a.js";import{P as u}from"./index.0f91907b.js";import{P as O}from"./Table.e2b2bd57.js";import{E as V}from"./index.febb701a.js";import{a as L}from"./SysDeptService.9231117d.js";import{u as $}from"./useRequest.29ee2580.js";import{P as m}from"./index.1dc5c0a1.js";/* empty css              */import"./RouteContext.b1a35a93.js";import"./utils.esm.902822bd.js";import"./PortalWrapper.57172c6f.js";import"./index.43860d72.js";import"./index.f2a942ca.js";import"./unstated-next.a8233bbc.js";import"./index.dc2fa0de.js";const G={dataIndex:"userId",key:"userId",title:"\u7528\u6237\u7F16\u53F7",valueType:"text",editable:!1,hideInSearch:!0},H={dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},J={dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},K={dataIndex:["dept","deptName"],key:"deptDeptName",title:"\u90E8\u95E8\u540D\u79F0",valueType:"text",hideInSearch:!0},z={dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text"},S="systemUser",b=f({key:`${S}AtomMainTableActions`,default:void 0}),Q=()=>h(b),W=()=>g(b),T=f({key:`${S}AtomSelectedDeptId`,default:0}),X=()=>h(T),Y=()=>A(T);async function Z(t,a){return y("/system/user/add",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...a||{}})}async function ee(t,a){return y("/system/user/list",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...a||{}})}const te=()=>{const t=R(),[a,{toggle:r}]=E(),s=x.exports.useRef(),o=Q(),{isLoading:n,mutate:c}=v(async()=>{var i,p;const d=await((p=(i=s.current)==null?void 0:i.validateFieldsReturnFormatValue)==null?void 0:p.call(i));!d||await Z(d)},{onSuccess:()=>{o==null||o.reload(),I.success("\u6DFB\u52A0\u6210\u529F")}});return l(B,{accessible:t.canAddSysUser,children:[e(U,{type:"primary",icon:e(D,{}),onClick:r,children:"\u65B0\u589E"}),e(_,{title:"\u6DFB\u52A0\u7528\u6237",open:a,onCancel:r,confirmLoading:n,okText:"\u63D0\u4EA4",onOk:()=>c(),children:l(w,{submitter:!1,formRef:s,grid:!0,colProps:{span:12},children:[e(u,{name:"nickName",label:"\u7528\u6237\u6635\u79F0",rules:[{required:!0}]}),e(u,{name:"phoneNumber",label:"\u624B\u673A\u53F7\u7801"}),e(u,{name:"email",label:"\u90AE\u7BB1"}),e(u,{name:"userName",label:"\u7528\u6237\u540D\u79F0",rules:[{required:!0}]}),e(u.Password,{name:"password",label:"\u7528\u6237\u5BC6\u7801",rules:[{required:!0}]}),e(C.Group,{name:"status",label:"\u72B6\u6001"})]})})]})},ae=[G,H,J,K,z,P,F],se=()=>{const t=W(),a=X(),r=a>0?{deptId:a}:{};return e(O,{rowKey:"userId",actionRef:t,columns:ae,params:r,search:{span:{xs:24,sm:24,md:12,lg:12,xl:12,xxl:6}},request:(...s)=>ee(k(...s)),toolbar:{actions:[e(te,{},"ButtonAdd")]}})},re=()=>{const[t,a]=x.exports.useState(""),r=Y(),{data:s,loading:o}=$(()=>L({deptName:t}),{refreshDeps:[t]});return s?l(M,{spinning:o,children:[e(j.Search,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",className:"mb-3",onSearch:n=>{a(n)}}),e(q,{treeData:s,defaultExpandAll:!0,fieldNames:{title:"label",key:"id"},onSelect:(n,{node:{key:c}})=>{r(c)}})]}):e(V,{})},ge=()=>e(N,{children:l(m,{ghost:!0,gutter:24,children:[e(m,{colSpan:"300px",className:"h-full",children:e(re,{})}),e(m,{ghost:!0,className:"h-full",children:e(se,{})})]})});export{ge as default};
