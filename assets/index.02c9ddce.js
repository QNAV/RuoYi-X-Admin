import{i as j}from"./index.2df64043.js";import{Q as z,_ as c,U as d,V as D,W as _,r as C,X as O,j as a,d as n,Y as U,Z as R,$ as W,o as B,a0 as q,a1 as G,J as $,u as Q,a2 as K,b as J,F as N,a3 as F,a4 as V,a5 as T,a6 as H,a7 as X,a8 as Y,a9 as Z,aa as ee,ab as te,ac as ae,ad as ie,ae as re,af as ne,ag as oe,ah as k}from"./index.7c81fac9.js";import{u as se}from"./useRequest.fbda2368.js";import"./useQuery.esm.c8244a57.js";import"./utils.esm.0bacd143.js";var ue=function(t){var u;return u={},d(u,t.componentCls,{display:"flex",width:"100%",height:"100%",backgroundSize:"contain","&-notice":{display:"flex",flex:"1",alignItems:"flex-end","&-activity":{marginBlock:24,marginInline:24,paddingInline:24,paddingBlock:24,"&-title":{fontWeight:"500",fontSize:"28px"},"&-subTitle":{marginBlockStart:8,fontSize:"16px"},"&-action":{marginBlockStart:"24px"}}},"&-container":{display:"flex",flex:"1",flexDirection:"column",maxWidth:"550px",height:"100%",paddingInline:0,paddingBlock:32,overflow:"auto",background:t.colorBgContainer},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",tinsetBlockStartop:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:t.colorTextSecondary,fontSize:t.fontSize},"&-main":{width:"328px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),d(u,"@media (max-width: ".concat(t.screenMDMin),d({},t.componentCls,{flexDirection:"column-reverse",background:"none !important","&-notice":{display:"flex",flex:"none",alignItems:"flex-start",width:"100%","> div":{width:"100%"}}})),d(u,"@media (min-width: ".concat(t.screenMDMin),d({},t.componentCls,{"&-container":{paddingInline:0,paddingBlockStart:128,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}})),d(u,"@media (max-width: ".concat(t.screenSM),d({},t.componentCls,{"&-main":{width:"95%",maxWidth:"328px"}})),u};function le(e){return z("LoginForm",function(t){var u=c(c({},t),{},{componentCls:".".concat(e)});return[ue(u)]})}var ce=["logo","message","style","activityConfig","backgroundImageUrl","title","subTitle","actions","children"];function de(e){var t=e.logo,u=e.message,y=e.style,g=e.activityConfig,i=g===void 0?{}:g,f=e.backgroundImageUrl,m=e.title,x=e.subTitle,b=e.actions,v=e.children,r=D(e,ce),o=_(),l=function(){var h,p;return r.submitter===!1||((h=r.submitter)===null||h===void 0?void 0:h.submitButtonProps)===!1?!1:c({size:"large",style:{width:"100%"}},(p=r.submitter)===null||p===void 0?void 0:p.submitButtonProps)},I=c(c({searchConfig:{submitText:o.getMessage("loginForm.submitText","\u767B\u5F55")},render:function(h,p){return p.pop()}},r.submitter),{},{submitButtonProps:l()}),L=C.exports.useContext(O.ConfigContext),S=L.getPrefixCls("pro-form-login-page"),w=le(S),M=w.wrapSSR,A=w.hashId,s=function(h){return"".concat(S,"-").concat(h," ").concat(A)},P=C.exports.useMemo(function(){return t?typeof t=="string"?a("img",{src:t}):t:null},[t]);return M(n("div",{className:U(S,A),style:c(c({},y),{},{backgroundImage:'url("'.concat(f,'")')}),children:[a("div",{className:s("notice"),children:i&&n("div",{className:s("notice-activity"),style:i.style,children:[i.title&&n("div",{className:s("notice-activity-title"),children:[" ",i.title," "]}),i.subTitle&&n("div",{className:s("notice-activity-subTitle"),children:[" ",i.subTitle," "]}),i.action&&n("div",{className:s("notice-activity-action"),children:[" ",i.action," "]})]})}),n("div",{className:s("container"),children:[n("div",{className:s("top"),children:[m||P?n("div",{className:s("header"),children:[P?a("span",{className:s("logo"),children:P}):null,m?a("span",{className:s("title"),children:m}):null]}):null,x?a("div",{className:s("desc"),children:x}):null]}),n("div",{className:s("main"),children:[n(R,c(c({isKeyPressSubmit:!0},r),{},{submitter:I,children:[u,v]})),b?a("div",{className:s("other"),children:b}):null]})]})]}))}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ge=()=>n("div",{className:"flex flex-col justify-center items-center",children:[a(W,{plain:!0,children:a("span",{className:"text-sm font-normal text-neutral-400",children:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"})}),a("div",{onClick:()=>{B.info("\u656C\u8BF7\u671F\u5F85")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:a(q,{style:{fontSize:"20px",color:"#00ac84"}})})]});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function me(e){return G("/captchaImage",{method:"GET",...e||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const he=[{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"USERNAME"},{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"MOBILE"}],Be=()=>{const[e,t]=C.exports.useState("USERNAME"),u=$(),y=Q(),[g]=K(),{data:i,run:f}=se(me),m=async(r,o)=>{var l;oe(r?k.LOCAL_STORAGE:k.SESSION_STORAGE,`Bearer ${o}`),await u.invalidateQueries(j),y((l=g.get("redirect"))!=null?l:"/")},x=async(r,o)=>{const{token:l}=await re(o);await m(r,l)},b=async(r,o)=>{if(!i){B.error("\u8BF7\u5148\u83B7\u53D6\u56FE\u7247\u9A8C\u8BC1\u7801");return}const{token:l}=await ne({...o,uuid:i.uuid});await m(r,l)},v=async r=>{try{const{autoLogin:o,...l}=r;if(e==="MOBILE"){await x(o,l);return}if(e==="USERNAME"){await b(o,l);return}}catch{e==="USERNAME"&&f()}};return C.exports.useEffect(()=>{g.get("msg")&&B.error(g.get("msg"))},[]),a("div",{className:"h-[100vh]",children:n(de,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Umi",subTitle:"\u82E5\u4F9D\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",actions:a(ge,{}),onFinish:v,children:[a(J,{centered:!0,activeKey:e,onChange:r=>t(r),items:he}),e==="USERNAME"&&n(N,{children:[a(F,{name:"username",fieldProps:{size:"large",prefix:a(V,{})},placeholder:"admin",initialValue:"admin",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),a(F.Password,{name:"password",fieldProps:{size:"large",prefix:a(T,{})},placeholder:"admin123",initialValue:"admin123",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]}),n(H,{children:[a(F,{width:160,name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",fieldProps:{size:"large",prefix:a(X,{})},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}),a("div",{className:"h-[40px] w-[135px] cursor-pointer border border-solid border-gray-300",children:i!=null&&i.img?a(Y,{src:`data:image/png;base64,${i==null?void 0:i.img}`,preview:!1,height:40,width:135,alt:"\u56FE\u7247\u9A8C\u8BC1\u7801",onClick:f}):a(Z.Button,{active:!0,block:!0,size:"large"})})]})]}),e==="MOBILE"&&n(N,{children:[a(F,{fieldProps:{maxLength:11,size:"large",prefix:a(ee,{})},name:"phoneNumber",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{pattern:te,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),a(ae,{fieldProps:{size:"large",prefix:a(T,{})},captchaProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:(r,o)=>r?`${o} \u83B7\u53D6\u9A8C\u8BC1\u7801`:"\u83B7\u53D6\u9A8C\u8BC1\u7801",name:"smsCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],onGetCaptcha:async()=>(B.info("\u656C\u8BF7\u671F\u5F85"),Promise.reject(new Error("\u656C\u8BF7\u671F\u5F85")))})]}),a(ie,{name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"})]})})};export{Be as default};
