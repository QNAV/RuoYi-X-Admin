import{r as o,A as O,_ as i,c as U,e as I,F as Z,a as A,b as R,d as c,j as a,I as ee,f as te,g as D,h as B,P as G,i as H,C as ae,u as re,k,l as ie,m as ne,n as oe,o as se,p as j,D as ce,q as V,s as le,U as ue,t as de,v as he,S as me,w as $,x as q,y as ge,z as pe,E as fe,T as ve,G as be,H as W}from"./index-cde0b745.js";import{P as L}from"./index-30f4d2f6.js";import{u as ye}from"./useRequest-41b27702.js";var xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const Ce=xe;var _=function(t,r){return o.createElement(O,i(i({},t),{},{ref:r,icon:Ce}))};_.displayName="LockOutlined";const J=o.forwardRef(_);var Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"};const Pe=Se;var K=function(t,r){return o.createElement(O,i(i({},t),{},{ref:r,icon:Pe}))};K.displayName="MobileOutlined";const we=o.forwardRef(K);var Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zm-405.8-201c-3-4.1-7.8-6.6-13-6.6H336c-6.5 0-10.3 7.4-6.5 12.7l126.4 174a16.1 16.1 0 0026 0l212.6-292.7c3.8-5.3 0-12.7-6.5-12.7h-55.2c-5.1 0-10 2.5-13 6.6L468.9 542.4l-64.7-89.1z"}}]},name:"safety-certificate",theme:"outlined"};const ke=Te;var Q=function(t,r){return o.createElement(O,i(i({},t),{},{ref:r,icon:ke}))};Q.displayName="SafetyCertificateOutlined";const Fe=o.forwardRef(Q);var Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690.1 377.4c5.9 0 11.8.2 17.6.5-24.4-128.7-158.3-227.1-319.9-227.1C209 150.8 64 271.4 64 420.2c0 81.1 43.6 154.2 111.9 203.6a21.5 21.5 0 019.1 17.6c0 2.4-.5 4.6-1.1 6.9-5.5 20.3-14.2 52.8-14.6 54.3-.7 2.6-1.7 5.2-1.7 7.9 0 5.9 4.8 10.8 10.8 10.8 2.3 0 4.2-.9 6.2-2l70.9-40.9c5.3-3.1 11-5 17.2-5 3.2 0 6.4.5 9.5 1.4 33.1 9.5 68.8 14.8 105.7 14.8 6 0 11.9-.1 17.8-.4-7.1-21-10.9-43.1-10.9-66 0-135.8 132.2-245.8 295.3-245.8zm-194.3-86.5c23.8 0 43.2 19.3 43.2 43.1s-19.3 43.1-43.2 43.1c-23.8 0-43.2-19.3-43.2-43.1s19.4-43.1 43.2-43.1zm-215.9 86.2c-23.8 0-43.2-19.3-43.2-43.1s19.3-43.1 43.2-43.1 43.2 19.3 43.2 43.1-19.4 43.1-43.2 43.1zm586.8 415.6c56.9-41.2 93.2-102 93.2-169.7 0-124-120.8-224.5-269.9-224.5-149 0-269.9 100.5-269.9 224.5S540.9 847.5 690 847.5c30.8 0 60.6-4.4 88.1-12.3 2.6-.8 5.2-1.2 7.9-1.2 5.2 0 9.9 1.6 14.3 4.1l59.1 34c1.7 1 3.3 1.7 5.2 1.7a9 9 0 006.4-2.6 9 9 0 002.6-6.4c0-2.2-.9-4.4-1.4-6.6-.3-1.2-7.6-28.3-12.2-45.3-.5-1.9-.9-3.8-.9-5.7.1-5.9 3.1-11.2 7.6-14.5zM600.2 587.2c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9c0 19.8-16.2 35.9-36 35.9zm179.9 0c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9a36.08 36.08 0 01-36 35.9z"}}]},name:"wechat",theme:"outlined"};const Me=Ee;var X=function(t,r){return o.createElement(O,i(i({},t),{},{ref:r,icon:Me}))};X.displayName="WechatOutlined";const Ne=o.forwardRef(X);var Be=["rules","name","phoneName","fieldProps","captchaTextRender","captchaProps"],Le=I.forwardRef(function(e,t){var r=Z.useFormInstance(),v=o.useState(e.countDown||60),g=A(v,2),n=g[0],b=g[1],C=o.useState(!1),T=A(C,2),y=T[0],S=T[1],P=o.useState(),d=A(P,2),m=d[0],p=d[1];e.rules,e.name;var E=e.phoneName,w=e.fieldProps,M=e.captchaTextRender,z=M===void 0?function(h,s){return h?"".concat(s," 秒后重新获取"):"获取验证码"}:M,N=e.captchaProps,l=R(e,Be),F=function(){var h=D(B().mark(function s(f){return B().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,p(!0),x.next=4,l.onGetCaptcha(f);case 4:p(!1),S(!0),x.next=13;break;case 8:x.prev=8,x.t0=x.catch(0),S(!1),p(!1),console.log(x.t0);case 13:case"end":return x.stop()}},s,null,[[0,8]])}));return function(f){return h.apply(this,arguments)}}();return o.useImperativeHandle(t,function(){return{startTiming:function(){return S(!0)},endTiming:function(){return S(!1)}}}),o.useEffect(function(){var h=0,s=e.countDown;return y&&(h=window.setInterval(function(){b(function(f){return f<=1?(S(!1),clearInterval(h),s||60):f-1})},1e3)),function(){return clearInterval(h)}},[y]),c("div",{style:i(i({},w==null?void 0:w.style),{},{display:"flex",alignItems:"center"}),ref:t,children:[a(ee,i(i({},w),{},{style:{flex:1,transition:"width .3s",marginRight:8}})),a(te,i(i({style:{display:"block"},disabled:y,loading:m},N),{},{onClick:D(B().mark(function h(){var s;return B().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,!E){u.next=9;break}return u.next=4,r.validateFields([E].flat(1));case 4:return s=r.getFieldValue([E].flat(1)),u.next=7,F(s);case 7:u.next=11;break;case 9:return u.next=11,F("");case 11:u.next=16;break;case 13:u.prev=13,u.t0=u.catch(0),console.log(u.t0);case 16:case"end":return u.stop()}},h,null,[[0,13]])})),children:z(y,n)}))]})}),Oe=U(Le);const ze=Oe;var Ae=["options","fieldProps","proFieldProps","valueEnum"],Ie=I.forwardRef(function(e,t){var r=e.options,v=e.fieldProps,g=e.proFieldProps,n=e.valueEnum,b=R(e,Ae);return a(G,i({ref:t,valueType:"checkbox",valueEnum:H(n,void 0),fieldProps:i({options:r},v),lightProps:i({labelFormatter:function(){return a(G,i({ref:t,valueType:"checkbox",mode:"read",valueEnum:H(n,void 0),filedConfig:{customLightMode:!0},fieldProps:i({options:r},v),proFieldProps:g},b))}},b.lightProps),proFieldProps:g},b))}),Re=I.forwardRef(function(e,t){var r=e.fieldProps,v=e.children;return a(ae,i(i({ref:t},r),{},{children:v}))}),je=U(Re,{valuePropName:"checked"}),Y=je;Y.Group=Ie;const $e=Y;var De=function(t){var r;return r={},k(r,t.componentCls,{display:"flex",width:"100%",height:"100%",backgroundSize:"contain","&-notice":{display:"flex",flex:"1",alignItems:"flex-end","&-activity":{marginBlock:24,marginInline:24,paddingInline:24,paddingBlock:24,"&-title":{fontWeight:"500",fontSize:"28px"},"&-subTitle":{marginBlockStart:8,fontSize:"16px"},"&-action":{marginBlockStart:"24px"}}},"&-container":{display:"flex",flex:"1",flexDirection:"column",maxWidth:"550px",height:"100%",paddingInline:0,paddingBlock:32,overflow:"auto",background:t.colorBgContainer},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",tinsetBlockStartop:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:t.colorTextSecondary,fontSize:t.fontSize},"&-main":{width:"328px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),k(r,"@media (max-width: ".concat(t.screenMDMin,"px)"),k({},t.componentCls,{flexDirection:"column-reverse",background:"none !important","&-notice":{display:"flex",flex:"none",alignItems:"flex-start",width:"100%","> div":{width:"100%"}}})),k(r,"@media (min-width: ".concat(t.screenMDMin,"px)"),k({},t.componentCls,{"&-container":{paddingInline:0,paddingBlockStart:128,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}})),k(r,"@media (max-width: ".concat(t.screenSM,"px)"),k({},t.componentCls,{"&-main":{width:"95%",maxWidth:"328px"}})),r};function Ge(e){return re("LoginFormPage",function(t){var r=i(i({},t),{},{componentCls:".".concat(e)});return[De(r)]})}var He=["logo","message","style","activityConfig","backgroundImageUrl","title","subTitle","actions","children"];function We(e){var t=e.logo,r=e.message,v=e.style,g=e.activityConfig,n=g===void 0?{}:g,b=e.backgroundImageUrl,C=e.title,T=e.subTitle,y=e.actions,S=e.children,P=R(e,He),d=ie(),m=function(){var s,f;return P.submitter===!1||((s=P.submitter)===null||s===void 0?void 0:s.submitButtonProps)===!1?!1:i({size:"large",style:{width:"100%"}},(f=P.submitter)===null||f===void 0?void 0:f.submitButtonProps)},p=i(i({searchConfig:{submitText:d.getMessage("loginForm.submitText","登录")},render:function(s,f){return f.pop()}},P.submitter),{},{submitButtonProps:m()}),E=o.useContext(ne.ConfigContext),w=E.getPrefixCls("pro-form-login-page"),M=Ge(w),z=M.wrapSSR,N=M.hashId,l=function(s){return"".concat(w,"-").concat(s," ").concat(N)},F=o.useMemo(function(){return t?typeof t=="string"?a("img",{src:t}):t:null},[t]);return z(c("div",{className:oe(w,N),style:i(i({},v),{},{backgroundImage:'url("'.concat(b,'")')}),children:[a("div",{className:l("notice"),children:n&&c("div",{className:l("notice-activity"),style:n.style,children:[n.title&&c("div",{className:l("notice-activity-title"),children:[" ",n.title," "]}),n.subTitle&&c("div",{className:l("notice-activity-subTitle"),children:[" ",n.subTitle," "]}),n.action&&c("div",{className:l("notice-activity-action"),children:[" ",n.action," "]})]})}),c("div",{className:l("container"),children:[c("div",{className:l("top"),children:[C||F?c("div",{className:l("header"),children:[F?a("span",{className:l("logo"),children:F}):null,C?a("span",{className:l("title"),children:C}):null]}):null,T?a("div",{className:l("desc"),children:T}):null]}),c("div",{className:l("main"),children:[c(se,i(i({isKeyPressSubmit:!0},P),{},{submitter:p,children:[r,S]})),y?a("div",{className:l("other"),children:y}):null]})]})]}))}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ue=()=>{const{message:e}=j.useApp();return c("div",{className:"flex flex-col justify-center items-center",children:[a(ce,{plain:!0,children:a("span",{className:"text-sm font-normal text-neutral-400",children:"其他登录方式"})}),a("div",{onClick:()=>{e.info("敬请期待")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:a(Ne,{style:{fontSize:"20px",color:"#00ac84"}})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ve=()=>{const{message:e}=j.useApp();return c(V,{children:[a(L,{fieldProps:{maxLength:11,size:"large",prefix:a(we,{})},name:"phoneNumber",placeholder:"请输入手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:le,message:"手机号格式错误"}]}),a(ze,{fieldProps:{size:"large",prefix:a(J,{})},captchaProps:{size:"large"},placeholder:"请输入验证码",captchaTextRender:(t,r)=>t?`${r} 获取验证码`:"获取验证码",name:"smsCode",rules:[{required:!0,message:"请输入验证码"}],onGetCaptcha:async()=>(e.info("敬请期待"),Promise.reject(new Error("敬请期待")))})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const qe=({captchaImageSrc:e,onCaptchaImageClick:t})=>c(V,{children:[a(L,{name:"username",fieldProps:{size:"large",prefix:a(ue,{})},placeholder:"admin",initialValue:"admin",rules:[{required:!0,message:"请输入用户名"}]}),a(L.Password,{name:"password",fieldProps:{size:"large",prefix:a(J,{})},placeholder:"admin123",initialValue:"admin123",rules:[{required:!0,message:"请输入密码"}]}),c(de,{children:[a(L,{width:160,name:"code",placeholder:"请输入验证码",fieldProps:{size:"large",prefix:a(Fe,{})},rules:[{required:!0,message:"请输入验证码"}]}),a("div",{className:"h-[40px] w-[135px] rounded-md cursor-pointer border border-solid border-gray-300",children:e?a(he,{src:`data:image/png;base64,${e}`,preview:!1,height:40,width:135,alt:"图片验证码",onClick:t,className:"rounded-md"}):a(me.Button,{active:!0,block:!0,size:"large"})})]})]});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const _e=(e={})=>$({path:"/captchaImage",method:"GET",secure:!0,skipErrorHandler:!1,...e});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Je=(e,t={})=>$({path:"/login",method:"POST",body:e,secure:!0,type:q.Json,skipErrorHandler:!1,...t});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ke=(e,t={})=>$({path:"/smsLogin",method:"POST",body:e,secure:!0,type:q.Json,skipErrorHandler:!1,...t});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ze=()=>{const[e,t]=o.useState("USERNAME"),r=ge(),v=pe(),[g]=fe(),{data:n,run:b}=ye(()=>_e({secure:!1})),C=async(d,m)=>{be(d?W.LOCAL_STORAGE:W.SESSION_STORAGE,`Bearer ${m}`),await r(),v(g.get("redirect")??"/")},T=async(d,m)=>{const{token:p}=await Ke(m);await C(d,p)},{message:y}=j.useApp(),S=async(d,m)=>{if(!n){y.error("请先获取图片验证码");return}const{token:p}=await Je({...m,uuid:n.uuid},{secure:!1});await C(d,p)},P=async d=>{try{const{autoLogin:m,...p}=d;if(e==="MOBILE"){await T(m,p);return}if(e==="USERNAME"){await S(m,p);return}}catch{e==="USERNAME"&&b()}};return o.useEffect(()=>{g.get("msg")&&y.error(g.get("msg"))},[]),a("div",{className:"h-[100vh]",children:c(We,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Admin",subTitle:"若依后台管理系统",actions:a(Ue,{}),onFinish:P,children:[a(ve,{centered:!0,activeKey:e,onChange:d=>t(d),items:[{label:"账号密码登录",key:"USERNAME"},{label:"手机号登录",key:"MOBILE"}]}),e==="USERNAME"&&a(qe,{captchaImageSrc:n==null?void 0:n.img,onCaptchaImageClick:b}),e==="MOBILE"&&a(Ve,{}),a($e,{name:"autoLogin",children:"自动登录"})]})})};export{Ze as default};
