import{R as h,g as f,h as D,aE as b,r as y,aC as F,j as c,a as e,at as I,b6 as N,b7 as T,aA as C,aG as o,b8 as P,aW as B,bc as R,bF as g,bh as k,b1 as d}from"./index.09ee3745.js";import{B as E}from"./index.980e3ce6.js";import{C as v,b as U}from"./common.bea7ffe6.js";import{A as _}from"./index.e85082c4.js";import{c as q}from"./keepAlive.de4e3c4f.js";import{u as w,c as M}from"./useInitActionType.d9e65486.js";import{u as j}from"./index.969f6f1b.js";import{u as O}from"./useMutation.esm.fb7f9f1a.js";import{E as W}from"./index.9cb23666.js";import{a as L}from"./SysDeptService.d9c16612.js";import{u as V}from"./useRequest.26bd0b4d.js";import"./utils.esm.f73db980.js";const G={dataIndex:"userId",key:"userId",title:"\u7528\u6237\u7F16\u53F7",valueType:"text",editable:!1,hideInSearch:!0},$={dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},K={dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},z={dataIndex:["dept","deptName"],key:"deptDeptName",title:"\u90E8\u95E8\u540D\u79F0",valueType:"text",hideInSearch:!0},H={dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text"},x="systemUser",S=h({key:`${x}AtomMainTableActions`,default:void 0}),J=()=>f(S),Q=()=>w(S),A=h({key:`${x}AtomSelectedDeptId`,default:0}),X=()=>f(A),Y=()=>D(A);async function Z(t,a){return b("/system/user/add",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...a||{}})}async function ee(t,a){return b("/system/user/list",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...a||{}})}const te=()=>{const t=q(),[a,{toggle:u}]=j(),s=y.exports.useRef(),r=J(),{isLoading:n,mutate:i}=O(async()=>{var l,p;const m=await((p=(l=s.current)==null?void 0:l.validateFieldsReturnFormatValue)==null?void 0:p.call(l));!m||await Z(m)},{onSuccess:()=>{r==null||r.reload(),F.success("\u6DFB\u52A0\u6210\u529F")}});return c(_,{accessible:t.canAddSysUser,children:[e(I,{type:"primary",icon:e(N,{}),onClick:u,children:"\u65B0\u589E"}),e(T,{title:"\u6DFB\u52A0\u7528\u6237",open:a,onCancel:u,confirmLoading:n,okText:"\u63D0\u4EA4",onOk:()=>i(),children:c(C,{submitter:!1,formRef:s,grid:!0,colProps:{span:12},children:[e(o,{name:"nickName",label:"\u7528\u6237\u6635\u79F0",rules:[{required:!0}]}),e(o,{name:"phoneNumber",label:"\u624B\u673A\u53F7\u7801"}),e(o,{name:"email",label:"\u90AE\u7BB1"}),e(o,{name:"userName",label:"\u7528\u6237\u540D\u79F0",rules:[{required:!0}]}),e(o.Password,{name:"password",label:"\u7528\u6237\u5BC6\u7801",rules:[{required:!0}]}),e(P.Group,{name:"status",label:"\u72B6\u6001"})]})})]})},ae=[G,$,K,z,H,v,U],se=()=>{const t=Q(),a=X(),u=a>0?{deptId:a}:{};return e(B,{rowKey:"userId",actionRef:t,columns:ae,params:u,search:{span:{xs:24,sm:24,md:12,lg:12,xl:12,xxl:6}},request:(...s)=>ee(M(...s)),toolbar:{actions:[e(te,{},"ButtonAdd")]}})},ue=()=>{const[t,a]=y.exports.useState(""),u=Y(),{data:s,loading:r}=V(()=>L({deptName:t}),{refreshDeps:[t]});return s?c(R,{spinning:r,children:[e(g.Search,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",className:"mb-3",onSearch:n=>{a(n)}}),e(k,{treeData:s,defaultExpandAll:!0,fieldNames:{title:"label",key:"id"},onSelect:(n,{node:{key:i}})=>{u(i)}})]}):e(W,{})},ye=()=>e(E,{children:c(d,{ghost:!0,gutter:24,children:[e(d,{colSpan:"300px",className:"h-full",children:e(ue,{})}),e(d,{ghost:!0,className:"h-full",children:e(se,{})})]})});export{ye as default};
