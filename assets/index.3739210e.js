import{B as A}from"./index.eb120d2a.js";import{C as D,b as F}from"./common.46d7ac24.js";import{u as I,A as N,P}from"./useAccess.7af1ee4e.js";import{H as f,Q as h,U as C,aD as y,r as S,aF as B,g as c,j as e,aE as g,cS as k,b2 as R,cz as o,cT as E,a9 as U,aG as v}from"./index.c976b094.js";import"./keepAlive.11df527b.js";import{u as M,c as _}from"./useInitActionType.f1c521c1.js";import{u as q}from"./index.539da0e1.js";import{u as w}from"./useMutation.3b2eedd2.js";import{M as j,T as O}from"./Tree.54cd2242.js";import{P as L}from"./Table.30ea2dcc.js";import{E as V}from"./index.54bcd269.js";import{a as G}from"./SysDeptService.a50e3c01.js";import{P as d}from"./index.96e9a429.js";import"./RouteContext.f7a35dfd.js";import"./index.e42002a8.js";import"./index.95af870d.js";import"./unstated-next.e785c29e.js";const $={dataIndex:"userId",key:"userId",title:"\u7528\u6237\u7F16\u53F7",valueType:"text",editable:!1,hideInSearch:!0},z={dataIndex:"userName",key:"userName",title:"\u7528\u6237\u540D\u79F0",valueType:"text"},H={dataIndex:"nickName",key:"nickName",title:"\u7528\u6237\u6635\u79F0",valueType:"text",hideInSearch:!0},K={dataIndex:["dept","deptName"],key:"deptDeptName",title:"\u90E8\u95E8\u540D\u79F0",valueType:"text",hideInSearch:!0},Q={dataIndex:"phoneNumber",key:"phoneNumber",title:"\u624B\u673A\u53F7\u7801",valueType:"text"},x="systemUser",b=f({key:`${x}AtomMainTableActions`,default:void 0}),J=()=>h(b),W=()=>M(b),T=f({key:`${x}AtomSelectedDeptId`,default:0}),X=()=>h(T),Y=()=>C(T);async function Z(t,a){return y("/system/user/add",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...a||{}})}async function ee(t,a){return y("/system/user/list",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...a||{}})}const te=()=>{const t=I(),[a,{toggle:r}]=q(),s=S.exports.useRef(),u=J(),{isLoading:n,mutate:i}=w(async()=>{var l,p;const m=await((p=(l=s.current)==null?void 0:l.validateFieldsReturnFormatValue)==null?void 0:p.call(l));!m||await Z(m)},{onSuccess:()=>{u==null||u.reload(),B.success("\u6DFB\u52A0\u6210\u529F")}});return c(N,{accessible:t.canAddSysUser,children:[e(g,{type:"primary",icon:e(k,{}),onClick:r,children:"\u65B0\u589E"}),e(j,{title:"\u6DFB\u52A0\u7528\u6237",open:a,onCancel:r,confirmLoading:n,okText:"\u63D0\u4EA4",onOk:()=>i(),children:c(R,{submitter:!1,formRef:s,grid:!0,colProps:{span:12},children:[e(o,{name:"nickName",label:"\u7528\u6237\u6635\u79F0",rules:[{required:!0}]}),e(o,{name:"phoneNumber",label:"\u624B\u673A\u53F7\u7801"}),e(o,{name:"email",label:"\u90AE\u7BB1"}),e(o,{name:"userName",label:"\u7528\u6237\u540D\u79F0",rules:[{required:!0}]}),e(o.Password,{name:"password",label:"\u7528\u6237\u5BC6\u7801",rules:[{required:!0}]}),e(P.Group,{name:"status",label:"\u72B6\u6001"})]})})]})},ae=[$,z,H,K,Q,D,F],se=()=>{const t=W(),a=X(),r=a>0?{deptId:a}:{};return e(L,{rowKey:"userId",actionRef:t,columns:ae,params:r,search:{span:{xs:24,sm:24,md:12,lg:12,xl:12,xxl:6}},request:(...s)=>ee(_(...s)),toolbar:{actions:[e(te,{},"ButtonAdd")]}})},re=()=>{const[t,a]=S.exports.useState(""),r=Y(),{data:s,loading:u}=E(()=>G({deptName:t}),{refreshDeps:[t]});return s?c(U,{spinning:u,children:[e(v.Search,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",className:"mb-3",onSearch:n=>{a(n)}}),e(O,{treeData:s,defaultExpandAll:!0,fieldNames:{title:"label",key:"id"},onSelect:(n,{node:{key:i}})=>{r(i)}})]}):e(V,{})},De=()=>e(A,{children:c(d,{ghost:!0,gutter:24,children:[e(d,{colSpan:"300px",className:"h-full",children:e(re,{})}),e(d,{ghost:!0,className:"h-full",children:e(se,{})})]})});export{De as default};
