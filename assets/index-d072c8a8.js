import{j as o}from"./antdProComponents-1965180d.js";import{e as y,f as T,h as j,A as i,j as I,k as v,l as f,B as k,d as b,m as A,i as C,p as S,q as B}from"./index-2c084e82.js";import{m as R,n as M,o as O,p as E}from"./Monitor-41d22689.js";import{be as l,B as P,at as w,r as L}from"./antd-6bc2bb7d.js";import{u}from"./useMutation-f0283657.js";import"./iconPark-3c306205.js";import"./wangEditor-f607bedb.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const h=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/operlog/model/index.ts/atomMainTableActions",y(void 0));h.debugLabel="atomMainTableActions";const d=()=>j(h),q=()=>T(h);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const D=()=>{const e=d(),{message:t,modal:r}=l.useApp(),{mutate:a,isLoading:c}=u(R,{onSuccess:()=>{var s;(s=e==null?void 0:e.reloadAndRest)==null||s.call(e),e==null||e.reload(),t.success("清空成功")}}),n=()=>{r.confirm({title:"操作确认",content:"确认清空操作日志吗？",okButtonProps:{loading:c},onOk:()=>a({})})};return o.jsx(i,{accessKey:"monitor:operlog:remove",children:o.jsx(P,{danger:!0,icon:o.jsx(w,{}),onClick:n,children:"清空"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const K=async e=>{const{data:t}=await M(e,{format:"blob"});await v(t,`operlog_${new Date().getTime()}.xlsx`)},U=({searchParams:e})=>{const{message:t}=l.useApp(),{isLoading:r,mutate:a}=u(K,{onSuccess:()=>{t.success("导出成功")}});return o.jsx(i,{accessKey:"monitor:operlog:export",children:o.jsx(I,{loading:r,onClick:()=>a(e)})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const m=({operIds:e,disabled:t=!1,batch:r=!1})=>{const a=d(),{message:c,modal:n}=l.useApp(),{mutate:s,isLoading:g}=u(O,{onSuccess:()=>{var p;(p=a==null?void 0:a.clearSelected)==null||p.call(a),a==null||a.reload(),c.success("删除成功")}}),x=()=>{n.confirm({title:"操作确认",content:`确定删除日志编号为 ${e.join(",")} 的操作日志吗?`,okButtonProps:{loading:g},onOk:()=>s({operIds:e})})};return o.jsx(i,{accessKey:"monitor:operlog:remove",children:o.jsx(f,{disabled:t,batch:r,onClick:x})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const N=()=>{const{valueEnumSysOperStatus:e}=S(),{valueEnumSysOperType:t}=B();return[{title:"日志编号",dataIndex:"operId",key:"operId",valueType:"text",hideInSearch:!0},{title:"系统模块",dataIndex:"title",key:"title",valueType:"text"},{title:"操作类型",dataIndex:"businessType",key:"businessType",valueType:"select",valueEnum:t},{title:"请求方式",dataIndex:"requestMethod",key:"requestMethod",valueType:"text",hideInSearch:!0},{title:"操作人员",dataIndex:"operName",key:"operName",valueType:"text"},{title:"操作地址",dataIndex:"operIp",key:"operIp",valueType:"text",hideInSearch:!0},{title:"操作地点",dataIndex:"operLocation",key:"operLocation",valueType:"text",hideInSearch:!0},{title:"操作状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:e},{title:"操作时间",dataIndex:"operTime",key:"operTime",valueType:"dateTime",hideInSearch:!0},{title:"操作时间",dataIndex:"dateTimeRange",key:"dateTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",dataIndex:"option",key:"option",valueType:"option",fixed:"right",render:(r,a)=>o.jsx(m,{operIds:[a.operId]})}]},Q=({selectedRowKeys:e})=>o.jsx(m,{batch:!0,disabled:e.length===0,operIds:e}),z=()=>{const e=q(),t=N(),[r,a]=L.useState({});return o.jsx(k,{children:o.jsx(b,{rowKey:"operId",actionRef:e,columns:t,request:async(...c)=>{const{dateTimeRange:n,...s}=A(...c);return C(n)&&(s.beginTime=n[0],s.endTime=n[1]),a(s),await E(s)},toolbar:{actions:[o.jsx(D,{},"ButtonCleanUp"),o.jsx(U,{searchParams:r},"ButtonExport")]},tableAlertOptionRender:Q})})};export{z as default};
