import{b as M,c as z,i as D}from"./index.ce26b53e.js";import{Q as _,_ as l,U as d,V as O,W as R,r as F,X as U,j as a,e as r,Y as q,Z as W,$ as G,q as B,a0 as $,F as N,a1 as C,a2 as Q,a3 as K,a4 as V,a5 as k,a6 as H,a7 as J,a8 as X,a9 as Y,aa as Z,w as ee,n as te,u as ae,ab as ie,c as re,ac as ne,ad as oe,ae as E}from"./index.f558e200.js";import{u as se}from"./useRequest.898a377e.js";import"./useQuery.esm.0df65878.js";import"./utils.esm.a17b781a.js";var ue=function(t){var s;return s={},d(s,t.componentCls,{display:"flex",width:"100%",height:"100%",backgroundSize:"contain","&-notice":{display:"flex",flex:"1",alignItems:"flex-end","&-activity":{marginBlock:24,marginInline:24,paddingInline:24,paddingBlock:24,"&-title":{fontWeight:"500",fontSize:"28px"},"&-subTitle":{marginBlockStart:8,fontSize:"16px"},"&-action":{marginBlockStart:"24px"}}},"&-container":{display:"flex",flex:"1",flexDirection:"column",maxWidth:"550px",height:"100%",paddingInline:0,paddingBlock:32,overflow:"auto",background:t.colorBgContainer},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",tinsetBlockStartop:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:t.colorTextSecondary,fontSize:t.fontSize},"&-main":{width:"328px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),d(s,"@media (max-width: ".concat(t.screenMDMin),d({},t.componentCls,{flexDirection:"column-reverse",background:"none !important","&-notice":{display:"flex",flex:"none",alignItems:"flex-start",width:"100%","> div":{width:"100%"}}})),d(s,"@media (min-width: ".concat(t.screenMDMin),d({},t.componentCls,{"&-container":{paddingInline:0,paddingBlockStart:128,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}})),d(s,"@media (max-width: ".concat(t.screenSM),d({},t.componentCls,{"&-main":{width:"95%",maxWidth:"328px"}})),s};function ce(e){return _("LoginFormPage",function(t){var s=l(l({},t),{},{componentCls:".".concat(e)});return[ue(s)]})}var le=["logo","message","style","activityConfig","backgroundImageUrl","title","subTitle","actions","children"];function de(e){var t=e.logo,s=e.message,y=e.style,g=e.activityConfig,n=g===void 0?{}:g,f=e.backgroundImageUrl,h=e.title,x=e.subTitle,b=e.actions,v=e.children,i=O(e,le),u=R(),c=function(){var m,p;return i.submitter===!1||((m=i.submitter)===null||m===void 0?void 0:m.submitButtonProps)===!1?!1:l({size:"large",style:{width:"100%"}},(p=i.submitter)===null||p===void 0?void 0:p.submitButtonProps)},I=l(l({searchConfig:{submitText:u.getMessage("loginForm.submitText","\u767B\u5F55")},render:function(m,p){return p.pop()}},i.submitter),{},{submitButtonProps:c()}),j=F.exports.useContext(U.ConfigContext),S=j.getPrefixCls("pro-form-login-page"),w=ce(S),L=w.wrapSSR,P=w.hashId,o=function(m){return"".concat(S,"-").concat(m," ").concat(P)},A=F.exports.useMemo(function(){return t?typeof t=="string"?a("img",{src:t}):t:null},[t]);return L(r("div",{className:q(S,P),style:l(l({},y),{},{backgroundImage:'url("'.concat(f,'")')}),children:[a("div",{className:o("notice"),children:n&&r("div",{className:o("notice-activity"),style:n.style,children:[n.title&&r("div",{className:o("notice-activity-title"),children:[" ",n.title," "]}),n.subTitle&&r("div",{className:o("notice-activity-subTitle"),children:[" ",n.subTitle," "]}),n.action&&r("div",{className:o("notice-activity-action"),children:[" ",n.action," "]})]})}),r("div",{className:o("container"),children:[r("div",{className:o("top"),children:[h||A?r("div",{className:o("header"),children:[A?a("span",{className:o("logo"),children:A}):null,h?a("span",{className:o("title"),children:h}):null]}):null,x?a("div",{className:o("desc"),children:x}):null]}),r("div",{className:o("main"),children:[r(W,l(l({isKeyPressSubmit:!0},i),{},{submitter:I,children:[s,v]})),b?a("div",{className:o("other"),children:b}):null]})]})]}))}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ge=()=>r("div",{className:"flex flex-col justify-center items-center",children:[a(G,{plain:!0,children:a("span",{className:"text-sm font-normal text-neutral-400",children:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"})}),a("div",{onClick:()=>{B.info("\u656C\u8BF7\u671F\u5F85")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:a($,{style:{fontSize:"20px",color:"#00ac84"}})})]});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const he=()=>r(N,{children:[a(C,{fieldProps:{maxLength:11,size:"large",prefix:a(Q,{})},name:"phoneNumber",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{pattern:K,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),a(V,{fieldProps:{size:"large",prefix:a(k,{})},captchaProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:(e,t)=>e?`${t} \u83B7\u53D6\u9A8C\u8BC1\u7801`:"\u83B7\u53D6\u9A8C\u8BC1\u7801",name:"smsCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],onGetCaptcha:async()=>(B.info("\u656C\u8BF7\u671F\u5F85"),Promise.reject(new Error("\u656C\u8BF7\u671F\u5F85")))})]});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const me=({captchaImageSrc:e,onCaptchaImageClick:t})=>r(N,{children:[a(C,{name:"username",fieldProps:{size:"large",prefix:a(H,{})},placeholder:"admin",initialValue:"admin",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),a(C.Password,{name:"password",fieldProps:{size:"large",prefix:a(k,{})},placeholder:"admin123",initialValue:"admin123",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]}),r(J,{children:[a(C,{width:160,name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",fieldProps:{size:"large",prefix:a(X,{})},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}),a("div",{className:"h-[40px] w-[135px] rounded-md cursor-pointer border border-solid border-gray-300",children:e?a(Y,{src:`data:image/png;base64,${e}`,preview:!1,height:40,width:135,alt:"\u56FE\u7247\u9A8C\u8BC1\u7801",onClick:t,className:"rounded-md"}):a(Z.Button,{active:!0,block:!0,size:"large"})})]})]});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};async function pe(e){return ee("/captchaImage",{method:"GET",...e||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Be=()=>{const[e,t]=F.exports.useState("USERNAME"),s=te(),y=ae(),[g]=ie(),{data:n,run:f}=se(pe),h=async(i,u)=>{var c;oe(i?E.LOCAL_STORAGE:E.SESSION_STORAGE,`Bearer ${u}`),await s.invalidateQueries(D),y((c=g.get("redirect"))!=null?c:"/")},x=async(i,u)=>{const{token:c}=await M(u);await h(i,c)},b=async(i,u)=>{if(!n){B.error("\u8BF7\u5148\u83B7\u53D6\u56FE\u7247\u9A8C\u8BC1\u7801");return}const{token:c}=await z({...u,uuid:n.uuid});await h(i,c)},v=async i=>{try{const{autoLogin:u,...c}=i;if(e==="MOBILE"){await x(u,c);return}if(e==="USERNAME"){await b(u,c);return}}catch{e==="USERNAME"&&f()}};return F.exports.useEffect(()=>{g.get("msg")&&B.error(g.get("msg"))},[]),a("div",{className:"h-[100vh]",children:r(de,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Admin",subTitle:"\u82E5\u4F9D\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",actions:a(ge,{}),onFinish:v,children:[a(re,{centered:!0,activeKey:e,onChange:i=>t(i),items:[{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"USERNAME"},{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"MOBILE"}]}),e==="USERNAME"&&a(me,{captchaImageSrc:n==null?void 0:n.img,onCaptchaImageClick:f}),e==="MOBILE"&&a(he,{}),a(ne,{name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"})]})})};export{Be as default};
