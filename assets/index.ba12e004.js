import{q as B,r as D,s as v,t as I,C as _,j as L,b as N}from"./index.5e39d783.js";import{p as j,s as S,R as w,aB as V,j as s,aD as g,al as C,aE as q,b8 as X,a1 as p,o as F,b9 as Y,aJ as W,aF as R,d as h,F as y,aK as G,r as A,Z as H,a3 as E,aG as K,aH as $,aI as J,O as Z,ak as z,ba as Q}from"./index.7c81fac9.js";import{a as U,b as tt}from"./index.85f7a3f8.js";import{b}from"./index.2df64043.js";import{u as P}from"./useMutation.esm.173c6737.js";import{P as et}from"./index.f047b983.js";import{P as st}from"./index.853fa8fc.js";import"./useQuery.esm.c8244a57.js";import"./utils.esm.0bacd143.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const k="systemPost",f=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/post/model/index.ts/AtomMainTableActions",j({key:`${k}AtomMainTableActions`,default:void 0}));f.debugLabel="AtomMainTableActions";const ot=()=>U(f),x=()=>S(f),m=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/post/model/index.ts/AtomAddOrEditModal",j({key:`${k}AtomAddOrEditModal`,default:{open:!1,actionType:"add"}}));m.debugLabel="AtomAddOrEditModal";const at=()=>{const t=w(m);return()=>t({open:!0,actionType:"add"})},ct=()=>{const t=w(m);return e=>t({open:!0,actionType:"edit",record:e})},it=()=>V(m),rt=()=>S(m);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const nt=()=>{const t=b(),e=at();return s(g,{accessible:t.canAddSysPost,children:s(C,{type:"primary",icon:s(q,{}),onClick:e,children:"\u65B0\u5EFA"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ut=({record:t})=>{const e=b(),a=ct();return s(g,{accessible:e.canEditSysPost,children:s(C,{type:"link",icon:s(X,{}),onClick:()=>a(t),children:"\u7F16\u8F91"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};async function dt(t,e){return p("/system/post/add",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function lt(t,e){return p("/system/post/edit",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function ht(t,e){return p("/system/post/export",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function pt(t,e){return p("/system/post/list",{method:"POST",headers:{"Content-Type":"application/json"},data:t,...e||{}})}async function mt(t,e){return p("/system/post/remove",{method:"POST",params:{...t},...e||{}})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const At=({searchParams:t})=>{const e=b(),{isLoading:a,mutate:r}=P(()=>ht(t),{onSuccess:()=>{F.success("\u5BFC\u51FA\u6210\u529F")}});return s(g,{accessible:e.canExportSysPost,children:s(C,{type:"link",icon:s(Y,{}),loading:a,onClick:()=>r(),children:"\u5BFC\u51FA\u5F53\u524D\u5217\u8868"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const O=({postId:t,postName:e,isBatch:a,disabled:r})=>{const l=a?"\u6279\u91CF\u5220\u9664":"\u5220\u9664",d=b(),c=x(),{mutateAsync:i,isLoading:n}=P(async o=>{await mt({postIds:o})},{onSuccess:()=>{var o;c==null||c.reload(),(o=c==null?void 0:c.clearSelected)==null||o.call(c),F.success("\u5220\u9664\u6210\u529F")}}),u=()=>{R.confirm({title:"\u5220\u9664\u5C97\u4F4D",content:h(y,{children:["\u786E\u5B9A\u5220\u9664\u5C97\u4F4D",s(G.Text,{code:!0,children:e}),"\u5417\uFF1F"]}),onOk:async()=>i(t),okButtonProps:{loading:n}})};return s(g,{accessible:d.canRemoveSysPost,children:s(C,{type:"link",danger:!0,disabled:r,icon:s(W,{}),onClick:u,children:l})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const gt=()=>{var u;const t=A.exports.useRef(),{open:e,actionType:a,record:r}=rt(),l=it(),d=x(),c=()=>{var o;l(),(o=t.current)==null||o.resetFields()},{mutate:i,isLoading:n}=P(async()=>{var T;const o=await((T=t.current)==null?void 0:T.validateFields());if(!!o){if(a==="add"){await dt(o);return}await lt({...o,postId:r.postId})}},{onSuccess:()=>{d==null||d.reload(),c(),F.success(a==="add"?"\u65B0\u5EFA\u6210\u529F":"\u4FDD\u5B58\u6210\u529F")}});return A.exports.useEffect(()=>{var o;a==="edit"&&r&&((o=t.current)==null?void 0:o.setFieldsValue)&&t.current.setFieldsValue(r)},[a,(u=t.current)==null?void 0:u.setFieldsValue]),s(R,{open:e,onCancel:c,okText:"\u63D0\u4EA4",okButtonProps:{loading:n},onOk:()=>i(),title:a==="add"?"\u65B0\u5EFA\u5C97\u4F4D":"\u7F16\u8F91\u5C97\u4F4D\u4FE1\u606F",children:h(H,{submitter:!1,formRef:t,children:[s(E,{name:"postName",label:"\u5C97\u4F4D\u540D\u79F0",rules:[{required:!0}]}),s(E,{name:"postCode",label:"\u5C97\u4F4D\u7F16\u7801",rules:[{required:!0}]}),s(et,{name:"postSort",label:"\u663E\u793A\u987A\u5E8F",rules:[{required:!0}],initialValue:0}),s(K.Group,{name:"status",label:"\u72B6\u6001",valueEnum:$,initialValue:J.ENABLE}),s(st,{name:"remark",label:"\u5907\u6CE8"})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ct=[B,D,v,I,_,L,N,{title:"\u64CD\u4F5C",valueType:"option",render:(t,e)=>h(y,{children:[s(ut,{record:e}),s(O,{postId:e.postId,postName:e.postName})]})}],M="postId",St=()=>{const[t,e]=A.exports.useState({}),a=A.exports.useRef(),r=ot(),{rowSelection:l,onClick:d}=tt(M);return h(Z,{children:[s(z,{formRef:a,actionRef:r,rowKey:M,request:async(...i)=>{const n=Q(...i);return e(n),await pt(n)},columns:Ct,toolbar:{actions:[s(nt,{},"ButtonAdd")]},rowSelection:l,onRow:i=>({onClick:()=>d(i)}),tableAlertOptionRender:({selectedRows:i})=>{const n=i.length===0;return h(y,{children:[s(O,{disabled:n,isBatch:!0,postId:i.map(u=>u.postId).join(","),postName:i.map(u=>u.postName).join(",")}),s(At,{searchParams:t})]})}}),s(gt,{})]})};export{St as default};
