import{aZ as b,a2 as d,ao as D,az as i,aC as l,A as w,b as R,p as f,j as x,aG as C,br as m,aB as p,bs as M,bt as L,bu as j}from"./index-8e79839f.js";import{u as O}from"./useMutation-25c2b1ea.js";import{a as h,u as A}from"./utils-8723844a.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const y="systemMenu",r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",h({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));r.debugLabel="atomSelectedMenuData";const T=()=>A(r),X=()=>b(r),Y=()=>d(r),c=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomModalAdd",h(!1));c.debugLabel="atomModalAdd";const v=()=>A(c),B=()=>{const e=D(c);return()=>e(!0)},N=()=>d(c),g=[y,"list"],V=(e={},s)=>i(g,async()=>{const t=await m(e),a=p(t,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:M(a),map:t.reduce((o,n)=>o.set(n.menuId,n),new Map),parentIds:Array.from(t.reduce((o,n)=>o.add(n.parentId),new Set))}},{onSuccess:t=>{s(t.parentIds)}}),P=()=>{const e=l();return()=>e.invalidateQueries(g)},S=[y,"options"],K=()=>i(S,async()=>{const e=await m({}),s=p(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:L(M(s)),map:e.reduce((t,a)=>t.set(a.menuId,a),new Map)}}),Q=()=>{const e=l();return()=>e.invalidateQueries(S)},z=()=>{const e=P(),s=Q(),t=T(),{message:a,modal:o}=w.useApp(),{mutateAsync:n,isLoading:I}=O(async u=>{await j({menuId:u})},{onSuccess:async()=>{t(),await Promise.all([e(),s()]),a.success("删除成功")}});return u=>{o.confirm({title:"操作确认",content:R(f,{children:["确定删除菜单",x(C.Text,{code:!0,children:u.menuName}),"吗？"]}),onOk:()=>n(u.menuId),okButtonProps:{loading:I}})}};export{X as useAtomStateSelectedMenuData,N as useAtomValueModalAdd,Y as useAtomValueSelectedMenuData,z as useDeleteMenu,v as useHideModalAdd,V as useQueryMenuList,K as useQueryMenuOptions,P as useReFetchMenuList,Q as useReFetchMenuOptions,T as useResetSelectedMenuData,B as useShowModalAdd};
