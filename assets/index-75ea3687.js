import{cy as I,aX as c,aj as S,al as d,c8 as i,cU as m,ca as l,cV as p,aZ as D,j as w,k as R,d as f,cc as C,cL as L,aG as T,cW as b}from"./index-4bcc3c59.js";import{a as M,u as h}from"./utils-cfd88001.js";import{u as j}from"./useMutation.esm-92311925.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,s){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,s),s)}};const y="systemMenu",x=e=>{const s=a=>a.filter(n=>n.menuType!==L.F).map(({menuId:n,menuName:o,children:t})=>({menuId:n,menuName:o,children:t?s(t):[]}));return[{menuId:0,menuName:"根目录",children:e?s(e):[]}]},u=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomSelectedMenuData",M({hasSelected:!1,selectedMenuId:0,selectedMenuName:"根目录"}));u.debugLabel="atomSelectedMenuData";const O=()=>h(u),q=()=>I(u),N=()=>c(u),r=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/menu/model/index.tsx/atomAddModal",M(!1));r.debugLabel="atomAddModal";const V=()=>h(r),Y=()=>{const e=S(r);return()=>e(!0)},v=()=>c(r),A=[y,"list"],F=()=>{const e=d();return()=>e.invalidateQueries(A)},B=(e={},s)=>i(A,async()=>{const a=await m(e),n=l(a,{id:"menuId",pId:"parentId",rootPId:null});return{treeData:p(n),map:a.reduce((o,t)=>o.set(t.menuId,t),new Map),parentIds:Array.from(a.reduce((o,t)=>o.add(t.parentId),new Set))}},{onSuccess:a=>{s(a.parentIds)}}),g=[y,"options"],P=()=>{const e=d();return()=>e.invalidateQueries(g)},K=()=>i(g,async()=>{const e=await m({}),s=l(e,{id:"menuId",pId:"parentId",rootPId:null});return{options:x(p(s)),map:e.reduce((a,n)=>a.set(n.menuId,n),new Map)}}),W=()=>{const e=F(),s=P(),a=O(),{mutateAsync:n,isLoading:o}=j(async t=>{await b({menuId:t})},{onSuccess:async()=>{a(),await Promise.all([e(),s()]),T.success("删除成功")}});return t=>{D.confirm({title:"删除菜单",content:w(R,{children:["确定删除菜单",f(C.Text,{code:!0,children:t.menuName}),"吗？"]}),onOk:()=>n(t.menuId),okButtonProps:{loading:o}})}};export{q as useAtomStateSelectedMenuData,v as useAtomValueCreateModal,N as useAtomValueSelectedMenuData,W as useDeleteMenu,V as useHideCreateModal,B as useQueryMenuList,K as useQueryMenuOptions,F as useReFetchMenuList,P as useReFetchMenuOptions,O as useResetSelectedMenuData,Y as useShowCreateModal};
