import{r as d}from"./jsx-runtime-ade36ecc.js";import{aM as U,aN as z}from"./index-b934b6f1.js";const q=t=>(e,n)=>{const r=d.exports.useRef(!1);t(()=>()=>{r.current=!1},[]),t(()=>{if(!r.current)r.current=!0;else return e()},n)};var S=function(t,e){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},S(t,e)};function Oe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");S(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var M=function(){return M=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},M.apply(this,arguments)};function B(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function L(t,e,n,r){function i(s){return s instanceof n?s:new n(function(u){u(s)})}return new(n||(n=Promise))(function(s,u){function l(c){try{o(r.next(c))}catch(f){u(f)}}function a(c){try{o(r.throw(c))}catch(f){u(f)}}function o(c){c.done?s(c.value):i(c.value).then(l,a)}o((r=r.apply(t,e||[])).next())})}function Se(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(o){return function(c){return a([o,c])}}function a(o){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,o[0]&&(n=0)),n;)try{if(r=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return n.label++,{value:o[1],done:!1};case 5:n.label++,i=o[1],o=[0];continue;case 7:o=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){n.label=o[1];break}if(o[0]===6&&n.label<s[1]){n.label=s[1],s=o;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(o);break}s[2]&&n.ops.pop(),n.trys.pop();continue}o=e.call(t,n)}catch(c){o=[6,c],i=0}finally{r=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function je(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ae(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],u;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(l){u={error:l}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(u)throw u.error}}return s}function Ee(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var s=arguments[e],u=0,l=s.length;u<l;u++,i++)r[i]=s[u];return r}function $e(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}const R=t=>typeof t=="function",V=!1,A=V;function m(t){A&&(R(t)||console.error(`useMemoizedFn expected parameter is a function, got ${typeof t}`));const e=d.exports.useRef(t);e.current=d.exports.useMemo(()=>t,[t]);const n=d.exports.useRef();return n.current||(n.current=function(...r){return e.current.apply(this,r)}),n.current}const j=q(d.exports.useEffect),F=(t,{manual:e,ready:n=!0,defaultParams:r=[],refreshDeps:i=[],refreshDepsAction:s})=>{const u=d.exports.useRef(!1);return u.current=!1,j(()=>{!e&&n&&(u.current=!0,t.run(...r))},[n]),j(()=>{u.current||e||(u.current=!0,s?s():t.refresh())},[...i]),{onBefore:()=>{if(!n)return{stopNow:!0}}}};F.onInit=({ready:t=!0,manual:e})=>({loading:!e&&t});const G=F;function J(t,e){if(t===e)return!0;for(let n=0;n<t.length;n++)if(!Object.is(t[n],e[n]))return!1;return!0}function T(t,e){const{current:n}=d.exports.useRef({deps:e,obj:void 0,initialized:!1});return(n.initialized===!1||!J(n.deps,e))&&(n.deps=e,n.obj=t(),n.initialized=!0),n.obj}function H(t){const e=d.exports.useRef(t);return e.current=t,e}const Q=t=>{A&&(R(t)||console.error(`useUnmount expected parameter is a function, got ${typeof t}`));const e=H(t);d.exports.useEffect(()=>()=>{e.current()},[])},E=Q,w=new Map,X=(t,e,n)=>{const r=w.get(t);r!=null&&r.timer&&clearTimeout(r.timer);let i;e>-1&&(i=setTimeout(()=>{w.delete(t)},e)),w.set(t,Object.assign(Object.assign({},n),{timer:i}))},Y=t=>w.get(t),x=new Map,Z=t=>x.get(t),k=(t,e)=>{x.set(t,e),e.then(n=>(x.delete(t),n)).catch(()=>{x.delete(t)})},g={},W=(t,e)=>{g[t]&&g[t].forEach(n=>n(e))},O=(t,e)=>(g[t]||(g[t]=[]),g[t].push(e),function(){const r=g[t].indexOf(e);g[t].splice(r,1)}),I=(t,{cacheKey:e,cacheTime:n=5*60*1e3,staleTime:r=0,setCache:i,getCache:s})=>{const u=d.exports.useRef(),l=d.exports.useRef(),a=(c,f)=>{i?i(f):X(c,n,f),W(c,f.data)},o=(c,f=[])=>s?s(f):Y(c);return T(()=>{if(!e)return;const c=o(e);c&&Object.hasOwnProperty.call(c,"data")&&(t.state.data=c.data,t.state.params=c.params,(r===-1||new Date().getTime()-c.time<=r)&&(t.state.loading=!1)),u.current=O(e,f=>{t.setState({data:f})})},[]),E(()=>{var c;(c=u.current)===null||c===void 0||c.call(u)}),e?{onBefore:c=>{const f=o(e,c);return!f||!Object.hasOwnProperty.call(f,"data")?{}:r===-1||new Date().getTime()-f.time<=r?{loading:!1,data:f==null?void 0:f.data,error:void 0,returnNow:!0}:{data:f==null?void 0:f.data,error:void 0}},onRequest:(c,f)=>{let v=Z(e);return v&&v!==l.current?{servicePromise:v}:(v=c(...f),l.current=v,k(e,v),{servicePromise:v})},onSuccess:(c,f)=>{var v;e&&((v=u.current)===null||v===void 0||v.call(u),a(e,{data:c,params:f,time:new Date().getTime()}),u.current=O(e,_=>{t.setState({data:_})}))},onMutate:c=>{var f;e&&((f=u.current)===null||f===void 0||f.call(u),a(e,{data:c,params:t.state.params,time:new Date().getTime()}),u.current=O(e,v=>{t.setState({data:v})}))}}:{}},K=I,ee=(t,{debounceWait:e,debounceLeading:n,debounceTrailing:r,debounceMaxWait:i})=>{const s=d.exports.useRef(),u=d.exports.useMemo(()=>{const l={};return n!==void 0&&(l.leading=n),r!==void 0&&(l.trailing=r),i!==void 0&&(l.maxWait=i),l},[n,r,i]);return d.exports.useEffect(()=>{if(e){const l=t.runAsync.bind(t);return s.current=U(a=>{a()},e,u),t.runAsync=(...a)=>new Promise((o,c)=>{var f;(f=s.current)===null||f===void 0||f.call(s,()=>{l(...a).then(o).catch(c)})}),()=>{var a;(a=s.current)===null||a===void 0||a.cancel(),t.runAsync=l}}},[e,u]),e?{onCancel:()=>{var l;(l=s.current)===null||l===void 0||l.cancel()}}:{}},te=ee,ne=(t,{loadingDelay:e})=>{const n=d.exports.useRef();if(!e)return{};const r=()=>{n.current&&clearTimeout(n.current)};return{onBefore:()=>(r(),n.current=setTimeout(()=>{t.setState({loading:!0})},e),{loading:!1}),onFinally:()=>{r()},onCancel:()=>{r()}}},re=ne,se=!!(typeof window<"u"&&window.document&&window.document.createElement),P=se;function $(){return P?document.visibilityState!=="hidden":!0}const b=[];function ie(t){return b.push(t),function(){const n=b.indexOf(t);b.splice(n,1)}}if(P){const t=()=>{if($())for(let e=0;e<b.length;e++){const n=b[e];n()}};window.addEventListener("visibilitychange",t,!1)}const ue=(t,{pollingInterval:e,pollingWhenHidden:n=!0,pollingErrorRetryCount:r=-1})=>{const i=d.exports.useRef(),s=d.exports.useRef(),u=d.exports.useRef(0),l=()=>{var a;i.current&&clearTimeout(i.current),(a=s.current)===null||a===void 0||a.call(s)};return j(()=>{e||l()},[e]),e?{onBefore:()=>{l()},onError:()=>{u.current+=1},onSuccess:()=>{u.current=0},onFinally:()=>{r===-1||r!==-1&&u.current<=r?i.current=setTimeout(()=>{!n&&!$()?s.current=ie(()=>{t.refresh()}):t.refresh()},e):u.current=0},onCancel:()=>{l()}}:{}},oe=ue;function ce(t,e){let n=!1;return(...r)=>{n||(n=!0,t(...r),setTimeout(()=>{n=!1},e))}}function ae(){return P&&typeof navigator.onLine<"u"?navigator.onLine:!0}const y=[];function le(t){return y.push(t),function(){const n=y.indexOf(t);n>-1&&y.splice(n,1)}}if(P){const t=()=>{if(!(!$()||!ae()))for(let e=0;e<y.length;e++){const n=y[e];n()}};window.addEventListener("visibilitychange",t,!1),window.addEventListener("focus",t,!1)}const fe=(t,{refreshOnWindowFocus:e,focusTimespan:n=5e3})=>{const r=d.exports.useRef(),i=()=>{var s;(s=r.current)===null||s===void 0||s.call(r)};return d.exports.useEffect(()=>{if(e){const s=ce(t.refresh.bind(t),n);r.current=le(()=>{s()})}return()=>{i()}},[e,n]),E(()=>{i()}),{}},de=fe,ve=(t,{retryInterval:e,retryCount:n})=>{const r=d.exports.useRef(),i=d.exports.useRef(0),s=d.exports.useRef(!1);return n?{onBefore:()=>{s.current||(i.current=0),s.current=!1,r.current&&clearTimeout(r.current)},onSuccess:()=>{i.current=0},onError:()=>{if(i.current+=1,n===-1||i.current<=n){const u=e??Math.min(1e3*Math.pow(2,i.current),3e4);r.current=setTimeout(()=>{s.current=!0,t.refresh()},u)}else i.current=0},onCancel:()=>{i.current=0,r.current&&clearTimeout(r.current)}}:{}},he=ve,ge=(t,{throttleWait:e,throttleLeading:n,throttleTrailing:r})=>{const i=d.exports.useRef(),s={};return n!==void 0&&(s.leading=n),r!==void 0&&(s.trailing=r),d.exports.useEffect(()=>{if(e){const u=t.runAsync.bind(t);return i.current=z(l=>{l()},e,s),t.runAsync=(...l)=>new Promise((a,o)=>{var c;(c=i.current)===null||c===void 0||c.call(i,()=>{u(...l).then(a).catch(o)})}),()=>{var l;t.runAsync=u,(l=i.current)===null||l===void 0||l.cancel()}}},[e,n,r]),e?{onCancel:()=>{var u;(u=i.current)===null||u===void 0||u.cancel()}}:{}},pe=ge,me=t=>{A&&(R(t)||console.error(`useMount: parameter \`fn\` expected to be a function, but got "${typeof t}".`)),d.exports.useEffect(()=>{t==null||t()},[])},be=me,ye=()=>{const[,t]=d.exports.useState({});return d.exports.useCallback(()=>t({}),[])},_e=ye;class we{constructor(e,n,r,i={}){this.serviceRef=e,this.options=n,this.subscribe=r,this.initState=i,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=Object.assign(Object.assign(Object.assign({},this.state),{loading:!n.manual}),i)}setState(e={}){this.state=Object.assign(Object.assign({},this.state),e),this.subscribe()}runPluginHandler(e,...n){const r=this.pluginImpls.map(i=>{var s;return(s=i[e])===null||s===void 0?void 0:s.call(i,...n)}).filter(Boolean);return Object.assign({},...r)}runAsync(...e){var n,r,i,s,u,l,a,o,c,f;return L(this,void 0,void 0,function*(){this.count+=1;const v=this.count,_=this.runPluginHandler("onBefore",e),{stopNow:D=!1,returnNow:N=!1}=_,C=B(_,["stopNow","returnNow"]);if(D)return new Promise(()=>{});if(this.setState(Object.assign({loading:!0,params:e},C)),N)return Promise.resolve(C.data);(r=(n=this.options).onBefore)===null||r===void 0||r.call(n,e);try{let{servicePromise:h}=this.runPluginHandler("onRequest",this.serviceRef.current,e);h||(h=this.serviceRef.current(...e));const p=yield h;return v!==this.count?new Promise(()=>{}):(this.setState({data:p,error:void 0,loading:!1}),(s=(i=this.options).onSuccess)===null||s===void 0||s.call(i,p,e),this.runPluginHandler("onSuccess",p,e),(l=(u=this.options).onFinally)===null||l===void 0||l.call(u,e,p,void 0),v===this.count&&this.runPluginHandler("onFinally",e,p,void 0),p)}catch(h){if(v!==this.count)return new Promise(()=>{});throw this.setState({error:h,loading:!1}),(o=(a=this.options).onError)===null||o===void 0||o.call(a,h,e),this.runPluginHandler("onError",h,e),(f=(c=this.options).onFinally)===null||f===void 0||f.call(c,e,void 0,h),v===this.count&&this.runPluginHandler("onFinally",e,void 0,h),h}})}run(...e){this.runAsync(...e).catch(n=>{this.options.onError||console.error(n)})}cancel(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")}refresh(){this.run(...this.state.params||[])}refreshAsync(){return this.runAsync(...this.state.params||[])}mutate(e){const n=R(e)?e(this.state.data):e;this.runPluginHandler("onMutate",n),this.setState({data:n})}}function xe(t,e={},n=[]){const{manual:r=!1}=e,i=B(e,["manual"]),s=Object.assign({manual:r},i),u=H(t),l=_e(),a=T(()=>{const o=n.map(c=>{var f;return(f=c==null?void 0:c.onInit)===null||f===void 0?void 0:f.call(c,s)}).filter(Boolean);return new we(u,s,l,Object.assign({},...o))},[]);return a.options=s,a.pluginImpls=n.map(o=>o(a,s)),be(()=>{if(!r){const o=a.state.params||e.defaultParams||[];a.run(...o)}}),E(()=>{a.cancel()}),{loading:a.state.loading,data:a.state.data,error:a.state.error,params:a.state.params||[],cancel:m(a.cancel.bind(a)),refresh:m(a.refresh.bind(a)),refreshAsync:m(a.refreshAsync.bind(a)),run:m(a.run.bind(a)),runAsync:m(a.runAsync.bind(a)),mutate:m(a.mutate.bind(a))}}function Ce(t,e,n){return xe(t,e,[...n||[],te,re,oe,de,pe,G,K,he])}export{Ee as _,Oe as a,M as b,$e as c,B as d,je as e,Ae as f,L as g,Se as h,P as i,Ce as u};
