import{r as d,A as D,_ as f,W as L,X as M,Y as O,aZ as b,p as x,cn as C,co as E,j as a,aU as V,f as y,d as v,q as N,aA as K,ax as S,bP as U,b8 as z,O as k,ad as j,cp as X,a2 as P,cq as Y,B as _}from"./index-cde0b745.js";import{u as w}from"./useMutation-c6d67192.js";import{u as $}from"./index-1942a5ae.js";var F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}},{tag:"path",attrs:{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"close-circle",theme:"outlined"};const Q=F;var R=function(t,o){return d.createElement(D,f(f({},t),{},{ref:o,icon:Q}))};R.displayName="CloseCircleOutlined";const W=d.forwardRef(R);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const A=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/roleAuth/model/index.ts/atomMainTable",L(void 0));A.debugLabel="atomMainTable";const q=()=>O(A),Z=()=>M(A);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const B=({userId:e,userName:t,isBatch:o,disabled:c})=>{const l=o?"批量取消授权":"取消授权",i=b(),n=Number(i.roleId),s=q(),{message:h,modal:m}=x.useApp(),{mutateAsync:p,isLoading:g}=w(async()=>{Array.isArray(e)?await C({roleId:n,userIds:e}):await E({roleId:n,userId:e})},{onSuccess:()=>{var r;s==null||s.reload(),(r=s==null?void 0:s.clearSelected)==null||r.call(s),h.success("取消授权成功")}});return a(V,{accessible:!0,children:a(y,{type:"link",danger:!0,disabled:c,icon:a(W,{}),onClick:()=>{m.confirm({title:"取消授权",content:v(N,{children:["确定取消授权用户",a(K.Text,{code:!0,children:t}),"吗？"]}),onOk:()=>p(),okButtonProps:{loading:g}})},children:l})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const G=()=>{const e=b(),t=Number(e.roleId),[o,{toggle:c}]=$(),l=d.useRef(),[i,n]=d.useState([]),s=q(),{message:h}=x.useApp(),{isLoading:m,mutate:p}=w(()=>C({roleId:t,userIds:i}),{onSuccess:()=>{var r,u,T;(r=l.current)==null||r.reload(),(T=(u=l.current)==null?void 0:u.clearSelected)==null||T.call(u),s==null||s.reload(),c(),h.success("授权成功")}}),{valueEnumSysNormalDisable:g,defaultValueSysNormalDisable:I}=S();return v(N,{children:[a(y,{type:"primary",icon:a(U,{}),onClick:()=>{var r;(r=l.current)==null||r.reload(),c()},children:"授权用户"}),a(z,{open:o,title:"授权用户",placement:"left",onClose:c,width:850,footer:a(y,{type:"primary",disabled:i.length===0,loading:m,onClick:()=>p(),children:"提交"}),footerStyle:{textAlign:"right"},children:a(k,{ghost:!0,rowKey:"userId",actionRef:l,columns:[{dataIndex:"userName",key:"userName",title:"用户名称",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"用户昵称",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"邮箱",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"请输入邮箱"},{pattern:j,message:"邮箱格式错误"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"手机号码",valueType:"text",copyable:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:g,formItemProps:{initialValue:I,required:!0,rules:[{required:!0,message:"请选择状态"}]}},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0}],tableAlertRender:!1,rowSelection:{onChange:r=>{n(r)}},request:(...r)=>X(P(...r))})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const H=({selectedRows:e})=>a(B,{userId:e.map(t=>t.userId),userName:e.map(t=>t.userName).join(","),isBatch:!0,disabled:e.length===0}),J=()=>{const e=b(),t=Number(e.roleId),o=Z(),{valueEnumSysNormalDisable:c,defaultValueSysNormalDisable:l}=S();return a(k,{rowKey:"userId",actionRef:o,params:{roleId:t},columns:[{dataIndex:"userName",key:"userName",title:"用户名称",valueType:"text"},{dataIndex:"nickName",key:"nickName",title:"用户昵称",valueType:"text",hideInSearch:!0},{dataIndex:"email",title:"邮箱",valueType:"text",hideInSearch:!0,formItemProps:{rules:[{required:!0,message:"请输入邮箱"},{pattern:j,message:"邮箱格式错误"}]}},{dataIndex:"phoneNumber",key:"phoneNumber",title:"手机号码",valueType:"text",copyable:!0},{title:"状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:c,formItemProps:{initialValue:l,required:!0,rules:[{required:!0,message:"请选择状态"}]}},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1,hideInSearch:!0,sorter:!0},{title:"操作",dataIndex:"option",valueType:"option",render:(i,n)=>a(B,{userId:n.userId,userName:n.userName})}],request:(...i)=>Y(P(...i)),tableAlertRender:H,toolbar:{actions:[a(G,{},"DrawerTableAuth")]}})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const se=()=>a(_,{children:a(J,{})});export{se as default};
