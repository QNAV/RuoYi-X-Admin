import{ad as f,af as v,d as a,b3 as i,aK as l,b4 as g,b5 as y,aR as h,b6 as A,r as k,aF as C,b7 as L,b8 as M}from"./index-324581e1.js";import{b as u,d as m}from"./index-0faee625.js";import{a as j}from"./index-8805c201.js";import{f as O,g as P,h as B,i as R}from"./Monitor-d80b40fc.js";import{u as p}from"./useMutation.esm-34ecafff.js";import"./System-c33174c5.js";import"./utils.esm-d0713da8.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const d=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/monitor/operlog/model/index.ts/atomMainTableActions",f(void 0));d.debugLabel="atomMainTableActions";const b=()=>v(d),S=()=>j(d);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const w=()=>{const{canRemoveSysOperLog:e}=u(),t=b(),{isLoading:s,mutate:c}=p(()=>O(),{onSuccess:()=>{t==null||t.reload(),h.success("清空操作日志成功")}});return a(i,{accessible:e,children:a(l,{danger:!0,icon:a(g,{}),onClick:()=>y.confirm({title:"清空操作日志",content:"确认清空操作日志吗？",okButtonProps:{loading:s},onOk:c}),children:"清空"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const E=({searchParams:e})=>{const{canExportSysOperLog:t}=u(),{isLoading:s,mutate:c}=p(()=>P(e),{onSuccess:()=>{h.success("导出成功")}});return a(i,{accessible:t,children:a(l,{ghost:!0,type:"primary",icon:a(A,{}),loading:s,onClick:()=>c(),children:"导出当前列表"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const T=({operId:e,disabled:t=!1,isBatch:s=!1})=>{const c=s?"批量删除":"删除",{canRemoveSysOperLog:r}=u(),o=b(),{mutateAsync:x,isLoading:I}=p(async n=>{await B({operIds:n})},{onSuccess:()=>{var n;o==null||o.reload(),(n=o==null?void 0:o.clearSelected)==null||n.call(o),h.success("删除成功")}});return a(i,{accessible:r,children:a(l,{type:"link",danger:!0,disabled:t,icon:a(g,{}),onClick:()=>{y.confirm({title:"删除操作日志",content:`确定删除操作编号为 ${e} 的操作日志吗`,onOk:async()=>x(e),okButtonProps:{loading:I}})},children:c})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const D=()=>{var s,c;const{data:e}=m("sys_common_status"),{data:t}=m("sys_oper_type");return[{title:"日志编号",dataIndex:"operId",key:"operId",valueType:"text",hideInSearch:!0},{title:"系统模块",dataIndex:"title",key:"title",valueType:"text"},{title:"操作类型",dataIndex:"businessType",key:"businessType",valueType:"select",valueEnum:(s=t==null?void 0:t.mapData)!=null?s:{}},{title:"请求方式",dataIndex:"requestMethod",key:"requestMethod",valueType:"text",hideInSearch:!0},{title:"操作人员",dataIndex:"operName",key:"operName",valueType:"text"},{title:"操作地址",dataIndex:"operIp",key:"operIp",valueType:"text",hideInSearch:!0},{title:"操作地点",dataIndex:"operLocation",key:"operLocation",valueType:"text",hideInSearch:!0},{title:"操作状态",dataIndex:"status",key:"status",valueType:"select",valueEnum:(c=e==null?void 0:e.mapData)!=null?c:{}},{title:"操作日期",dataIndex:"operTime",key:"operTime",valueType:"dateTime",hideInSearch:!0},{title:"操作",dataIndex:"option",key:"option",valueType:"option",fixed:"right",render:(r,o)=>a(T,{operId:o.operId})}]},_=({selectedRows:e})=>a(T,{isBatch:!0,disabled:e.length===0,operId:e.map(t=>t.operId).join(",")}),Q=()=>{const e=S(),t=D(),[s,c]=k.exports.useState({});return a(C,{children:a(L,{rowKey:"operId",actionRef:e,columns:t,request:async(...r)=>{const o=M(...r);return c(o),await R(o)},toolbar:{actions:[a(w,{},"ButtonCleanUp"),a(E,{searchParams:s},"ButtonExport")]},tableAlertOptionRender:_})})};export{Q as default};
