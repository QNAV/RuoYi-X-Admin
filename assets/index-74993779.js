import{r as g,A as I,_ as C,p as d,bz as O,bA as M,j as a,f as u,bB as S,ao as U,Z as m,d as l,W as R,X as P,Y as L,bC as z,a1 as F,z as N,bD as v,ay as T,bE as x,bF as E,O as K,a2 as D,K as $,bG as V,v as H,q as _,B as q}from"./index-cde0b745.js";import{u as p}from"./useMutation-c6d67192.js";import{u as A}from"./index-1942a5ae.js";import{U as j}from"./index-9644627d.js";import{I as k}from"./InboxOutlined-864dc61b.js";import{u as G}from"./useRequest-41b27702.js";var X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM340 683v77c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-77c-10.1 3.3-20.8 5-32 5s-21.9-1.8-32-5zm64-198V264c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v221c10.1-3.3 20.8-5 32-5s21.9 1.8 32 5zm-64 198c10.1 3.3 20.8 5 32 5s21.9-1.8 32-5c41.8-13.5 72-52.7 72-99s-30.2-85.5-72-99c-10.1-3.3-20.8-5-32-5s-21.9 1.8-32 5c-41.8 13.5-72 52.7-72 99s30.2 85.5 72 99zm.1-115.7c.3-.6.7-1.2 1-1.8v-.1l1.2-1.8c.1-.2.2-.3.3-.5.3-.5.7-.9 1-1.4.1-.1.2-.3.3-.4.5-.6.9-1.1 1.4-1.6l.3-.3 1.2-1.2.4-.4c.5-.5 1-.9 1.6-1.4.6-.5 1.1-.9 1.7-1.3.2-.1.3-.2.5-.3.5-.3.9-.7 1.4-1 .1-.1.3-.2.4-.3.6-.4 1.2-.7 1.9-1.1.1-.1.3-.1.4-.2.5-.3 1-.5 1.6-.8l.6-.3c.7-.3 1.3-.6 2-.8.7-.3 1.4-.5 2.1-.7.2-.1.4-.1.6-.2.6-.2 1.1-.3 1.7-.4.2 0 .3-.1.5-.1.7-.2 1.5-.3 2.2-.4.2 0 .3 0 .5-.1.6-.1 1.2-.1 1.8-.2h.6c.8 0 1.5-.1 2.3-.1s1.5 0 2.3.1h.6c.6 0 1.2.1 1.8.2.2 0 .3 0 .5.1.7.1 1.5.2 2.2.4.2 0 .3.1.5.1.6.1 1.2.3 1.7.4.2.1.4.1.6.2.7.2 1.4.4 2.1.7.7.2 1.3.5 2 .8l.6.3c.5.2 1.1.5 1.6.8.1.1.3.1.4.2.6.3 1.3.7 1.9 1.1.1.1.3.2.4.3.5.3 1 .6 1.4 1 .2.1.3.2.5.3.6.4 1.2.9 1.7 1.3s1.1.9 1.6 1.4l.4.4 1.2 1.2.3.3c.5.5 1 1.1 1.4 1.6.1.1.2.3.3.4.4.4.7.9 1 1.4.1.2.2.3.3.5l1.2 1.8s0 .1.1.1a36.18 36.18 0 015.1 18.5c0 6-1.5 11.7-4.1 16.7-.3.6-.7 1.2-1 1.8 0 0 0 .1-.1.1l-1.2 1.8c-.1.2-.2.3-.3.5-.3.5-.7.9-1 1.4-.1.1-.2.3-.3.4-.5.6-.9 1.1-1.4 1.6l-.3.3-1.2 1.2-.4.4c-.5.5-1 .9-1.6 1.4-.6.5-1.1.9-1.7 1.3-.2.1-.3.2-.5.3-.5.3-.9.7-1.4 1-.1.1-.3.2-.4.3-.6.4-1.2.7-1.9 1.1-.1.1-.3.1-.4.2-.5.3-1 .5-1.6.8l-.6.3c-.7.3-1.3.6-2 .8-.7.3-1.4.5-2.1.7-.2.1-.4.1-.6.2-.6.2-1.1.3-1.7.4-.2 0-.3.1-.5.1-.7.2-1.5.3-2.2.4-.2 0-.3 0-.5.1-.6.1-1.2.1-1.8.2h-.6c-.8 0-1.5.1-2.3.1s-1.5 0-2.3-.1h-.6c-.6 0-1.2-.1-1.8-.2-.2 0-.3 0-.5-.1-.7-.1-1.5-.2-2.2-.4-.2 0-.3-.1-.5-.1-.6-.1-1.2-.3-1.7-.4-.2-.1-.4-.1-.6-.2-.7-.2-1.4-.4-2.1-.7-.7-.2-1.3-.5-2-.8l-.6-.3c-.5-.2-1.1-.5-1.6-.8-.1-.1-.3-.1-.4-.2-.6-.3-1.3-.7-1.9-1.1-.1-.1-.3-.2-.4-.3-.5-.3-1-.6-1.4-1-.2-.1-.3-.2-.5-.3-.6-.4-1.2-.9-1.7-1.3s-1.1-.9-1.6-1.4l-.4-.4-1.2-1.2-.3-.3c-.5-.5-1-1.1-1.4-1.6-.1-.1-.2-.3-.3-.4-.4-.4-.7-.9-1-1.4-.1-.2-.2-.3-.3-.5l-1.2-1.8v-.1c-.4-.6-.7-1.2-1-1.8-2.6-5-4.1-10.7-4.1-16.7s1.5-11.7 4.1-16.7zM620 539v221c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V539c-10.1 3.3-20.8 5-32 5s-21.9-1.8-32-5zm64-198v-77c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v77c10.1-3.3 20.8-5 32-5s21.9 1.8 32 5zm-64 198c10.1 3.3 20.8 5 32 5s21.9-1.8 32-5c41.8-13.5 72-52.7 72-99s-30.2-85.5-72-99c-10.1-3.3-20.8-5-32-5s-21.9 1.8-32 5c-41.8 13.5-72 52.7-72 99s30.2 85.5 72 99zm.1-115.7c.3-.6.7-1.2 1-1.8v-.1l1.2-1.8c.1-.2.2-.3.3-.5.3-.5.7-.9 1-1.4.1-.1.2-.3.3-.4.5-.6.9-1.1 1.4-1.6l.3-.3 1.2-1.2.4-.4c.5-.5 1-.9 1.6-1.4.6-.5 1.1-.9 1.7-1.3.2-.1.3-.2.5-.3.5-.3.9-.7 1.4-1 .1-.1.3-.2.4-.3.6-.4 1.2-.7 1.9-1.1.1-.1.3-.1.4-.2.5-.3 1-.5 1.6-.8l.6-.3c.7-.3 1.3-.6 2-.8.7-.3 1.4-.5 2.1-.7.2-.1.4-.1.6-.2.6-.2 1.1-.3 1.7-.4.2 0 .3-.1.5-.1.7-.2 1.5-.3 2.2-.4.2 0 .3 0 .5-.1.6-.1 1.2-.1 1.8-.2h.6c.8 0 1.5-.1 2.3-.1s1.5 0 2.3.1h.6c.6 0 1.2.1 1.8.2.2 0 .3 0 .5.1.7.1 1.5.2 2.2.4.2 0 .3.1.5.1.6.1 1.2.3 1.7.4.2.1.4.1.6.2.7.2 1.4.4 2.1.7.7.2 1.3.5 2 .8l.6.3c.5.2 1.1.5 1.6.8.1.1.3.1.4.2.6.3 1.3.7 1.9 1.1.1.1.3.2.4.3.5.3 1 .6 1.4 1 .2.1.3.2.5.3.6.4 1.2.9 1.7 1.3s1.1.9 1.6 1.4l.4.4 1.2 1.2.3.3c.5.5 1 1.1 1.4 1.6.1.1.2.3.3.4.4.4.7.9 1 1.4.1.2.2.3.3.5l1.2 1.8v.1a36.18 36.18 0 015.1 18.5c0 6-1.5 11.7-4.1 16.7-.3.6-.7 1.2-1 1.8v.1l-1.2 1.8c-.1.2-.2.3-.3.5-.3.5-.7.9-1 1.4-.1.1-.2.3-.3.4-.5.6-.9 1.1-1.4 1.6l-.3.3-1.2 1.2-.4.4c-.5.5-1 .9-1.6 1.4-.6.5-1.1.9-1.7 1.3-.2.1-.3.2-.5.3-.5.3-.9.7-1.4 1-.1.1-.3.2-.4.3-.6.4-1.2.7-1.9 1.1-.1.1-.3.1-.4.2-.5.3-1 .5-1.6.8l-.6.3c-.7.3-1.3.6-2 .8-.7.3-1.4.5-2.1.7-.2.1-.4.1-.6.2-.6.2-1.1.3-1.7.4-.2 0-.3.1-.5.1-.7.2-1.5.3-2.2.4-.2 0-.3 0-.5.1-.6.1-1.2.1-1.8.2h-.6c-.8 0-1.5.1-2.3.1s-1.5 0-2.3-.1h-.6c-.6 0-1.2-.1-1.8-.2-.2 0-.3 0-.5-.1-.7-.1-1.5-.2-2.2-.4-.2 0-.3-.1-.5-.1-.6-.1-1.2-.3-1.7-.4-.2-.1-.4-.1-.6-.2-.7-.2-1.4-.4-2.1-.7-.7-.2-1.3-.5-2-.8l-.6-.3c-.5-.2-1.1-.5-1.6-.8-.1-.1-.3-.1-.4-.2-.6-.3-1.3-.7-1.9-1.1-.1-.1-.3-.2-.4-.3-.5-.3-1-.6-1.4-1-.2-.1-.3-.2-.5-.3-.6-.4-1.2-.9-1.7-1.3s-1.1-.9-1.6-1.4l-.4-.4-1.2-1.2-.3-.3c-.5-.5-1-1.1-1.4-1.6-.1-.1-.2-.3-.3-.4-.4-.4-.7-.9-1-1.4-.1-.2-.2-.3-.3-.5l-1.2-1.8v-.1c-.4-.6-.7-1.2-1-1.8-2.6-5-4.1-10.7-4.1-16.7s1.5-11.7 4.1-16.7z"}}]},name:"control",theme:"outlined"};const Y=X;var B=function(t,o){return g.createElement(I,C(C({},t),{},{ref:o,icon:Y}))};B.displayName="ControlOutlined";const W=g.forwardRef(B);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Z=({ossId:e})=>{const{message:t}=d.useApp(),{isLoading:o,mutate:c}=p(async()=>{const{data:n,headers:s}=await O({ossId:e},{format:"blob"}),i=new Blob([n],{type:"application/octet-stream"});i instanceof Blob?(M.saveAs(i,decodeURIComponent(s["download-filename"])),t.success("下载成功")):t.error("下载失败")},{onSuccess:()=>{}});return a(u,{type:"link",icon:a(S,{}),loading:o,onClick:()=>{c()},children:"下载"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const J=({configKey:e,configValue:t,onFinish:o})=>{const{modal:c}=d.useApp(),{mutate:n,isLoading:s}=p(U,{onSuccess:()=>{o()}});return a(m,{accessKey:"system:oss:edit",children:l(u,{danger:!0,type:"primary",ghost:!0,onClick:()=>{c.confirm({title:"操作确认",content:`确定${t?"停用":"启用"}"预览列表图片"配置吗？`,okButtonProps:{loading:s},onOk:()=>n({configKey:e,configValue:`${!t}`})})},children:["预览开关：",t?"启用":"停用"]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const f=globalThis.jotaiAtomCache.get("/home/runner/work/RuoYi-X-Admin/RuoYi-X-Admin/src/pages/system/oss/model/index.ts/atomMainTableActions",R(void 0));f.debugLabel="atomMainTableActions";const Q=()=>L(f),e1=()=>P(f);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const w=({ossIds:e,batch:t,disabled:o})=>{const{message:c,modal:n}=d.useApp(),s=Q(),{mutate:i,isLoading:h}=p(z,{onSuccess:()=>{var y;s==null||s.reload(),(y=s==null?void 0:s.clearSelected)==null||y.call(s),c.success("删除成功")}});return a(m,{accessKey:"system:oss:remove",children:a(F,{batch:t,disabled:o,onClick:()=>{n.confirm({title:"删除用户",content:`确定删除OSS对象存储编号为 ${e.join(",")} 的数据吗？`,onOk:()=>i({ossIds:e}),okButtonProps:{loading:h}})}})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const t1=()=>{const e=N();return a(u,{icon:a(W,{}),type:"primary",ghost:!0,onClick:()=>{e("/system/oss-config")},children:"配置管理"})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Dragger:a1}=j,o1=async e=>{const{data:{code:t,msg:o}}=await x({file:e});return t!==200?Promise.reject(new Error(o)):o},s1=()=>{const[e,{toggle:t}]=A(),[o,c]=g.useState([]),{message:n,modal:s}=d.useApp(),{mutate:i,isLoading:h}=p(o1,{onSuccess:r=>{t(),s.info({title:"导入结果",content:r})},onError:()=>{n.error("导入失败")}});return l(m,{accessKey:"system:oss:upload",children:[a(u,{type:"primary",icon:a(v,{}),onClick:t,children:"上传文件"}),a(T,{title:"上传文件",open:e,onCancel:t,okText:"提交",onOk:()=>i(o[0].originFileObj),okButtonProps:{loading:h},children:l(a1,{accept:".xlsx, .xls, .doc, .docx, .ppt, .pptx, .txt, .pdf",maxCount:1,beforeUpload:()=>!1,onChange:r=>c(r.fileList),fileList:o,onRemove:()=>c([]),children:[a("p",{className:"ant-upload-drag-icon",children:a(k,{})}),a("p",{className:"ant-upload-text",children:"点击或拖拽文件到此区域上传"}),a("p",{className:"ant-upload-text",children:"请上传大小不超过5MB格式为doc/xls/ppt/txt/pdf的文件"})]})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Dragger:c1}=j,n1=async e=>{const{data:{code:t,msg:o}}=await x({file:e});return t!==200?Promise.reject(new Error(o)):o},i1=()=>{const[e,{toggle:t}]=A(),[o,c]=g.useState([]),{message:n,modal:s}=d.useApp(),{mutate:i,isLoading:h}=p(n1,{onSuccess:r=>{t(),s.info({title:"导入结果",content:r})},onError:()=>{n.error("导入失败")}});return l(m,{accessKey:"system:oss:upload",children:[a(u,{type:"primary",icon:a(v,{}),onClick:t,children:"上传图片"}),a(T,{title:"上传图片",open:e,onCancel:t,okText:"提交",onOk:()=>i(o[0].originFileObj),okButtonProps:{loading:h},children:l(c1,{accept:".png, .jpg, .jpeg, .docx",maxCount:1,beforeUpload:()=>!1,onChange:r=>c(r.fileList),fileList:o,onRemove:()=>c([]),children:[a("p",{className:"ant-upload-drag-icon",children:a(k,{})}),a("p",{className:"ant-upload-text",children:"点击或拖拽文件到此区域上传"}),a("p",{className:"ant-upload-text",children:"请上传大小不超过5MB格式为png/jpg/jpeg的文件"})]})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const r1=e=>[{title:"对象存储主键",dataIndex:"ossId",key:"ossId",valueType:"text",hideInSearch:!0},{title:"文件名",dataIndex:"fileName",key:"fileName",valueType:"text"},{title:"原名",dataIndex:"originalName",key:"originalName",valueType:"text"},{title:"文件后缀名",dataIndex:"fileSuffix",key:"fileSuffix",valueType:"text"},{title:"文件展示",dataIndex:"url",key:"url",valueType:"text",render:(t,o)=>["png","jpg","jpeg"].includes(o.fileSuffix)&&e?a(H,{src:o.url,width:100,height:100}):o.url},{title:"创建时间",dataIndex:"createTime",key:"createTime",valueType:"dateTime",hideInSearch:!0,sorter:!0},{title:"上传人",dataIndex:"createBy",key:"createBy",valueType:"text"},{title:"服务商",dataIndex:"service",key:"service",valueType:"text",sorter:!0},{title:"创建时间",dataIndex:"dateTimeRange",key:"dateTimeRange",valueType:"dateTimeRange",hideInTable:!0},{title:"操作",dataIndex:"action",valueType:"option",render:(t,o)=>l(_,{children:[a(Z,{ossId:o.ossId}),a(w,{ossIds:[o.ossId]})]})}],l1=({selectedRowKeys:e})=>a(w,{disabled:e.length===0,batch:!0,ossIds:e}),b="sys.oss.previewListResource",h1=()=>{const e=e1(),{data:t,refresh:o}=G(async()=>{const{data:{msg:n}}=await E({configKey:b});return n==="true"}),c=r1(!!t);return a(K,{rowKey:"ossId",actionRef:e,columns:c,request:async(...n)=>{const{dateTimeRange:s,...i}=D(...n);return $(s)&&(i.beginCreateTime=s[0],i.endCreateTime=s[1]),await V(i)},toolbar:{actions:[a(s1,{},"ButtonUploadFile"),a(i1,{},"ButtonUploadImg"),a(J,{configKey:b,configValue:!!t,onFinish:()=>{o()}},"ButtonPreviewConfig"),a(t1,{},"ButtonToConfigPage")]},tableAlertOptionRender:l1})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const y1=()=>a(q,{children:a(h1,{})});export{y1 as default};
