"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[842],{98817:function(Je,ee,u){u.r(ee),u.d(ee,{default:function(){return Ge}});var se=u(46338),Q=u.n(se),ie=u(55980),K=u.n(ie),oe=u(18172),D=u.n(oe),de=u(3849),V=u.n(de),ce=u(29960),f=u.n(ce),i=u(16914),A=u(86053),$=u(16064),ue=u(78534),W=u(96069),ne=u(2891),C=u(46510),Y="systemMenu",ve=[Y,"list"],N=(0,C.cn)({key:"".concat(Y,"SelectedMenuId"),default:"0"}),te=(0,C.cn)({key:"".concat(Y,"VisibleCreateModal"),default:!1}),b=function(n){return(0,ne.aM)(ve,D()(f().mark(function t(){var o,c;return f().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,A.Ii)(n);case 2:return o=l.sent,c=(0,$.tw)(o,{id:"menuId",pId:"parentId",rootPId:null}),l.abrupt("return",{treeData:(0,$.dH)(c),map:o.reduce(function(j,d){return K()(K()({},j),{},Q()({},d.menuId,d))},{}),parentIds:(0,$.Vy)(o)});case 5:case"end":return l.stop()}},t)})),{refetchOnWindowFocus:!1})},re=function(){var n=b(),t=n.refetch,o=(0,C.rb)(N);return(0,ne.Db)(function(){var c=D()(f().mark(function s(l){return f().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:ue.Z.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u83DC\u5355\u5417\uFF1F",onOk:function(){var g=D()(f().mark(function a(){return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,A.Wl)(l);case 2:return r.next=4,t();case 4:o(),W.ZP.success("\u5220\u9664\u6210\u529F");case 6:case"end":return r.stop()}},a)}));function I(){return g.apply(this,arguments)}return I}()});case 1:case"end":return d.stop()}},s)}));return function(s){return c.apply(this,arguments)}}())},me=u(20436),fe=u(30553),he=u(60896),G=u(47780),pe=u(31385),J=u(69870),P=u(50405),ye=u(50193),xe=u(78802),U=u(85384),z=u(34602),Z=u(50959),e=u(11527),ae=function(n,t){var o=["0"];if(t==="0")return o;var c=function s(l){!(n!=null&&n[l])||(n[l].parentId&&s(n[l].parentId),n[l].menuType!==i.og.F&&o.push(l))};return c(t),o},Fe=function(n){var t=function o(c){return c.filter(function(s){return s.menuType!==i.og.F}).map(function(s){var l=s.menuId,j=s.menuName,d=s.children;return{menuId:l,menuName:j,children:d?o(d):[]}})};return[{menuId:"0",menuName:"\u6839\u76EE\u5F55",children:n?t(n):[]}]},Ee=function(){var n,t=(0,Z.useRef)(),o=(0,C.FV)(te),c=V()(o,2),s=c[0],l=c[1],j=b(),d=j.refetch,g=(0,C.sJ)(N),I=(0,U.Z)(function(){var r=D()(f().mark(function v(m){var x,B;return f().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,A.Ii)(m);case 2:return x=E.sent,B=(0,$.tw)(x,{id:"menuId",pId:"parentId",rootPId:null}),E.abrupt("return",{options:Fe((0,$.dH)(B)),map:x.reduce(function(M,h){return K()(K()({},M),{},Q()({},h.menuId,h))},{})});case 5:case"end":return E.stop()}},v)}));return function(v){return r.apply(this,arguments)}}()),a=I.data,y=I.refresh;return(0,Z.useEffect)(function(){var r;if(t!=null&&(r=t.current)!==null&&r!==void 0&&r.setFieldsValue&&a!==null&&a!==void 0&&a.map){var v;t==null||(v=t.current)===null||v===void 0||v.setFieldsValue({parentId:ae(a==null?void 0:a.map,g)})}},[g,a==null?void 0:a.map,t==null?void 0:t.current]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.Z,{className:"mr-2",type:"primary",onClick:function(){return l(!0)},icon:(0,e.jsx)(me.Z,{}),children:"\u65B0\u5EFA"}),(0,e.jsx)(ue.Z,{visible:s,onCancel:function(){return l(!1)},title:"\u65B0\u5EFA\u83DC\u5355",footer:!1,width:515,children:(0,e.jsxs)(fe.A,{onFinish:function(){var r=D()(f().mark(function v(m){var x;return f().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,A.cI)(m);case 2:return F.next=4,d();case 4:l(!1),y(),t==null||(x=t.current)===null||x===void 0||x.resetFields(),W.ZP.success("\u65B0\u5EFA\u6210\u529F");case 8:case"end":return F.stop()}},v)}));return function(v){return r.apply(this,arguments)}}(),formRef:t,children:[(0,e.jsx)(he.Z,{name:"parentId",label:"\u7236\u7EA7\u83DC\u5355",initialValue:ae((n=a==null?void 0:a.map)!==null&&n!==void 0?n:{},g),fieldProps:{options:a==null?void 0:a.options,fieldNames:{label:"menuName",value:"menuId",children:"children"},changeOnSelect:!0},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355"}],transform:function(v){return{parentId:v[v.length-1]}}}),(0,e.jsx)(G.Z.Group,{name:"menuType",label:"\u83DC\u5355\u7C7B\u578B",valueEnum:i.vs,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u83DC\u5355\u7C7B\u578B"}]}),(0,e.jsx)(pe.Z,{name:["menuType"],children:function(v){var m=v.menuType;return m?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(J.UW,{children:[(0,e.jsx)(P.Z,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0",width:"sm",rules:[{required:!0}]}),(0,e.jsx)(ye.Z,{name:"orderNum",label:"\u663E\u793A\u6392\u5E8F",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F",rules:[{required:!0}],width:"sm",initialValue:0})]}),m!==i.og.F&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(J.UW,{children:[(0,e.jsx)(G.Z.Group,{tooltip:"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",name:"status",label:"\u83DC\u5355\u72B6\u6001",valueEnum:i.IZ,required:!0,initialValue:i.vu.ENABLE}),(0,e.jsx)(G.Z.Group,{name:"visible",label:"\u83DC\u5355\u662F\u5426\u663E\u793A",valueEnum:i.sv,required:!0,initialValue:i.Ve.YES,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"}),(0,e.jsx)(G.Z.Group,{name:"isFrame",label:"\u662F\u5426\u5916\u94FE",valueEnum:i.sv,required:!0,initialValue:i.Ve.NO,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"})]}),(0,e.jsxs)(J.UW,{children:[(0,e.jsx)(P.Z,{name:"icon",label:"\u83DC\u5355\u56FE\u6807",width:"sm",tooltip:"https://ant.design/components/icon-cn/"}),(0,e.jsx)(P.Z,{width:"sm",name:"path",label:"\u8DEF\u7531\u5730\u5740",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934",rules:[{required:!0}]})]})]}),m===i.og.C&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(P.Z,{name:"queryParam",label:"\u8DEF\u7531\u53C2\u6570",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'})}),m!==i.og.M&&(0,e.jsx)(P.Z,{name:"perms",label:"\u6743\u9650\u6807\u8BC6"})]}):null}}),(0,e.jsx)(xe.Z,{name:"remark",label:"\u5907\u6CE8"})]})})]})},je=Ee,ge=u(71224),Ce=function(){var n=(0,C.sJ)(N),t=re(),o=t.mutate,c=t.isLoading;return(0,e.jsx)(z.Z,{icon:(0,e.jsx)(ge.Z,{}),loading:c,disabled:n==="0",danger:!0,onClick:function(){return o(n)},children:"\u5220\u9664"})},Ie=Ce,H=u(8681),k=u(80424),le=u(25384),X={xs:1,sm:1,md:1,lg:1,xl:2},De=function(n){return(0,Z.useMemo)(function(){var t=[];return n?(n!==i.og.F&&t.push({title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"radio",valueEnum:i.IZ},{title:"\u662F\u5426\u663E\u793A",dataIndex:"visible",key:"visible",valueType:"radio",valueEnum:i.sv,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"},{title:"\u662F\u5426\u5916\u94FE",dataIndex:"isFrame",key:"isFrame",valueType:"radio",valueEnum:i.sv,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u56FE\u6807",dataIndex:"icon",key:"icon",valueType:"text",tooltip:"https://ant.design/components/icon-cn/"},{title:"\u8DEF\u7531\u5730\u5740",dataIndex:"path",key:"path",valueType:"text",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u8DEF\u7531\u53C2\u6570",dataIndex:"queryParam",key:"queryParam",valueType:"code",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'}),n!==i.og.M&&t.push({title:"\u6743\u9650\u6807\u8BC6",dataIndex:"perms",key:"perms",valueType:"text",copyable:!0}),t):[]},[n])},Ze=function(){var n=(0,C.sJ)(N),t=b(),o=t.refetch,c=(0,U.Z)(D()(f().mark(function a(){return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,A.lP)(n);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),{ready:n!=="0",refreshDeps:[n]}),s=c.data,l=c.refresh,j=(0,U.Z)(A.vv,{manual:!0,onSuccess:function(){l(),o(),W.ZP.success("\u4FDD\u5B58\u6210\u529F")}}),d=j.runAsync,g=De(s==null?void 0:s.menuType),I={onSave:function(){var a=D()(f().mark(function r(v,m){var x,B,F,E,M;return f().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return x=m.menuType,B=m.orderNum,F=m.menuName,E=m.menuId,M=v,L.next=4,d(Q()({menuId:E,menuType:x,orderNum:B,menuName:F},M,m[M]));case 4:case"end":return L.stop()}},r)}));function y(r,v){return a.apply(this,arguments)}return y}()};return n==="0"?(0,e.jsx)(k.Z,{image:k.Z.PRESENTED_IMAGE_SIMPLE,description:"\u70B9\u51FB\u9009\u62E9\u5DE6\u4FA7\u83DC\u5355\u9879\u67E5\u770B\u8BE6\u60C5"}):(0,e.jsxs)("div",{children:[(0,e.jsx)(H.vY,{columns:[{title:"\u7C7B\u578B",dataIndex:"menuType",key:"menuType",valueType:"select",valueEnum:i.vs,editable:!1},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1}],dataSource:s,column:X}),(0,e.jsx)(le.Z,{}),(0,e.jsx)(H.vY,{columns:[{title:"\u540D\u79F0",dataIndex:"menuName",key:"menuName",valueType:"text"},{title:"\u663E\u793A\u987A\u5E8F",dataIndex:"orderNum",key:"orderNum",valueType:"digit",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F"},{title:"\u5907\u6CE8",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0}],dataSource:s,editable:I,column:X}),(0,e.jsx)(le.Z,{}),(0,e.jsx)(H.vY,{columns:g,dataSource:s,editable:I,column:X})]})},Se=Ze,Be=u(4445),Me=u(8790),Te=u(98408),Ae=u(19886),Ne=u(70639),S=u(5713),Pe=u(30719),Re=u(30784),Le=u(46415),R;(function(p){p.M="blue",p.C="green",p.F="red"})(R||(R={}));var Oe=function(n){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{color:"rgb(148 163 184)",children:n.orderNum}),n.icon&&(0,e.jsx)(Be.JO,{name:n.icon,className:"mr-1"}),(0,e.jsx)(S.Z,{color:R[n.menuType],style:{margin:"0 0 2px 0"},children:n.menuName}),n.perms&&(0,e.jsx)(S.Z,{style:{margin:"0 0 2px 2px"},children:n.perms})]})},Ve=function(){return(0,e.jsxs)("div",{className:"mb-2",children:["\u6807\u7B7E\u542B\u4E49\uFF1A",(0,e.jsx)(S.Z,{color:"rgb(148 163 184)",children:"\u663E\u793A\u987A\u5E8F"}),(0,e.jsx)(S.Z,{color:R[i.og.M],children:"\u76EE\u5F55"}),(0,e.jsx)(S.Z,{color:R[i.og.C],children:"\u83DC\u5355"}),(0,e.jsx)(S.Z,{color:R[i.og.F],children:"\u6309\u94AE"}),(0,e.jsx)(S.Z,{children:"\u6743\u9650\u6807\u8BC6"})]})},$e=function(){var n,t=(0,Z.useState)({}),o=V()(t,2),c=o[0],s=o[1],l=(0,Z.useState)([]),j=V()(l,2),d=j[0],g=j[1],I=(0,Z.useState)([]),a=V()(I,2),y=a[0],r=a[1],v=(0,C.FV)(N),m=V()(v,2),x=m[0],B=m[1],F=(0,C.rb)(N),E=(0,C.Zl)(te),M=b(c),h=M.data,L=M.refetch,ke=re(),Qe=ke.mutate,We=function(O){g(O)},q=(y==null?void 0:y.length)!==0&&(y==null?void 0:y.length)===(h==null||(n=h.parentIds)===null||n===void 0?void 0:n.length);return(0,Z.useEffect)(function(){L()},[c]),(0,Z.useEffect)(function(){d!=null&&d[0]?B(d[0]):F()},[d]),(0,e.jsxs)("div",{children:[(0,e.jsx)(Ve,{}),(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsx)(z.Z,{size:"small",className:"my-2",icon:q?(0,e.jsx)(Me.Z,{}):(0,e.jsx)(Te.Z,{}),onClick:function(){return r(q?[]:h==null?void 0:h.parentIds)},children:q?"\u5168\u90E8\u6298\u53E0":"\u5168\u90E8\u5C55\u5F00"}),(0,e.jsxs)(Ae.M,{onFinish:function(){var T=D()(f().mark(function O(Ye){return f().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:g([]),r([]),s(Ye);case 3:case"end":return _.stop()}},O)}));return function(O){return T.apply(this,arguments)}}(),children:[(0,e.jsx)(P.Z,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0"}),(0,e.jsx)(Ne.Z,{name:"status",label:"\u72B6\u6001",valueEnum:i.IZ})]})]}),(0,e.jsx)(Pe.Z,{overlay:(0,e.jsx)(Re.Z,{items:[{label:"\u65B0\u5EFA",key:"create",onClick:function(){return E(!0)}},{label:"\u5728\u6839\u76EE\u5F55\u65B0\u5EFA",key:"create",onClick:function(){F(),E(!0)}},{label:"\u5220\u9664",key:"delete",danger:!0,disabled:d.length===0,onClick:function(){return Qe(x)}}]}),trigger:["contextMenu"],children:h!=null&&h.treeData.length?(0,e.jsx)(Le.Z,{blockNode:!0,selectedKeys:d,onSelect:We,expandedKeys:y,titleRender:Oe,onExpand:r,showLine:{showLeafIcon:!1},fieldNames:{title:"menuName",key:"menuId",children:"children"},treeData:h==null?void 0:h.treeData,onRightClick:function(O){return g([O.node.key])}}):(0,e.jsx)(k.Z,{image:k.Z.PRESENTED_IMAGE_SIMPLE})})]})},Ke=$e,w=u(92913),be=u(82262);function Ge(){return(0,e.jsx)(be._z,{children:(0,e.jsxs)(w.Z,{ghost:!0,gutter:24,children:[(0,e.jsx)(w.Z,{title:"\u83DC\u5355\u5217\u8868",colSpan:"550px",extra:[(0,e.jsx)(je,{},"ButtonCreate"),(0,e.jsx)(Ie,{},"ButtonDelete")],bodyStyle:{height:"700px",overflowY:"auto",overflowX:"hidden"},children:(0,e.jsx)(Ke,{})}),(0,e.jsx)(w.Z,{title:"\u83DC\u5355\u8BE6\u60C5",bodyStyle:{height:"707px"},children:(0,e.jsx)(Se,{})})]})})}}}]);
