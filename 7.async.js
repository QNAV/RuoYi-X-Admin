"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[842],{98817:function(Ye,q,u){u.r(q),u.d(q,{default:function(){return Je}});var se=u(46338),G=u.n(se),le=u(55980),A=u.n(le),ie=u(18172),B=u.n(ie),oe=u(3849),V=u.n(oe),de=u(29960),f=u.n(de),i=u(16914),M=u(96032),O=u(16064),_=u(78534),W=u(96069),J=u(2891),I=u(46510),Q="systemMenu",ee=[Q,"list"],K=(0,I.cn)({key:"".concat(Q,"SelectedKeys"),default:[]}),ue=(0,I.cn)({key:"".concat(Q,"VisibleCreateModal"),default:!1}),ve=function(n){return(0,J.aM)(ee,B()(f().mark(function a(){var s,t;return f().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,M.Ii)(n);case 2:return s=d.sent,t=(0,O.tw)(s,{id:"menuId",pId:"parentId",rootPId:null}),d.abrupt("return",{treeData:(0,O.dH)(t),map:s.reduce(function(F,c){return A()(A()({},F),{},G()({},c.menuId,c))},{}),parentIds:(0,O.Vy)(s)});case 5:case"end":return d.stop()}},a)})),{refetchOnWindowFocus:!1})},Y=function(){var n=(0,J.NL)();return function(){return n.invalidateQueries(ee)}},ne=function(){var n=Y(),a=(0,I.rb)(K);return(0,J.Db)(function(){var s=B()(f().mark(function t(o){return f().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:_.Z.confirm({title:"\u64CD\u4F5C\u786E\u8BA4",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u83DC\u5355\u5417\uFF1F",onOk:function(){var c=B()(f().mark(function y(){return f().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,M.Wl)(o);case 2:return v.next=4,n();case 4:a(),W.ZP.success("\u5220\u9664\u6210\u529F");case 6:case"end":return v.stop()}},y)}));function g(){return c.apply(this,arguments)}return g}()});case 1:case"end":return F.stop()}},t)}));return function(t){return s.apply(this,arguments)}}())},ce=u(20436),me=u(30553),fe=u(60896),$=u(47780),pe=u(31385),k=u(69870),S=u(50405),he=u(50193),Fe=u(78802),te=u(85384),U=u(34602),P=u(50959),e=u(11527),re=function(n,a){var s=[0];if(!a)return[0];var t=function o(d){!(n!=null&&n[d])||(n[d].parentId&&o(n[d].parentId),n[d].menuType!==i.og.F&&s.push(d))};return t(a),s},Ee=function(n){var a=function s(t){return t.filter(function(o){return o.menuType!==i.og.F}).map(function(o){var d=o.menuId,F=o.menuName,c=o.children;return{menuId:d,menuName:F,children:c?s(c):[]}})};return[{menuId:0,menuName:"\u6839\u8282\u70B9",children:n?a(n):[]}]},xe=function(){var n,a,s,t=(0,P.useRef)(),o=(0,I.FV)(ue),d=V()(o,2),F=d[0],c=d[1],g=Y(),y=(0,I.sJ)(K),j=Number((n=y==null?void 0:y[0])!==null&&n!==void 0?n:"0"),v=(0,te.Z)(function(){var m=B()(f().mark(function r(C){var E,L;return f().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,M.Ii)(C);case 2:return E=D.sent,L=(0,O.tw)(E,{id:"menuId",pId:"parentId",rootPId:null}),D.abrupt("return",{options:Ee((0,O.dH)(L)),map:E.reduce(function(T,Z){return A()(A()({},T),{},G()({},Z.menuId,Z))},{})});case 5:case"end":return D.stop()}},r)}));return function(r){return m.apply(this,arguments)}}()),l=v.data,h=v.refresh;return(0,P.useEffect)(function(){var m;if(t!=null&&(m=t.current)!==null&&m!==void 0&&m.setFieldsValue&&l!==null&&l!==void 0&&l.map){var r;t==null||(r=t.current)===null||r===void 0||r.setFieldsValue({parentId:re(l==null?void 0:l.map,j)})}},[j,l==null?void 0:l.map,t==null?void 0:t.current]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{className:"mr-2",type:"primary",onClick:function(){return c(!0)},icon:(0,e.jsx)(ce.Z,{}),children:"\u65B0\u5EFA"}),(0,e.jsx)(_.Z,{visible:F,onCancel:function(){return c(!1)},title:"\u65B0\u5EFA\u83DC\u5355",footer:!1,width:515,children:(0,e.jsxs)(me.A,{onFinish:function(){var m=B()(f().mark(function r(C){var E;return f().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,M.cI)(C);case 2:return x.next=4,g();case 4:W.ZP.success("\u65B0\u5EFA\u6210\u529F"),c(!1),h(),t==null||(E=t.current)===null||E===void 0||E.resetFields();case 8:case"end":return x.stop()}},r)}));return function(r){return m.apply(this,arguments)}}(),formRef:t,children:[(0,e.jsx)(fe.Z,{name:"parentId",label:"\u7236\u7EA7\u83DC\u5355",initialValue:re((a=l==null?void 0:l.map)!==null&&a!==void 0?a:{},j),fieldProps:{options:(s=l==null?void 0:l.options)!==null&&s!==void 0?s:[],fieldNames:{label:"menuName",value:"menuId",children:"children"},changeOnSelect:!0},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355"}],transform:function(r){return{parentId:r[r.length-1]}}}),(0,e.jsx)($.Z.Group,{name:"menuType",label:"\u83DC\u5355\u7C7B\u578B",valueEnum:i.vs,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u83DC\u5355\u7C7B\u578B"}]}),(0,e.jsx)(pe.Z,{name:["menuType"],children:function(r){var C=r.menuType;return C?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.UW,{children:[(0,e.jsx)(S.Z,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0",width:"sm",rules:[{required:!0}]}),(0,e.jsx)(he.Z,{name:"orderNum",label:"\u663E\u793A\u6392\u5E8F",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F",rules:[{required:!0}],width:"sm",initialValue:0})]}),C!==i.og.F&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.UW,{children:[(0,e.jsx)($.Z.Group,{tooltip:"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",name:"status",label:"\u83DC\u5355\u72B6\u6001",valueEnum:i.IZ,required:!0,initialValue:i.vu.ENABLE}),(0,e.jsx)($.Z.Group,{name:"visible",label:"\u83DC\u5355\u662F\u5426\u663E\u793A",valueEnum:i.sv,required:!0,initialValue:i.Ve.YES,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"}),(0,e.jsx)($.Z.Group,{name:"isFrame",label:"\u662F\u5426\u5916\u94FE",valueEnum:i.sv,required:!0,initialValue:i.Ve.NO,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"})]}),(0,e.jsxs)(k.UW,{children:[(0,e.jsx)(S.Z,{name:"icon",label:"\u83DC\u5355\u56FE\u6807",width:"sm",tooltip:"https://ant.design/components/icon-cn/"}),(0,e.jsx)(S.Z,{width:"sm",name:"path",label:"\u8DEF\u7531\u5730\u5740",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934",rules:[{required:!0}]})]})]}),C===i.og.C&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{name:"component",label:"\u7EC4\u4EF6\u8DEF\u5F84",tooltip:"\u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`system/user/index`\uFF0C\u9ED8\u8BA4\u5728`/src/pages`\u76EE\u5F55\u4E0B"}),(0,e.jsx)(S.Z,{name:"params",label:"\u8DEF\u7531\u53C2\u6570",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'})]}),C!==i.og.M&&(0,e.jsx)(S.Z,{name:"perms",label:"\u6743\u9650\u6807\u8BC6"})]}):null}}),(0,e.jsx)(Fe.Z,{name:"remark",label:"\u5907\u6CE8"})]})})]})},ye=xe,je=u(71224),Ce=function(){var n=(0,I.sJ)(K),a=n!=null&&n[0]?Number(n==null?void 0:n[0]):0,s=ne(),t=s.mutate,o=s.isLoading;return(0,e.jsx)(U.Z,{icon:(0,e.jsx)(je.Z,{}),loading:o,disabled:a===0,danger:!0,onClick:function(){return t(a)},children:"\u5220\u9664"})},ge=Ce,De=u(42217),Ie=u.n(De),z=u(8681),ae=u(25384),b=u(80424),Ze=["params"],H={xs:1,sm:1,md:1,lg:1,xl:3},Be=function(n){return(0,P.useMemo)(function(){var a=[];return n?(n!==i.og.F&&a.push({title:"\u72B6\u6001",dataIndex:"status",key:"status",valueType:"radio",valueEnum:i.IZ},{title:"\u662F\u5426\u663E\u793A",dataIndex:"visible",key:"visible",valueType:"radio",valueEnum:i.sv,tooltip:"\u9009\u62E9\u5426\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE"},{title:"\u662F\u5426\u5916\u94FE",dataIndex:"isFrame",key:"isFrame",valueType:"radio",valueEnum:i.sv,tooltip:"\u9009\u62E9\u662F\u5916\u94FE\u5219\u8DEF\u7531\u5730\u5740\u9700\u8981\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u56FE\u6807",dataIndex:"icon",key:"icon",valueType:"text",tooltip:"https://ant.design/components/icon-cn/"},{title:"\u8DEF\u7531\u5730\u5740",dataIndex:"path",key:"path",valueType:"text",tooltip:"\u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934"},{title:"\u8DEF\u7531\u53C2\u6570",dataIndex:"params",key:"params",valueType:"code",tooltip:'\u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A{"id": 1, "name": "ry"}'}),n===i.og.C&&a.push({title:"\u7EC4\u4EF6\u8DEF\u5F84",dataIndex:"component",key:"component",valueType:"text",tooltip:"\u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`system/user/index`\uFF0C\u9ED8\u8BA4\u5728`/src/pages`\u76EE\u5F55\u4E0B"}),n!==i.og.M&&a.push({title:"\u6743\u9650\u6807\u8BC6",dataIndex:"perms",key:"perms",valueType:"text",copyable:!0}),a):[]},[n])},Ne=function(){var n=Y(),a=(0,I.sJ)(K),s=a!=null&&a[0]?Number(a==null?void 0:a[0]):0,t=(0,te.Z)(B()(f().mark(function g(){var y,j,v;return f().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,M.lP)(s);case 2:return y=h.sent,j=y.params,v=Ie()(y,Ze),h.abrupt("return",A()(A()({},v),{},{params:JSON.stringify(j)}));case 6:case"end":return h.stop()}},g)})),{ready:s>0,refreshDeps:[s]}),o=t.data,d=t.refresh,F=Be(o==null?void 0:o.menuType),c={onSave:function(){var g=B()(f().mark(function j(v,l){var h,m,r,C,E;return f().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return h=v,m=l.menuType,r=l.orderNum,C=l.menuName,E=l[h],h==="params"&&(E=JSON.parse(E)),x.next=6,(0,M.vv)(G()({menuId:s,menuType:m,orderNum:r,menuName:C},h,E));case 6:return W.ZP.success("\u4FEE\u6539\u6210\u529F"),d(),x.next=10,n();case 10:case"end":return x.stop()}},j)}));function y(j,v){return g.apply(this,arguments)}return y}()};return s>0?(0,e.jsxs)("div",{children:[(0,e.jsx)(z.vY,{columns:[{title:"\u7C7B\u578B",dataIndex:"menuType",key:"menuType",valueType:"select",valueEnum:i.vs,editable:!1},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",valueType:"dateTime",editable:!1}],dataSource:o,column:H}),(0,e.jsx)(ae.Z,{}),(0,e.jsx)(z.vY,{columns:[{title:"\u540D\u79F0",dataIndex:"menuName",key:"menuName",valueType:"text"},{title:"\u663E\u793A\u987A\u5E8F",dataIndex:"orderNum",key:"orderNum",valueType:"digit",tooltip:"\u9ED8\u8BA4\u6570\u503C\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u5E8F\u8D8A\u9760\u540E\uFF0C\u6570\u503C\u76F8\u7B49\u6309\u7167\u521B\u5EFA\u65F6\u95F4\u5148\u540E\u6392\u5E8F"},{title:"\u5907\u6CE8",dataIndex:"remark",key:"remark",valueType:"textarea",hideInSearch:!0}],dataSource:o,editable:c,column:H}),(0,e.jsx)(ae.Z,{}),(0,e.jsx)(z.vY,{columns:F,dataSource:o,editable:c,column:H})]}):(0,e.jsx)(b.Z,{image:b.Z.PRESENTED_IMAGE_SIMPLE,description:"\u70B9\u51FB\u9009\u62E9\u5DE6\u4FA7\u83DC\u5355\u9879\u67E5\u770B\u8BE6\u60C5"})},Te=Ne,Se=u(38214),Ae=u(8790),Me=u(98408),Pe=u(19886),Re=u(70639),N=u(5713),Le=u(30719),Oe=u(30784),Ke=u(46415),R;(function(p){p.M="blue",p.C="green",p.F="red"})(R||(R={}));var Ve=function(n){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(N.Z,{color:"rgb(148 163 184)",children:n.orderNum}),n.icon&&(0,e.jsx)(Se.JO,{name:n.icon,className:"mr-1"}),(0,e.jsx)(N.Z,{color:R[n.menuType],style:{margin:"0 0 2px 0"},children:n.menuName}),n.perms&&(0,e.jsx)(N.Z,{style:{margin:"0 0 2px 2px"},children:n.perms})]})},$e=function(){return(0,e.jsxs)("div",{className:"mb-2",children:["\u6807\u7B7E\u542B\u4E49\uFF1A",(0,e.jsx)(N.Z,{color:"rgb(148 163 184)",children:"\u663E\u793A\u987A\u5E8F"}),(0,e.jsx)(N.Z,{color:R[i.og.M],children:"\u76EE\u5F55"}),(0,e.jsx)(N.Z,{color:R[i.og.C],children:"\u83DC\u5355"}),(0,e.jsx)(N.Z,{color:R[i.og.F],children:"\u6309\u94AE"}),(0,e.jsx)(N.Z,{children:"\u6743\u9650\u6807\u8BC6"})]})},be=function(){var n,a=(0,P.useState)({}),s=V()(a,2),t=s[0],o=s[1],d=(0,I.FV)(K),F=V()(d,2),c=F[0],g=F[1],y=(0,P.useState)([]),j=V()(y,2),v=j[0],l=j[1],h=(0,I.Zl)(ue),m=ve(t),r=m.data,C=m.refetch,E=ne(),L=E.mutate,x=function(Z){g(Z)},D=(v==null?void 0:v.length)!==0&&(v==null?void 0:v.length)===(r==null||(n=r.parentIds)===null||n===void 0?void 0:n.length);return(0,P.useEffect)(function(){C()},[t]),(0,e.jsxs)("div",{children:[(0,e.jsx)($e,{}),(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsx)(U.Z,{size:"small",className:"my-2",icon:D?(0,e.jsx)(Ae.Z,{}):(0,e.jsx)(Me.Z,{}),onClick:function(){return l(D?[]:r==null?void 0:r.parentIds)},children:D?"\u5168\u90E8\u6298\u53E0":"\u5168\u90E8\u5C55\u5F00"}),(0,e.jsxs)(Pe.M,{onFinish:function(){var T=B()(f().mark(function Z(Qe){return f().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:g([]),l([]),o(Qe);case 3:case"end":return w.stop()}},Z)}));return function(Z){return T.apply(this,arguments)}}(),children:[(0,e.jsx)(S.Z,{name:"menuName",label:"\u83DC\u5355\u540D\u79F0"}),(0,e.jsx)(Re.Z,{name:"status",label:"\u72B6\u6001",valueEnum:i.IZ})]})]}),(0,e.jsx)(Le.Z,{overlay:(0,e.jsx)(Oe.Z,{items:[{label:"\u65B0\u5EFA",key:"create",onClick:function(){return h(!0)}},{label:"\u5220\u9664",key:"delete",danger:!0,disabled:c.length===0,onClick:function(){return L(Number(c==null?void 0:c[0]))}}]}),trigger:["contextMenu"],children:r!=null&&r.treeData.length?(0,e.jsx)(Ke.Z,{blockNode:!0,selectedKeys:c,onSelect:x,expandedKeys:v,titleRender:Ve,onExpand:l,showLine:{showLeafIcon:!1},fieldNames:{title:"menuName",key:"menuId",children:"children"},treeData:r==null?void 0:r.treeData,onRightClick:function(Z){g([Z.node.key])}}):(0,e.jsx)(b.Z,{image:b.Z.PRESENTED_IMAGE_SIMPLE})})]})},Ge=be,X=u(92913),We=u(82262);function Je(){return(0,e.jsx)(We._z,{children:(0,e.jsxs)(X.Z,{ghost:!0,gutter:24,children:[(0,e.jsx)(X.Z,{title:"\u83DC\u5355\u5217\u8868",colSpan:"500px",extra:[(0,e.jsx)(ye,{},"ButtonCreate"),(0,e.jsx)(ge,{},"ButtonDelete")],children:(0,e.jsx)(Ge,{})}),(0,e.jsx)(X.Z,{title:"\u83DC\u5355\u8BE6\u60C5",children:(0,e.jsx)(Te,{})})]})})}}}]);
