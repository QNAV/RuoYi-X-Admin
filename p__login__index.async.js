"use strict";(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[939],{23874:function(de,P,e){e.r(P),e.d(P,{default:function(){return te}});var U=e(44463),b=e.n(U),z=e(30279),E=e.n(z),I=e(35290),u=e.n(I),$=e(411),v=e.n($),V=e(46686),L=e.n(V),w=e(69400),W=e(37117),y=e(55024),r=e(11527),D=function(){return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,r.jsx)(W.Z,{plain:!0,children:(0,r.jsx)("span",{className:"text-sm font-normal text-neutral-400",children:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"})}),(0,r.jsx)("div",{onClick:function(){y.ZP.info("\u656C\u8BF7\u671F\u5F85")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:(0,r.jsx)(w.Z,{style:{fontSize:"20px",color:"#00ac84"}})})]})},Q=D,x=e(7093);function K(d){return C.apply(this,arguments)}function C(){return C=v()(u()().mark(function d(f){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,x.WY)("/captchaImage",E()({method:"GET"},f||{})));case 1:case"end":return i.stop()}},d)})),C.apply(this,arguments)}function me(d,f){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function d(f,S){return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",request("/captchaSms",_objectSpread({method:"GET",params:_objectSpread({},f)},S||{})));case 1:case"end":return j.stop()}},d)})),B.apply(this,arguments)}var R=e(25301),J=e(98376),F=e(6710),X=e(69807),Y=e(20158),p=e(78409),k=e(21954),H=e(41202),q=e(49256),_=e(17003),ee=e(34400),Z=e(50959),re=["autoLogin"],c;(function(d){d.MOBILE="MOBILE",d.USERNAME="USERNAME"})(c||(c={}));var ae=[{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:c.USERNAME},{label:"\u624B\u673A\u53F7\u767B\u5F55",key:c.MOBILE}],ne=function(){var f=(0,Z.useState)(c.USERNAME),S=L()(f,2),i=S[0],j=S[1],se=(0,k.useSearchParams)(),O=L()(se,2),A=O[0],ue=O[1],ie=A.get("msg"),G=A.get("redirect")||"/",T=(0,H.Z)(K),g=T.data,N=T.run,M=function(){var o=v()(u()().mark(function n(a,l){return u()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:(0,x.o4)(a?x.Z1.LOCAL_STORAGE:x.Z1.SESSION_STORAGE,"Bearer ".concat(l)),window.location.href=G;case 2:case"end":return h.stop()}},n)}));return function(a,l){return o.apply(this,arguments)}}(),le=function(){var o=v()(u()().mark(function n(a,l){var m,h;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,R.OK)(l);case 2:return m=s.sent,h=m.token,s.next=6,M(a,h);case 6:case"end":return s.stop()}},n)}));return function(a,l){return o.apply(this,arguments)}}(),oe=function(){var o=v()(u()().mark(function n(a,l){var m,h;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(g){s.next=3;break}return y.ZP.error("\u8BF7\u5148\u83B7\u53D6\u56FE\u7247\u9A8C\u8BC1\u7801"),s.abrupt("return");case 3:return s.next=5,(0,R.Rg)(E()(E()({},l),{},{uuid:g.uuid}));case 5:return m=s.sent,h=m.token,s.next=9,M(a,h);case 9:case"end":return s.stop()}},n)}));return function(a,l){return o.apply(this,arguments)}}(),ce=function(){var o=v()(u()().mark(function n(a){var l,m;return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,l=a.autoLogin,m=b()(a,re),i!==c.MOBILE){t.next=6;break}return t.next=5,le(l,m);case 5:return t.abrupt("return");case 6:if(i!==c.USERNAME){t.next=10;break}return t.next=9,oe(l,m);case 9:return t.abrupt("return");case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),i===c.USERNAME&&N();case 15:case"end":return t.stop()}},n,null,[[0,12]])}));return function(a){return o.apply(this,arguments)}}();return(0,Z.useEffect)(function(){ie&&(y.ZP.error(A.get("msg")),ue({redirect:G},{replace:!0}))},[]),(0,r.jsx)("div",{className:"h-[100vh]",children:(0,r.jsxs)(p.BcB,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Umi",subTitle:"\u82E5\u4F9D\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",actions:(0,r.jsx)(Q,{}),onFinish:ce,children:[(0,r.jsx)(q.Z,{centered:!0,activeKey:i,onChange:function(n){return j(n)},items:ae}),i===c.USERNAME&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.VaQ,{name:"username",fieldProps:{size:"large",prefix:(0,r.jsx)(J.Z,{})},placeholder:"admin",initialValue:"admin",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),(0,r.jsx)(p.VaQ.Password,{name:"password",fieldProps:{size:"large",prefix:(0,r.jsx)(F.Z,{})},placeholder:"admin123",initialValue:"admin123",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]}),(0,r.jsxs)(p.UWz,{children:[(0,r.jsx)(p.VaQ,{width:160,name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",fieldProps:{size:"large",prefix:(0,r.jsx)(X.Z,{})},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}),(0,r.jsx)("div",{className:"h-[40px] w-[135px] cursor-pointer border border-solid border-gray-300",children:g!=null&&g.img?(0,r.jsx)(_.Z,{src:"data:image/png;base64,".concat(g==null?void 0:g.img),preview:!1,height:40,width:135,alt:"\u56FE\u7247\u9A8C\u8BC1\u7801",onClick:N}):(0,r.jsx)(ee.Z.Button,{active:!0,block:!0,size:"large"})})]})]}),i===c.MOBILE&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.VaQ,{fieldProps:{maxLength:11,size:"large",prefix:(0,r.jsx)(Y.Z,{})},name:"phoneNumber",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{pattern:x.RE,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),(0,r.jsx)(p.BXt,{fieldProps:{size:"large",prefix:(0,r.jsx)(F.Z,{})},captchaProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(n,a){return n?"".concat(a," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"smsCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],onGetCaptcha:v()(u()().mark(function o(){return u()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return y.ZP.info("\u656C\u8BF7\u671F\u5F85"),a.abrupt("return",Promise.reject(new Error("\u656C\u8BF7\u671F\u5F85")));case 2:case"end":return a.stop()}},o)}))})]}),(0,r.jsx)(p.V2E,{name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"})]})})},te=ne}}]);
