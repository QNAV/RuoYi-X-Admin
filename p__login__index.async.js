"use strict";(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[939],{68004:function(ce,F,r){r.r(F),r.d(F,{default:function(){return ne}});var b=r(44463),z=r.n(b),I=r(30279),y=r.n(I),$=r(35290),u=r.n($),V=r(411),v=r.n(V),w=r(46686),L=r.n(w),D=r(69400),W=r(37117),E=r(55024),e=r(11527),Q=function(){return(0,e.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,e.jsx)(W.Z,{plain:!0,children:(0,e.jsx)("span",{className:"text-sm font-normal text-neutral-400",children:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"})}),(0,e.jsx)("div",{onClick:function(){E.ZP.info("\u656C\u8BF7\u671F\u5F85")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:(0,e.jsx)(D.Z,{style:{fontSize:"20px",color:"#00ac84"}})})]})},K=Q,x=r(80489);function J(d){return B.apply(this,arguments)}function B(){return B=v()(u()().mark(function d(f){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,x.WY)("/captchaImage",y()({method:"GET"},f||{})));case 1:case"end":return i.stop()}},d)})),B.apply(this,arguments)}function de(d,f){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function d(f,S){return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",request("/captchaSms",_objectSpread({method:"GET",params:_objectSpread({},f)},S||{})));case 1:case"end":return j.stop()}},d)})),C.apply(this,arguments)}var R=r(41445),X=r(98376),Z=r(6710),Y=r(69807),H=r(20158),p=r(79366),k=r(59052),q=r(41202),P=r(49256),_=r(17003),ee=r(34400),T=r(50959),re=["autoLogin"],c;(function(d){d.MOBILE="MOBILE",d.USERNAME="USERNAME"})(c||(c={}));var ae=function(){var f=(0,T.useState)(c.USERNAME),S=L()(f,2),i=S[0],j=S[1],te=(0,k.useSearchParams)(),O=L()(te,2),A=O[0],se=O[1],ue=A.get("msg"),G=A.get("redirect")||"/",N=(0,q.Z)(J),g=N.data,M=N.run,U=function(){var o=v()(u()().mark(function n(a,l){return u()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:(0,x.o4)(a?x.Z1.LOCAL_STORAGE:x.Z1.SESSION_STORAGE,"Bearer ".concat(l)),window.location.href=G;case 2:case"end":return h.stop()}},n)}));return function(a,l){return o.apply(this,arguments)}}(),ie=function(){var o=v()(u()().mark(function n(a,l){var m,h;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,R.OK)(l);case 2:return m=s.sent,h=m.token,s.next=6,U(a,h);case 6:case"end":return s.stop()}},n)}));return function(a,l){return o.apply(this,arguments)}}(),le=function(){var o=v()(u()().mark(function n(a,l){var m,h;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(g){s.next=3;break}return E.ZP.error("\u8BF7\u5148\u83B7\u53D6\u56FE\u7247\u9A8C\u8BC1\u7801"),s.abrupt("return");case 3:return s.next=5,(0,R.Rg)(y()(y()({},l),{},{uuid:g.uuid}));case 5:return m=s.sent,h=m.token,s.next=9,U(a,h);case 9:case"end":return s.stop()}},n)}));return function(a,l){return o.apply(this,arguments)}}(),oe=function(){var o=v()(u()().mark(function n(a){var l,m;return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,l=a.autoLogin,m=z()(a,re),i!==c.MOBILE){t.next=6;break}return t.next=5,ie(l,m);case 5:return t.abrupt("return");case 6:if(i!==c.USERNAME){t.next=10;break}return t.next=9,le(l,m);case 9:return t.abrupt("return");case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),i===c.USERNAME&&M();case 15:case"end":return t.stop()}},n,null,[[0,12]])}));return function(a){return o.apply(this,arguments)}}();return(0,T.useEffect)(function(){ue&&(E.ZP.error(A.get("msg")),se({redirect:G},{replace:!0}))},[]),(0,e.jsx)("div",{className:"h-[100vh]",children:(0,e.jsxs)(p.BcB,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Umi",subTitle:"\u82E5\u4F9D\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",actions:(0,e.jsx)(K,{}),onFinish:oe,children:[(0,e.jsxs)(P.Z,{activeKey:i,onChange:function(n){return j(n)},children:[(0,e.jsx)(P.Z.TabPane,{tab:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55"},c.USERNAME),(0,e.jsx)(P.Z.TabPane,{tab:"\u624B\u673A\u53F7\u767B\u5F55"},c.MOBILE)]}),i===c.USERNAME&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p.VaQ,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(X.Z,{})},placeholder:"admin",initialValue:"admin",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),(0,e.jsx)(p.VaQ.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{})},placeholder:"admin123",initialValue:"admin123",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]}),(0,e.jsxs)(p.UWz,{children:[(0,e.jsx)(p.VaQ,{width:160,name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",fieldProps:{size:"large",prefix:(0,e.jsx)(Y.Z,{})},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}),(0,e.jsx)("div",{className:"h-[40px] w-[135px] cursor-pointer border border-solid border-gray-300",children:g!=null&&g.img?(0,e.jsx)(_.Z,{src:"data:image/png;base64,".concat(g==null?void 0:g.img),preview:!1,height:40,width:135,alt:"\u56FE\u7247\u9A8C\u8BC1\u7801",onClick:M}):(0,e.jsx)(ee.Z.Button,{active:!0,block:!0,size:"large"})})]})]}),i===c.MOBILE&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p.VaQ,{fieldProps:{maxLength:11,size:"large",prefix:(0,e.jsx)(H.Z,{})},name:"phoneNumber",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{pattern:x.RE,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),(0,e.jsx)(p.BXt,{fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{})},captchaProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(n,a){return n?"".concat(a," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"smsCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],onGetCaptcha:v()(u()().mark(function o(){return u()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return E.ZP.info("\u656C\u8BF7\u671F\u5F85"),a.abrupt("return",Promise.reject(new Error("\u656C\u8BF7\u671F\u5F85")));case 2:case"end":return a.stop()}},o)}))})]}),(0,e.jsx)(p.V2E,{name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"})]})})},ne=ae}}]);
