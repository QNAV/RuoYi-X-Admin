"use strict";(self.webpackChunkruoyi_x_umi=self.webpackChunkruoyi_x_umi||[]).push([[382],{24263:function(te,M,e){var O=e(82175),B=e(62957),K=e(11527),V=e(61277),Q=["fieldProps","proFieldProps"],L=["fieldProps","proFieldProps"],D="text",Y=function(E){var R=E.fieldProps,r=E.proFieldProps,U=(0,B.Z)(E,Q);return(0,K.jsx)(V.Z,(0,O.Z)({mode:"edit",valueType:D,fieldProps:R,filedConfig:{valueType:D},proFieldProps:r},U))},X=function(E){var R=E.fieldProps,r=E.proFieldProps,U=(0,B.Z)(E,L);return(0,K.jsx)(V.Z,(0,O.Z)({mode:"edit",valueType:"password",fieldProps:R,proFieldProps:r,filedConfig:{valueType:D}},U))},x=Y;x.Password=X,x.displayName="ProFormComponent",M.Z=x},32843:function(te,M,e){e.d(M,{UW:function(){return B}});var O=e(98714),B=O.A.Group},19964:function(te,M,e){e.r(M),e.d(M,{default:function(){return $e}});var O=e(55980),B=e.n(O),K=e(42217),V=e.n(K),Q=e(18172),L=e.n(Q),D=e(3849),Y=e.n(D),X=e(29960),x=e.n(X),k=e(72867),E=e(58229),R=e(90964),r=e(11527),U=function(){return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,r.jsx)(E.Z,{plain:!0,children:(0,r.jsx)("span",{className:"text-sm font-normal text-neutral-400",children:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"})}),(0,r.jsx)("div",{onClick:function(){R.ZP.info("\u656C\u8BF7\u671F\u5F85")},className:"flex justify-center items-center cursor-pointer rounded-full h-[40px] w-[40px] border-solid border border-gray-300",children:(0,r.jsx)(k.Z,{style:{fontSize:"20px",color:"#00ac84"}})})]})},ve=U,W=e(41595);function fe(a){return w.apply(this,arguments)}function w(){return w=L()(x().mark(function a(s){return x().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,W.WY)("/captchaImage",B()({method:"GET"},s||{})));case 1:case"end":return n.stop()}},a)})),w.apply(this,arguments)}function Ve(a,s){return q.apply(this,arguments)}function q(){return q=_asyncToGenerator(_regeneratorRuntime.mark(function a(s,c){return _regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/captchaSms",_objectSpread({method:"GET",params:_objectSpread({},s)},c||{})));case 1:case"end":return d.stop()}},a)})),q.apply(this,arguments)}var se=e(44317),he=e(16916),ne=e(88387),pe=e(642),ge=e(57174),Ye=e(69541),Pe=e(70377),i=e(82175),_=e(62957),xe=e(43443),f=e(50959),je=e(98714),Ce=["logo","message","style","activityConfig","backgroundImageUrl","title","subTitle","actions","children"];function Ze(a){var s=a.logo,c=a.message,n=a.style,d=a.activityConfig,u=d===void 0?{}:d,j=a.backgroundImageUrl,P=a.title,S=a.subTitle,C=a.actions,G=a.children,Z=(0,_.Z)(a,Ce),$=(0,xe.YB)(),A=function(){var l,y;return Z.submitter===!1||((l=Z.submitter)===null||l===void 0?void 0:l.submitButtonProps)===!1?!1:(0,i.Z)({size:"large",style:{width:"100%"}},(y=Z.submitter)===null||y===void 0?void 0:y.submitButtonProps)},z=(0,i.Z)((0,i.Z)({searchConfig:{submitText:$.getMessage("loginForm.submitText","\u767B\u5F55")},render:function(l,y){return y.pop()}},Z.submitter),{},{submitButtonProps:A()}),N=(0,f.useContext)(Pe.ZP.ConfigContext),b=N.getPrefixCls("pro-form-login-page"),o=function(l){return"".concat(b,"-").concat(l)},h=(0,f.useMemo)(function(){return s?typeof s=="string"?(0,r.jsx)("img",{src:s}):s:null},[s]);return(0,r.jsxs)("div",{className:b,style:(0,i.Z)((0,i.Z)({},n),{},{backgroundImage:'url("'.concat(j,'")')}),children:[(0,r.jsx)("div",{className:o("notice"),children:u&&(0,r.jsxs)("div",{className:o("notice-activity"),style:u.style,children:[u.title&&(0,r.jsxs)("div",{className:o("notice-activity-title"),children:[" ",u.title," "]}),u.subTitle&&(0,r.jsxs)("div",{className:o("notice-activity-subTitle"),children:[" ",u.subTitle," "]}),u.action&&(0,r.jsxs)("div",{className:o("notice-activity-action"),children:[" ",u.action," "]})]})}),(0,r.jsxs)("div",{className:o("container"),children:[(0,r.jsxs)("div",{className:o("top"),children:[P||h?(0,r.jsxs)("div",{className:o("header"),children:[h?(0,r.jsx)("span",{className:o("logo"),children:h}):null,P?(0,r.jsx)("span",{className:o("title"),children:P}):null]}):null,S?(0,r.jsx)("div",{className:o("desc"),children:S}):null]}),(0,r.jsxs)("div",{className:o("main"),children:[(0,r.jsxs)(je.A,(0,i.Z)((0,i.Z)({isKeyPressSubmit:!0},Z),{},{submitter:z,children:[c,G]})),C?(0,r.jsx)("div",{className:o("other"),children:C}):null]})]})]})}var Je=e(8130),ye=e(44631),He=e(67132),Fe=e(97867),Qe=e(1794),Ee=e(43133),J=e(88081),ie=e(21519),ee=e(61431),oe=e(85242),Te=["rules","name","phoneName","fieldProps","captchaTextRender","captchaProps"],Se=f.forwardRef(function(a,s){var c=(0,f.useState)(a.countDown||60),n=(0,ee.Z)(c,2),d=n[0],u=n[1],j=(0,f.useState)(!1),P=(0,ee.Z)(j,2),S=P[0],C=P[1],G=(0,f.useState)(),Z=(0,ee.Z)(G,2),$=Z[0],A=Z[1],z=a.rules,N=a.name,b=a.phoneName,o=a.fieldProps,h=a.captchaTextRender,p=h===void 0?function(m,F){return m?"".concat(F," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:h,l=a.captchaProps,y=(0,_.Z)(a,Te),I=function(){var m=(0,ie.Z)((0,J.Z)().mark(function F(t){return(0,J.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,A(!0),g.next=4,y.onGetCaptcha(t);case 4:A(!1),C(!0),g.next=13;break;case 8:g.prev=8,g.t0=g.catch(0),C(!1),A(!1),console.log(g.t0);case 13:case"end":return g.stop()}},F,null,[[0,8]])}));return function(t){return m.apply(this,arguments)}}();return(0,f.useImperativeHandle)(s,function(){return{startTiming:function(){return C(!0)},endTiming:function(){return C(!1)}}}),(0,f.useEffect)(function(){var m=0,F=a.countDown;return S&&(m=window.setInterval(function(){u(function(t){return t<=1?(C(!1),clearInterval(m),F||60):t-1})},1e3)),function(){return clearInterval(m)}},[S]),(0,r.jsx)(Ee.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(F){var t=F.getFieldValue,de=F.validateFields;return(0,r.jsxs)("div",{style:(0,i.Z)((0,i.Z)({},o==null?void 0:o.style),{},{display:"flex",alignItems:"center"}),ref:s,children:[(0,r.jsx)(Fe.Z,(0,i.Z)((0,i.Z)({},o),{},{style:{flex:1,transition:"width .3s",marginRight:8}})),(0,r.jsx)(ye.Z,(0,i.Z)((0,i.Z)({style:{display:"block"},disabled:S,loading:$},l),{},{onClick:function(){var g=(0,ie.Z)((0,J.Z)().mark(function Ke(){var me;return(0,J.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(v.prev=0,!b){v.next=9;break}return v.next=4,de([b].flat(1));case 4:return me=t([b].flat(1)),v.next=7,I(me);case 7:v.next=11;break;case 9:return v.next=11,I("");case 11:v.next=16;break;case 13:v.prev=13,v.t0=v.catch(0),console.log(v.t0);case 16:case"end":return v.stop()}},Ke,null,[[0,13]])}));function ze(){return g.apply(this,arguments)}return ze}(),children:p(S,d)}))]})}})}),be=(0,oe.G)(Se),Be=be,Xe=e(69227),Re=e(82379),le=e(35667),ue=e(61277),Ne=["options","fieldProps","proFieldProps","valueEnum"],Ae=f.forwardRef(function(a,s){var c=a.options,n=a.fieldProps,d=a.proFieldProps,u=a.valueEnum,j=(0,_.Z)(a,Ne);return(0,r.jsx)(ue.Z,(0,i.Z)({ref:s,valueType:"checkbox",mode:"edit",valueEnum:(0,le.h)(u,void 0),fieldProps:(0,i.Z)({options:c},n),lightProps:(0,i.Z)({labelFormatter:function(){return(0,r.jsx)(ue.Z,(0,i.Z)({ref:s,valueType:"checkbox",mode:"read",valueEnum:(0,le.h)(u,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,i.Z)({options:c},n),proFieldProps:d},j))}},j.lightProps),proFieldProps:d},j))}),Me=f.forwardRef(function(a,s){var c=a.fieldProps,n=a.children;return(0,r.jsx)(Re.Z,(0,i.Z)((0,i.Z)({ref:s},c),{},{children:n}))}),Oe=(0,oe.G)(Me,{valuePropName:"checked"}),ce=Oe;ce.Group=Ae;var Ge=ce,H=e(24263),Ie=e(32843),re=e(77996),Le=e(34179),ae=e(41146),De=e(13227),Ue=["autoLogin"],T;(function(a){a.MOBILE="MOBILE",a.USERNAME="USERNAME"})(T||(T={}));var We=function(){var s=(0,f.useState)(T.USERNAME),c=Y()(s,2),n=c[0],d=c[1],u=(0,re.useSearchParams)(),j=Y()(u,2),P=j[0],S=j[1],C=P.get("msg"),G=P.get("redirect")||"/",Z=(0,re.useModel)("@@initialState"),$=Z.refresh,A=(0,re.useNavigate)(),z=(0,Le.Z)(fe),N=z.data,b=z.run,o=function(){var h=L()(x().mark(function p(l){var y,I,m;return x().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,y=l.autoLogin,I=V()(l,Ue),n!==T.MOBILE){t.next=8;break}return t.next=5,(0,se.OK)(I);case 5:m=t.sent,t.next=16;break;case 8:if(N){t.next=13;break}return R.ZP.error("\u8BF7\u5148\u83B7\u53D6\u56FE\u7247\u9A8C\u8BC1\u7801"),t.abrupt("return");case 13:return t.next=15,(0,se.Rg)(B()(B()({},I),{},{uuid:N.uuid}));case 15:m=t.sent;case 16:return(0,W.o4)(y?W.Z1.LOCAL_STORAGE:W.Z1.SESSION_STORAGE,"Bearer ".concat(m.token)),t.next=19,$();case 19:A(G),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(0),n===T.USERNAME&&b();case 25:case"end":return t.stop()}},p,null,[[0,22]])}));return function(l){return h.apply(this,arguments)}}();return(0,f.useEffect)(function(){C&&(R.ZP.error(P.get("msg")),S({redirect:G},{replace:!0}))},[]),(0,r.jsx)("div",{className:"h-[100vh]",children:(0,r.jsxs)(Ze,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"https://github.githubassets.com/images/modules/logos_page/Octocat.png",title:"RuoYi X Umi",subTitle:"\u82E5\u4F9D\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",actions:(0,r.jsx)(ve,{}),onFinish:o,children:[(0,r.jsxs)(ae.Z,{activeKey:n,onChange:function(p){return d(p)},children:[(0,r.jsx)(ae.Z.TabPane,{tab:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55"},T.USERNAME),(0,r.jsx)(ae.Z.TabPane,{tab:"\u624B\u673A\u53F7\u767B\u5F55"},T.MOBILE)]}),n===T.USERNAME&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.Z,{name:"username",fieldProps:{size:"large",prefix:(0,r.jsx)(he.Z,{})},placeholder:"admin",initialValue:"admin",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),(0,r.jsx)(H.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,r.jsx)(ne.Z,{})},placeholder:"admin123",initialValue:"admin123",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]}),(0,r.jsxs)(Ie.UW,{children:[(0,r.jsx)(H.Z,{width:160,name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",fieldProps:{size:"large",prefix:(0,r.jsx)(pe.Z,{})},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}),(0,r.jsx)("div",{className:"h-[40px] w-[135px] cursor-pointer border border-solid border-gray-300",children:(0,r.jsx)(De.Z,{src:"data:image/png;base64,".concat(N==null?void 0:N.img),preview:!1,style:{height:"40px",width:"135px"},alt:"\u56FE\u7247\u9A8C\u8BC1\u7801",onClick:b})})]})]}),n===T.MOBILE&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.Z,{fieldProps:{maxLength:11,size:"large",prefix:(0,r.jsx)(ge.Z,{})},name:"phonenumber",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{pattern:W.RE,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),(0,r.jsx)(Be,{fieldProps:{size:"large",prefix:(0,r.jsx)(ne.Z,{})},captchaProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(p,l){return p?"".concat(l," ","\u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"smsCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],onGetCaptcha:L()(x().mark(function h(){return x().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return R.ZP.info("\u656C\u8BF7\u671F\u5F85"),l.abrupt("return",Promise.reject(new Error("\u656C\u8BF7\u671F\u5F85")));case 2:case"end":return l.stop()}},h)}))})]}),(0,r.jsx)(Ge,{name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"})]})})},$e=We}}]);
